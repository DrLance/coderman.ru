/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.3.0 (TBD)
 */
!function(g){"use strict";var x=function(){return(x=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function u(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function w(){}function y(n){return n}var i=function(e,r){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(r.apply(null,n))}},b=function(n){return function(){return n}};function S(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=o.concat(n);return r.apply(null,e)}}function m(t){return function(n){return!t(n)}}function o(n){return function(){throw new Error(n)}}function r(n){return n()}function n(){return f}var c=b(!1),a=b(!0),f={fold:function(n,t){return n()},is:c,isSome:c,isNone:a,getOr:s,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(undefined),or:s,orThunk:e,map:n,each:w,bind:n,exists:c,forall:a,filter:n,equals:t,equals_:t,toArray:function(){return[]},toString:b("none()")};function t(n){return n.isNone()}function e(n){return n()}function s(n){return n}function O(n,e){return Sn(n,function(n,t){return{k:t,v:e(n,t)}})}function v(n,t){return kn(n,t)&&n[t]!==undefined&&null!==n[t]}function l(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}return undefined}(n,t);if(!e)return{major:0,minor:0};function r(n){return Number(t.replace(e,"$"+n))}return _n(r(1),r(2))}function d(t){return function(n){return function(n){var t=typeof n;return null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(n)===t}}function p(t){return function(n){return typeof n===t}}function T(n,t){return-1<function(n,t){return Qn.call(n,t)}(n,t)}function h(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return!0}return!1}function k(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}}function E(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e}function C(n,t,e){return function(n,t){for(var e=n.length-1;0<=e;e--){t(n[e],e)}}(n,function(n){e=t(e,n)}),e}function _(n,t,e){return k(n,function(n){e=t(e,n)}),e}function D(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return yn.some(o)}return yn.none()}function M(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return yn.some(e)}return yn.none()}function I(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!Xn(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);Zn.apply(t,n[e])}return t}function F(n,t){return I(nt(n,t))}function R(n,t){for(var e=0,r=n.length;e<r;++e){if(!0!==t(n[e],e))return!1}return!0}function B(n){var t=Jn.call(n,0);return t.reverse(),t}function A(n,t){return E(n,function(n){return!T(t,n)})}function V(n){return[n]}function N(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return yn.none()}function j(n,t){var e=String(t).toLowerCase();return D(n,function(n){return n.search(e)})}function H(n,t){return-1!==n.indexOf(t)}function P(t){return function(n){return H(n,t)}}function z(){return at.get()}function L(n,t){jt(n,n.element(),t,{})}function G(n,t,e){jt(n,n.element(),t,e)}function U(n){L(n,_t())}function $(n,t,e){jt(n,t,e,{})}function W(e){var r,o=!1;return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return o||(o=!0,r=e.apply(null,n)),r}}function X(n){return n.dom().nodeName.toLowerCase()}function q(t){return function(n){return function(n){return n.dom().nodeType}(n)===t}}function Y(n){var t=$t(n)?n.dom().parentNode:n.dom();return t!==undefined&&null!==t&&t.ownerDocument.body.contains(t)}function K(n,t){var e=n.dom();if(e.nodeType!==qt)return!1;var r=e;if(r.matches!==undefined)return r.matches(t);if(r.msMatchesSelector!==undefined)return r.msMatchesSelector(t);if(r.webkitMatchesSelector!==undefined)return r.webkitMatchesSelector(t);if(r.mozMatchesSelector!==undefined)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function J(n){return n.nodeType!==qt&&n.nodeType!==Yt||0===n.childElementCount}function Q(n,t){var e=t===undefined?g.document:t.dom();return J(e)?[]:nt(e.querySelectorAll(n),Pt.fromDom)}function Z(n,t){var e=t===undefined?g.document:t.dom();return J(e)?yn.none():yn.from(e.querySelector(n)).map(Pt.fromDom)}function nn(n,t){return n.dom()===t.dom()}function tn(n){return Pt.fromDom(n.dom().ownerDocument)}function en(n){return yn.from(n.dom().parentNode).map(Pt.fromDom)}function rn(n,t){var e=n.dom().childNodes;return yn.from(e[t]).map(Pt.fromDom)}function on(t,e){en(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})}function un(n,t){(function(n){return yn.from(n.dom().nextSibling).map(Pt.fromDom)})(n).fold(function(){en(n).each(function(n){Jt(n,t)})},function(n){on(n,t)})}function cn(t,e){(function(n){return rn(n,0)})(t).fold(function(){Jt(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})}function an(t,n){k(n,function(n){Jt(t,n)})}function fn(n){n.dom().textContent="",k(Kt(n),function(n){Qt(n)})}function sn(n,t){Jt(n.element(),t.element())}function ln(t,n){var e=t.components();!function(n){k(n.components(),function(n){return Qt(n.element())}),fn(n.element()),n.syncComponents()}(t);var r=A(e,n);k(r,function(n){Zt(n),t.getSystem().removeFromWorld(n)}),k(n,function(n){n.getSystem().isConnected()?sn(t,n):(t.getSystem().addToWorld(n),sn(t,n),Y(t.element())&&ne(n)),t.syncComponents()})}function dn(t){var n=en(t.element()).bind(function(n){return t.getSystem().getByDom(n).toOption()});!function(n){Zt(n),Qt(n.element()),n.getSystem().removeFromWorld(n)}(t),n.each(function(n){n.syncComponents()})}function mn(u){return function(){for(var n=new Array(arguments.length),t=0;t<n.length;t++)n[t]=arguments[t];if(0===n.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<n.length;r++){var o=n[r];for(var i in o)ce.call(o,i)&&(e[i]=u(e[i],o[i]))}return e}}var gn,pn,hn,vn=function(e){function n(){return o}function t(n){return n(e)}var r=b(e),o={fold:function(n,t){return t(e)},is:function(n){return e===n},isSome:a,isNone:c,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return vn(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,t){return n.fold(c,function(n){return t(e,n)})}};return o},yn={some:vn,none:n,from:function(n){return null===n||n===undefined?f:vn(n)}},bn=Object.keys,xn=Object.hasOwnProperty,wn=function(n,t){for(var e=bn(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}},Sn=function(n,r){var o={};return wn(n,function(n,t){var e=r(n,t);o[e.k]=e.v}),o},On=function(n,e){var r=[];return wn(n,function(n,t){r.push(e(n,t))}),r},Tn=function(n,t){return kn(n,t)?yn.from(n[t]):yn.none()},kn=function(n,t){return xn.call(n,t)},En=function(n){function t(){return e}var e=n;return{get:t,set:function(n){e=n},clone:function(){return En(t())}}},Cn=function(){return _n(0,0)},_n=function(n,t){return{major:n,minor:t}},Dn={nu:_n,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?Cn():l(n,e)},unknown:Cn},Mn="Edge",In="Chrome",Fn="Opera",Rn="Firefox",Bn="Safari",An=function(n){function t(n){return function(){return e===n}}var e=n.current,r=n.version;return{current:e,version:r,isEdge:t(Mn),isChrome:t(In),isIE:t("IE"),isOpera:t(Fn),isFirefox:t(Rn),isSafari:t(Bn)}},Vn={unknown:function(){return An({current:undefined,version:Dn.unknown()})},nu:An,edge:b(Mn),chrome:b(In),ie:b("IE"),opera:b(Fn),firefox:b(Rn),safari:b(Bn)},Nn="Windows",jn="Android",Hn="Linux",Pn="Solaris",zn="FreeBSD",Ln="ChromeOS",Gn=function(n){function t(n){return function(){return e===n}}var e=n.current,r=n.version;return{current:e,version:r,isWindows:t(Nn),isiOS:t("iOS"),isAndroid:t(jn),isOSX:t("OSX"),isLinux:t(Hn),isSolaris:t(Pn),isFreeBSD:t(zn),isChromeOS:t(Ln)}},Un={unknown:function(){return Gn({current:undefined,version:Dn.unknown()})},nu:Gn,windows:b(Nn),ios:b("iOS"),android:b(jn),linux:b(Hn),osx:b("OSX"),solaris:b(Pn),freebsd:b(zn),chromeos:b(Ln)},$n=d("string"),Wn=d("object"),Xn=d("array"),qn=p("boolean"),Yn=p("function"),Kn=p("number"),Jn=Array.prototype.slice,Qn=Array.prototype.indexOf,Zn=Array.prototype.push,nt=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},tt=function(n,e){return j(n,e).map(function(n){var t=Dn.detect(n.versionRegexes,e);return{current:n.name,version:t}})},et=function(n,e){return j(n,e).map(function(n){var t=Dn.detect(n.versionRegexes,e);return{current:n.name,version:t}})},rt=(gn=/^\s+|\s+$/g,function(n){return n.replace(gn,"")}),ot=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,it=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return H(n,"edge/")&&H(n,"chrome")&&H(n,"safari")&&H(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ot],search:function(n){return H(n,"chrome")&&!H(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return H(n,"msie")||H(n,"trident")}},{name:"Opera",versionRegexes:[ot,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:P("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:P("firefox")},{name:"Safari",versionRegexes:[ot,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(H(n,"safari")||H(n,"mobile/"))&&H(n,"applewebkit")}}],ut=[{name:"Windows",search:P("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return H(n,"iphone")||H(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:P("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:P("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:P("linux"),versionRegexes:[]},{name:"Solaris",search:P("sunos"),versionRegexes:[]},{name:"FreeBSD",search:P("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:P("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ct={browsers:b(it),oses:b(ut)},at=En(function(n,t){var e=ct.browsers(),r=ct.oses(),o=tt(e,n).fold(Vn.unknown,Vn.nu),i=et(r,n).fold(Un.unknown,Un.nu);return{browser:o,os:i,deviceType:function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||r("(pointer:coarse)"),a=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!a,s=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),l=!f&&!a&&!s;return{isiPad:b(o),isiPhone:b(i),isTablet:b(a),isPhone:b(f),isTouch:b(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:b(s),isDesktop:b(l)}}(i,o,n,t)}}(g.navigator.userAgent,function(n){return g.window.matchMedia(n).matches})),ft=b("touchstart"),st=b("touchmove"),lt=b("touchend"),dt=b("mousedown"),mt=b("mousemove"),gt=b("mouseup"),pt=b("mouseover"),ht=b("keydown"),vt=b("keyup"),yt=b("input"),bt=b("change"),xt=b("click"),wt=b("transitionend"),St=b("selectstart"),Ot={tap:b("alloy.tap")},Tt=b("alloy.focus"),kt=b("alloy.blur.post"),Et=b("alloy.paste.post"),Ct=b("alloy.receive"),_t=b("alloy.execute"),Dt=b("alloy.focus.item"),Mt=Ot.tap,It=b("alloy.longpress"),Ft=b("alloy.system.init"),Rt=b("alloy.system.attached"),Bt=b("alloy.system.detached"),At=b("alloy.focusmanager.shifted"),Vt=b("alloy.highlight"),Nt=b("alloy.dehighlight"),jt=function(n,t,e,r){var o=x({target:t},r);n.getSystem().triggerEvent(e,t,O(o,b))},Ht=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:b(n)}},Pt={fromHtml:function(n,t){var e=(t||g.document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw g.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Ht(e.childNodes[0])},fromTag:function(n,t){var e=(t||g.document).createElement(n);return Ht(e)},fromText:function(n,t){var e=(t||g.document).createTextNode(n);return Ht(e)},fromDom:Ht,fromPoint:function(n,t,e){var r=n.dom();return yn.from(r.elementFromPoint(t,e)).map(Ht)}},zt=(g.Node.ATTRIBUTE_NODE,g.Node.CDATA_SECTION_NODE,g.Node.COMMENT_NODE,g.Node.DOCUMENT_NODE),Lt=(g.Node.DOCUMENT_TYPE_NODE,g.Node.DOCUMENT_FRAGMENT_NODE,g.Node.ELEMENT_NODE),Gt=g.Node.TEXT_NODE,Ut=(g.Node.PROCESSING_INSTRUCTION_NODE,g.Node.ENTITY_REFERENCE_NODE,g.Node.ENTITY_NODE,g.Node.NOTATION_NODE,"undefined"!=typeof g.window?g.window:Function("return this;")(),q(Lt)),$t=q(Gt),Wt=W(function(){return Xt(Pt.fromDom(g.document))}),Xt=function(n){var t=n.dom().body;if(null===t||t===undefined)throw new Error("Body is not available yet");return Pt.fromDom(t)},qt=Lt,Yt=zt,Kt=(z().browser.isIE(),function(n){return nt(n.dom().childNodes,Pt.fromDom)}),Jt=function(n,t){n.dom().appendChild(t.dom())},Qt=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Zt=function(n){L(n,Bt());var t=n.components();k(t,Zt)},ne=function(n){var t=n.components();k(t,ne),L(n,Rt())},te=function(n,t,e){n.getSystem().addToWorld(t),e(n.element(),t.element()),Y(n.element())&&ne(t),n.syncComponents()},ee=function(n,t,e){e(n,t.element());var r=Kt(t.element());k(r,function(n){t.getByDom(n).each(ne)})},re=function(e){return{is:function(n){return e===n},isValue:a,isError:c,getOr:b(e),getOrThunk:b(e),getOrDie:b(e),or:function(n){return re(e)},orThunk:function(n){return re(e)},fold:function(n,t){return t(e)},map:function(n){return re(n(e))},mapError:function(n){return re(e)},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOption:function(){return yn.some(e)}}},oe=function(e){return{is:c,isValue:c,isError:a,getOr:y,getOrThunk:function(n){return n()},getOrDie:function(){return o(String(e))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,t){return n(e)},map:function(n){return oe(e)},mapError:function(n){return oe(n(e))},each:w,bind:function(n){return oe(e)},exists:c,forall:a,toOption:yn.none}},ie={value:re,error:oe,fromOption:function(n,t){return n.fold(function(){return oe(t)},re)}},ue=function(u){if(!Xn(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],e={};return k(u,function(n,r){var t=bn(n);if(1!==t.length)throw new Error("one and only one name per case");var o=t[0],i=n[o];if(e[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!Xn(i))throw new Error("case arguments must be an array");c.push(o),e[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var e=new Array(n),t=0;t<e.length;t++)e[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,e)},match:function(n){var t=bn(n);if(c.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+t.join(","));if(!R(c,function(n){return T(t,n)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,e)},log:function(n){g.console.log(n,{constructors:c,constructor:o,params:e})}}}}),e},ce=Object.prototype.hasOwnProperty,ae=mn(function(n,t){return Wn(n)&&Wn(t)?ae(n,t):t}),fe=mn(function(n,t){return t});(hn=pn=pn||{})[hn.Error=0]="Error",hn[hn.Value=1]="Value";function se(n,t,e){return n.stype===pn.Error?t(n.serror):e(n.svalue)}function le(n){return{stype:pn.Value,svalue:n}}function de(n){return{stype:pn.Error,serror:n}}function me(n){return Ar.defaultedThunk(b(n))}function ge(n,t){var e;return(e={})[n]=t,e}function pe(n,t){return function(n,e){var r={};return wn(n,function(n,t){T(e,t)||(r[t]=n)}),r}(n,t)}function he(n,t){return ge(n,t)}function ve(n){return function(n){var t={};return k(n,function(n){t[n.key]=n.value}),t}(n)}function ye(n,t){var e=function(n){var t=[],e=[];return k(n,function(n){n.fold(function(n){t.push(n)},function(n){e.push(n)})}),{errors:t,values:e}}(n);return 0<e.errors.length?function(n){return ie.error(I(n))}(e.errors):function(n,t){return 0===n.length?ie.value(t):ie.value(ae(t,fe.apply(undefined,n)))}(e.values,t)}function be(n){return i(Mr,I)(n)}function xe(n){return Wn(n)&&100<bn(n).length?" removed due to size":JSON.stringify(n,null,2)}function we(n,t){return Mr([{path:n,getErrorInfo:t}])}function Se(n,t,e){return Tn(t,e).fold(function(){return function(n,t,e){return we(n,function(){return'Could not find valid *strict* value for "'+t+'" in '+xe(e)})}(n,e,t)},_r)}function Oe(n,t,e){var r=Tn(n,t).fold(function(){return e(n)},y);return _r(r)}function Te(u,c,n,a){return n.fold(function(r,e,n,o){function i(n){var t=o.extract(u.concat([r]),a,n);return Rr(t,function(n){return ge(e,a(n))})}function t(n){return n.fold(function(){var n=ge(e,a(yn.none()));return _r(n)},function(n){var t=o.extract(u.concat([r]),a,n);return Rr(t,function(n){return ge(e,a(yn.some(n)))})})}return n.fold(function(){return Ir(Se(u,c,r),i)},function(n){return Ir(Oe(c,r,n),i)},function(){return Ir(function(n,t){return _r(Tn(n,t))}(c,r),t)},function(n){return Ir(function(t,n,e){var r=Tn(t,n).map(function(n){return!0===n?e(t):n});return _r(r)}(c,r,n),t)},function(n){var t=n(c),e=Rr(Oe(c,r,b({})),function(n){return ae(t,n)});return Ir(e,i)})},function(n,t){var e=t(c);return _r(ge(n,a(e)))})}function ke(r){return{extract:function(t,n,e){return Fr(r(e,n),function(n){return function(n,t){return we(n,function(){return t})}(t,n)})},toString:function(){return"val"}}}function Ee(n){var i=Gr(n),u=C(n,function(t,n){return n.fold(function(n){return ae(t,he(n,!0))},b(t))},{});return{extract:function(n,t,e){var r=qn(e)?[]:function(t){var n=bn(t);return E(n,function(n){return v(t,n)})}(e),o=E(r,function(n){return!v(u,n)});return 0===o.length?i.extract(n,t,e):function(n,t){return we(n,function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"})}(n,o)},toString:i.toString}}function Ce(e,i){function u(n,t){return function(o){return{extract:function(e,r,n){var t=nt(n,function(n,t){return o.extract(e.concat(["["+t+"]"]),r,n)});return zr(t)},toString:function(){return"array("+o.toString()+")"}}}(ke(e)).extract(n,y,t)}return{extract:function(e,r,o){var n=bn(o),t=u(e,n);return Ir(t,function(n){var t=nt(n,function(n){return Lr.field(n,n,Vr(),i)});return Gr(t).extract(e,r,o)})},toString:function(){return"setOf("+i.toString()+")"}}}function _e(t,e,r,n,o){return Tn(n,o).fold(function(){return function(n,t,e){return we(n,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+xe(t)})}(t,n,o)},function(n){return n.extract(t.concat(["branch: "+o]),e,r)})}function De(n,o){return{extract:function(t,e,r){return Tn(r,n).fold(function(){return function(n,t){return we(n,function(){return'Choice schema did not contain choice key: "'+t+'"'})}(t,n)},function(n){return _e(t,e,r,o,n)})},toString:function(){return"chooseOn("+n+"). Possible values: "+bn(o)}}}function Me(t){return ke(function(n){return t(n).fold(Mr,_r)})}function Ie(t,n){return Ce(function(n){return Er(t(n))},n)}function Fe(n,t,e){return Cr(function(n,t,e,r){var o=t.extract([n],e,r);return Br(o,function(n){return{input:r,errors:n}})}(n,t,y,e))}function Re(n){return n.fold(function(n){throw new Error(qr(n))},y)}function Be(n,t,e){return Re(Fe(n,t,e))}function Ae(n,t){return De(n,O(t,Gr))}function Ve(n){return Wr(n,n,Vr(),Ur())}function Ne(n,t){return Wr(n,n,Vr(),t)}function je(n,t){return Wr(n,n,Vr(),Gr(t))}function He(n){return Wr(n,n,Nr(),Ur())}function Pe(n,t){return Wr(n,n,Nr(),t)}function ze(n,t){return Pe(n,Gr(t))}function Le(n,t){return Pe(n,Ee(t))}function Ge(n,t){return Wr(n,n,me(t),Ur())}function Ue(n,t,e){return Wr(n,n,me(t),e)}function $e(n,t){return $r(n,t)}function We(n,t){return nn(n.element(),t.event().target())}function Xe(n){if(!v(n,"can")&&!v(n,"abort")&&!v(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Be("Extracting event.handler",Ee([Ge("can",b(!0)),Ge("abort",b(!1)),Ge("run",w)]),n)}function qe(e){var n=function(t,r){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return _(t,function(n,t){return n&&r(t).apply(undefined,e)},!0)}}(e,function(n){return n.can}),t=function(t,r){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return _(t,function(n,t){return n||r(t).apply(undefined,e)},!1)}}(e,function(n){return n.abort});return Xe({can:n,abort:t,run:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];k(e,function(n){n.run.apply(undefined,t)})}})}function Ye(n){return ve(n)}function Ke(n,t){return{key:n,value:Xe({abort:t})}}function Je(n,t){return{key:n,value:Xe({run:t})}}function Qe(n,e,r){return{key:n,value:Xe({run:function(n,t){e.apply(undefined,[n,t].concat(r))}})}}function Ze(n){return function(e){return{key:n,value:Xe({run:function(n,t){We(n,t)&&e(n,t)}})}}}function nr(n,t,e){return function(e,r){return Je(e,function(n,t){n.getSystem().getByUid(r).each(function(n){!function(n,t,e,r){n.getSystem().triggerEvent(e,t,r.event())}(n,n.element(),e,t)})})}(n,t.partUids[e])}function tr(n){return Je(n,function(n,t){t.cut()})}function er(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:eo(i)}},n}function rr(n){return{classes:n.classes!==undefined?n.classes:[],attributes:n.attributes!==undefined?n.attributes:{},styles:n.styles!==undefined?n.styles:{}}}function or(e,r,o){return no(function(n,t){o(n,e,r)})}function ir(o,i,u){return function(n,t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:eo(u.slice(0,1).concat(u.slice(3)))}},n}(function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=[e].concat(n);return e.config({name:b(o)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+u)},function(n){var t=Array.prototype.slice.call(r,1);return i.apply(undefined,[e,n.config,n.state].concat(t))})},u,i)}function ur(n){return{key:n,value:undefined}}function cr(n){var t=Be("Creating behaviour: "+n.name,co,n);return function(n,t,e,r,o,i){var u=Ee(n),c=ze(t,[Le("config",n)]);return ro(u,c,t,e,r,o,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)}function ar(n,t,e){if(!($n(e)||qn(e)||Kn(e)))throw g.console.error("Invalid call to Attr.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}function fr(n,t,e){ar(n.dom(),t,e)}function sr(n,t){var e=n.dom();wn(t,function(n,t){ar(e,t,n)})}function lr(n,t){var e=n.dom().getAttribute(t);return null===e?undefined:e}function dr(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)}function mr(n,t){n.dom().removeAttribute(t)}function gr(n,t){var e=lr(n,t);return e===undefined||""===e?[]:e.split(" ")}function pr(n){return n.dom().classList!==undefined}function hr(n,t){return function(n,t,e){var r=gr(n,t).concat([e]);return fr(n,t,r.join(" ")),!0}(n,"class",t)}function vr(n,t){return function(n,t,e){var r=E(gr(n,t),function(n){return n!==e});return 0<r.length?fr(n,t,r.join(" ")):mr(n,t),!1}(n,"class",t)}function yr(n,t){pr(n)?n.dom().classList.add(t):hr(n,t)}function br(n){0===(pr(n)?n.dom().classList:function(n){return gr(n,"class")}(n)).length&&mr(n,"class")}function xr(n,t){pr(n)?n.dom().classList.remove(t):vr(n,t),br(n)}function wr(n,t){return pr(n)&&n.dom().classList.contains(t)}function Sr(n,t,e){xr(n,e),yr(n,t)}var Or,Tr,kr,Er=function(n){return n.fold(de,le)},Cr=function(n){return se(n,ie.error,ie.value)},_r=le,Dr=function(n){var t=[],e=[];return k(n,function(n){se(n,function(n){return e.push(n)},function(n){return t.push(n)})}),{values:t,errors:e}},Mr=de,Ir=function(n,t){return n.stype===pn.Value?t(n.svalue):n},Fr=function(n,t){return n.stype===pn.Error?t(n.serror):n},Rr=function(n,t){return n.stype===pn.Value?{stype:pn.Value,svalue:t(n.svalue)}:n},Br=function(n,t){return n.stype===pn.Error?{stype:pn.Error,serror:t(n.serror)}:n},Ar=ue([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Vr=Ar.strict,Nr=Ar.asOption,jr=Ar.defaultedThunk,Hr=(Ar.asDefaultedOptionThunk,Ar.mergeWithThunk),Pr=(ue([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e=Dr(n);return 0<e.errors.length?be(e.errors):function(n,t){return 0<n.length?_r(ae(t,fe.apply(undefined,n))):_r(t)}(e.values,t)}),zr=function(n){var t=Dr(n);return 0<t.errors.length?be(t.errors):_r(t.values)},Lr=ue([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Gr=function(r){return{extract:function(n,t,e){return function(t,e,n,r){var o=nt(n,function(n){return Te(t,e,n,r)});return Pr(o,{})}(n,e,r,t)},toString:function(){return"obj{\n"+nt(r,function(n){return n.fold(function(n,t,e,r){return n+" -> "+r.toString()},function(n,t){return"state("+n+")"})}).join("\n")+"}"}}},Ur=b(ke(_r)),$r=Lr.state,Wr=Lr.field,Xr=ke(_r),qr=function(n){return"Errors: \n"+function(n){var t=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return nt(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})}(n.errors).join("\n")+"\n\nInput object: "+xe(n.input)},Yr=b(Xr),Kr=(Or=Yn,Tr="function",ke(function(n){var t=typeof n;return Or(n)?_r(n):Mr("Expected type: "+Tr+" but got: "+t)})),Jr=function(n,t,e){return t(n).orThunk(function(){return e(n)?yn.none():function(n,t,e){for(var r=n.dom(),o=Yn(e)?e:b(!1);r.parentNode;){r=r.parentNode;var i=Pt.fromDom(r),u=t(i);if(u.isSome())return u;if(o(i))break}return yn.none()}(n,t,e)})},Qr=Ze(Rt()),Zr=Ze(Bt()),no=Ze(Ft()),to=(kr=_t(),function(n){return Je(kr,n)}),eo=function(n){return nt(n,function(n){return function(n,t){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(n,t,n.length-t.length)}(n,"/*")?n.substring(0,n.length-"/*".length):n})},ro=function(e,n,r,o,t,i,u){function c(n){return v(n,r)?n[r]():yn.none()}var a=O(t,function(n,t){return ir(r,n,t)}),f=O(i,function(n,t){return er(n,t)}),s=x(x(x({},f),a),{revoke:S(ur,r),config:function(n){var t=Be(r+"-config",e,n);return{key:r,value:{config:t,me:s,configAsRaw:W(function(){return Be(r+"-config",e,n)}),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(n,e){return c(n).bind(function(t){return Tn(o,"exhibit").map(function(n){return n(e,t.config,t.state)})}).getOr(rr({}))},name:function(){return r},handlers:function(n){return c(n).map(function(n){return Tn(o,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return s},oo={init:function(){return io({readState:function(){return"No State required"}})}},io=function(n){return n},uo=function(n){return ve(n)},co=Ee([Ve("fields"),Ve("name"),Ge("active",{}),Ge("apis",{}),Ge("state",oo),Ge("extra",{})]),ao=Ee([Ve("branchKey"),Ve("branches"),Ve("name"),Ge("active",{}),Ge("apis",{}),Ge("state",oo),Ge("extra",{})]),fo=b(undefined),so=/* */Object.freeze({__proto__:null,toAlpha:function(n,t,e){Sr(n.element(),t.alpha,t.omega)},toOmega:function(n,t,e){Sr(n.element(),t.omega,t.alpha)},isAlpha:function(n,t,e){return wr(n.element(),t.alpha)},isOmega:function(n,t,e){return wr(n.element(),t.omega)},clear:function(n,t,e){xr(n.element(),t.alpha),xr(n.element(),t.omega)}}),lo=[Ve("alpha"),Ve("omega")],mo=cr({fields:lo,name:"swapping",apis:so});function go(n,t,e,r,o){return n(e,r)?yn.some(e):Yn(o)&&o(e)?yn.none():t(e,r,o)}function po(n,t,e){for(var r=n.dom(),o=Yn(e)?e:b(!1);r.parentNode;){r=r.parentNode;var i=Pt.fromDom(r);if(t(i))return yn.some(i);if(o(i))break}return yn.none()}function ho(n){n.dom().focus()}function vo(n){n.dom().blur()}function yo(n){var t=n!==undefined?n.dom():g.document;return yn.from(t.activeElement).map(Pt.fromDom)}function bo(t){return yo(tn(t)).filter(function(n){return t.dom().contains(n.dom())})}function xo(n){return n.dom().innerHTML}function wo(n,t){var e=tn(n).dom(),r=Pt.fromDom(e.createDocumentFragment()),o=function(n,t){var e=(t||g.document).createElement("div");return e.innerHTML=n,Kt(Pt.fromDom(e))}(t,e);an(r,o),fn(n),Jt(n,r)}function So(n){return function(n,t){return Pt.fromDom(n.dom().cloneNode(t))}(n,!1)}function Oo(n){return function(n){var t=Pt.fromTag("div"),e=Pt.fromDom(n.dom().cloneNode(!0));return Jt(t,e),xo(t)}(So(n))}function To(n){return Oo(n)}var ko,Eo,Co=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),_o=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Do="formatChanged",Mo="orientationChanged",Io="dropupDismissed",Fo=/* */Object.freeze({__proto__:null,events:function(r){return Ye([Je(Ct(),function(o,n){var i=r.channels,t=bn(i),u=n,e=function(n,t){return t.universal()?n:E(n,function(n){return T(t.channels(),n)})}(t,u);k(e,function(n){var t=i[n],e=t.schema,r=Be("channel["+n+"] data\nReceiver: "+To(o.element()),e,u.data());t.onReceive(o,r)})})])}}),Ro="unknown";(Eo=ko=ko||{})[Eo.STOP=0]="STOP",Eo[Eo.NORMAL=1]="NORMAL",Eo[Eo.LOGGING=2]="LOGGING";function Bo(t,n,e){switch(Tn(ai.get(),t).orThunk(function(){var n=bn(ai.get());return N(n,function(n){return-1<t.indexOf(n)?yn.some(ai.get()[n]):yn.none()})}).getOr(ko.NORMAL)){case ko.NORMAL:return e(si());case ko.LOGGING:var r=function(t,e){var r=[],o=(new Date).getTime();return{logEventCut:function(n,t,e){r.push({outcome:"cut",target:t,purpose:e})},logEventStopped:function(n,t,e){r.push({outcome:"stopped",target:t,purpose:e})},logNoParent:function(n,t,e){r.push({outcome:"no-parent",target:t,purpose:e})},logEventNoHandlers:function(n,t){r.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,e){r.push({outcome:"response",purpose:e,target:t})},write:function(){var n=(new Date).getTime();T(["mousemove","mouseover","mouseout",Ft()],t)||g.console.log(t,{event:t,time:n-o,target:e.dom(),sequence:nt(r,function(n){return T(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+To(n.target)+")":n.outcome})})}}}(t,n),o=e(r);return r.write(),o;case ko.STOP:return!0}}function Ao(n,t,e){return Bo(n,t,e)}function Vo(n,t,e){return function(){var n=new Error;if(n.stack===undefined)return;var t=n.stack.split("\n");D(t,function(t){return 0<t.indexOf("alloy")&&!h(fi,function(n){return-1<t.indexOf(n)})}).getOr(Ro)}(),Wr(t,t,e,Me(function(e){return ie.value(function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.apply(undefined,n)})}))}function No(n){return Vo(0,n,me(w))}function jo(n){return Vo(0,n,me(yn.none))}function Ho(n){return Vo(0,n,Vr())}function Po(n){return Vo(0,n,Vr())}function zo(n,t){return $e(n,b(t))}function Lo(n){return $e(n,y)}function Go(n,t,e){var r=t.aria;r.update(n,r,e.get())}function Uo(t,n,e){n.toggleClass.each(function(n){e.get()?yr(t.element(),n):xr(t.element(),n)})}function $o(n,t,e){yi(n,t,e,!e.get())}function Wo(n,t,e){e.set(!0),Uo(n,t,e),Go(n,t,e)}function Xo(n,t,e){e.set(!1),Uo(n,t,e),Go(n,t,e)}function qo(n,t,e){yi(n,t,e,t.selected)}function Yo(e,r){return vi.config({channels:he(Do,{onReceive:function(n,t){t.command===e&&r(n,t.state)}})})}function Ko(n){return vi.config({channels:he(Mo,{onReceive:n})})}function Jo(n,t){return{key:n,value:{onReceive:t}}}function Qo(){function n(n,t){t.stop(),U(n)}return[Je(xt(),n),Je(Mt(),n),tr(ft()),tr(dt())]}function Zo(n,t){t.ignore||(ho(n.element()),t.onFocus(n))}function ni(n){return n.style!==undefined&&Yn(n.style.getPropertyValue)}function ti(n,t,e){if(!$n(e))throw g.console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);ni(n)&&n.style.setProperty(t,e)}function ei(n,t){var e=n.dom();wn(t,function(n,t){ti(e,t,n)})}function ri(n,t){var e=n.dom(),r=g.window.getComputedStyle(e).getPropertyValue(t),o=""!==r||Y(n)?r:Ii(e,t);return null===o?undefined:o}function oi(n,t){var e=n.dom(),r=Ii(e,t);return yn.from(r).filter(function(n){return 0<n.length})}function ii(n,t){!function(n,t){ni(n)&&n.style.removeProperty(t)}(n.dom(),t),dr(n,"style")&&""===rt(lr(n,"style"))&&mr(n,"style")}function ui(n){return n.dom().offsetWidth}var ci,ai=En({}),fi=["alloy/data/Fields","alloy/debugging/Debugging"],si=b({logEventCut:w,logEventStopped:w,logNoParent:w,logEventNoHandlers:w,logEventResponse:w,write:w}),li=b([Ve("menu"),Ve("selectedMenu")]),di=b([Ve("item"),Ve("selectedItem")]),mi=(b(Gr(di().concat(li()))),b(Gr(di()))),gi=je("initSize",[Ve("numColumns"),Ve("numRows")]),pi=b(gi),hi=[Ne("channels",Ie(ie.value,Ee([Ho("onReceive"),Ge("schema",Yr())])))],vi=cr({fields:hi,name:"receiving",active:Fo}),yi=function(n,t,e,r){(r?Wo:Xo)(n,t,e)},bi=/* */Object.freeze({__proto__:null,onLoad:qo,toggle:$o,isOn:function(n,t,e){return e.get()},on:Wo,off:Xo,set:yi}),xi=/* */Object.freeze({__proto__:null,exhibit:function(){return rr({})},events:function(n,t){var e=function(t,e,r){return to(function(n){r(n,t,e)})}(n,t,$o),r=or(n,t,qo);return Ye(I([n.toggleOnExecute?[e]:[],[r]]))}}),wi=function(n,t,e){fr(n.element(),"aria-expanded",e)},Si=[Ge("selected",!1),He("toggleClass"),Ge("toggleOnExecute",!0),Ue("aria",{mode:"none"},Ae("mode",{pressed:[Ge("syncWithExpanded",!1),zo("update",function(n,t,e){fr(n.element(),"aria-pressed",e),t.syncWithExpanded&&wi(n,t,e)})],checked:[zo("update",function(n,t,e){fr(n.element(),"aria-checked",e)})],expanded:[zo("update",wi)],selected:[zo("update",function(n,t,e){fr(n.element(),"aria-selected",e)})],none:[zo("update",w)]}))],Oi=cr({fields:Si,name:"toggling",active:xi,apis:bi,state:(ci=!1,{init:function(){var t=En(ci);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(ci)},readState:function(){return t.get()}}}})}),Ti="tinymce-mobile",ki=function(n){return Ti+"-"+n},Ei=/* */Object.freeze({__proto__:null,focus:Zo,blur:function(n,t){t.ignore||vo(n.element())},isFocused:function(n){return function(n){var t=tn(n).dom();return n.dom()===t.activeElement}(n.element())}}),Ci=/* */Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return rr(e)},events:function(e){return Ye([Je(Tt(),function(n,t){Zo(n,e),t.stop()})].concat(e.stopMousedown?[Je(dt(),function(n,t){t.event().prevent()})]:[]))}}),_i=[No("onFocus"),Ge("stopMousedown",!1),Ge("ignore",!1)],Di=cr({fields:_i,name:"focusing",active:Ci,apis:Ei}),Mi=function(n,t,e){var r=n.dom();ti(r,t,e)},Ii=function(n,t){return ni(n)?n.style.getPropertyValue(t):""};function Fi(r,o){function n(n){var t=o(n);if(t<=0||null===t){var e=ri(n,r);return parseFloat(e)||0}return t}function i(o,n){return _(n,function(n,t){var e=ri(o,t),r=e===undefined?0:parseInt(e,10);return isNaN(r)?n:n+r},0)}return{set:function(n,t){if(!Kn(t)&&!t.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+t);var e=n.dom();ni(e)&&(e.style[r]=t+"px")},get:n,getOuter:n,aggregate:i,max:function(n,t,e){var r=i(n,e);return r<t?t-r:0}}}function Ri(n){return uu.get(n)}function Bi(n,t,e){return E(function(n,t){for(var e=Yn(t)?t:c,r=n.dom(),o=[];null!==r.parentNode&&r.parentNode!==undefined;){var i=r.parentNode,u=Pt.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o}(n,e),t)}function Ai(n,t){return E(function(t){return en(t).map(Kt).map(function(n){return E(n,function(n){return!nn(t,n)})}).getOr([])}(n),t)}function Vi(n,t){return Q(t,n)}function Ni(n){return Z(n)}function ji(n,t,e){return po(n,function(n){return K(n,t)},e)}function Hi(n,t){return Z(t,n)}function Pi(n,t,e){return go(K,ji,n,t,e)}function zi(n,t,e){var r=B(n.slice(0,t)),o=B(n.slice(t+1));return D(r.concat(o),e)}function Li(n,t,e){var r=B(n.slice(0,t));return D(r,e)}function Gi(n,t,e){var r=n.slice(0,t),o=n.slice(t+1);return D(o.concat(r),e)}function Ui(n,t,e){var r=n.slice(t+1);return D(r,e)}function $i(e){return function(n){var t=n.raw();return T(e,t.which)}}function Wi(n){return function(t){return R(n,function(n){return n(t)})}}function Xi(n){return!0===n.raw().shiftKey}function qi(n){return!0===n.raw().ctrlKey}function Yi(n,t){return{matches:n,classification:t}}function Ki(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}function Ji(n,t,e,r){var o=n+t;return r<o?e:o<e?r:o}function Qi(n,t,e){return Math.min(Math.max(n,t),e)}function Zi(e,r,n,o){var t=Vi(e.element(),"."+r.highlightClass);k(t,function(t){h(o,function(n){return n.element()===t})||(xr(t,r.highlightClass),e.getSystem().getByDom(t).each(function(n){r.onDehighlight(e,n),L(n,Nt())}))})}function nu(n,t,e,r){Zi(n,t,0,[r]),au(n,t,e,r)||(yr(r.element(),t.highlightClass),t.onHighlight(n,r),L(r,Vt()))}function tu(e,t,n,r){var o=Vi(e.element(),"."+t.itemClass);return M(o,function(n){return wr(n,t.highlightClass)}).bind(function(n){var t=Ji(n,r,0,o.length-1);return e.getSystem().getByDom(o[t]).toOption()})}function eu(n,t,e){t.exists(function(t){return e.exists(function(n){return nn(n,t)})})||G(n,At(),{prevFocus:t,newFocus:e})}function ru(){function o(n){return bo(n.element())}return{get:o,set:function(n,t){var e=o(n);n.getSystem().triggerFocus(t,n.element());var r=o(n);eu(n,e,r)}}}var ou,iu,uu=Fi("height",function(n){var t=n.dom();return Y(n)?t.getBoundingClientRect().height:t.offsetHeight}),cu=m(Xi),au=function(n,t,e,r){return wr(r.element(),t.highlightClass)},fu=function(n,t,e,r){var o=Vi(n.element(),"."+t.itemClass);return yn.from(o[r]).fold(function(){return ie.error("No element found with index "+r)},n.getSystem().getByDom)},su=function(t,n,e){return Hi(t.element(),"."+n.itemClass).bind(function(n){return t.getSystem().getByDom(n).toOption()})},lu=function(t,n,e){var r=Vi(t.element(),"."+n.itemClass);return(0<r.length?yn.some(r[r.length-1]):yn.none()).bind(function(n){return t.getSystem().getByDom(n).toOption()})},du=function(t,n,e){var r=Vi(t.element(),"."+n.itemClass);return Ki(nt(r,function(n){return t.getSystem().getByDom(n).toOption()}))},mu=/* */Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return Zi(n,t,0,[])},dehighlight:function(n,t,e,r){au(n,t,e,r)&&(xr(r.element(),t.highlightClass),t.onDehighlight(n,r),L(r,Nt()))},highlight:nu,highlightFirst:function(t,e,r){su(t,e).each(function(n){nu(t,e,r,n)})},highlightLast:function(t,e,r){lu(t,e).each(function(n){nu(t,e,r,n)})},highlightAt:function(t,e,r,n){fu(t,e,r,n).fold(function(n){throw new Error(n)},function(n){nu(t,e,r,n)})},highlightBy:function(t,e,r,n){var o=du(t,e);D(o,n).each(function(n){nu(t,e,r,n)})},isHighlighted:au,getHighlighted:function(t,n,e){return Hi(t.element(),"."+n.highlightClass).bind(function(n){return t.getSystem().getByDom(n).toOption()})},getFirst:su,getLast:lu,getPrevious:function(n,t,e){return tu(n,t,0,-1)},getNext:function(n,t,e){return tu(n,t,0,1)},getCandidates:du}),gu=[Ve("highlightClass"),Ve("itemClass"),No("onHighlight"),No("onDehighlight")],pu=cr({fields:gu,name:"highlighting",apis:mu});(iu=ou=ou||{}).OnFocusMode="onFocus",iu.OnEnterOrSpaceMode="onEnterOrSpace",iu.OnApiMode="onApi";function hu(n,t,e,i,u){function c(t,e,n,r,o){return function(n,t){return D(n,function(n){return n.matches(t)}).map(function(n){return n.classification})}(n(t,e,r,o),e.event()).bind(function(n){return n(t,e,r,o)})}var r={schema:function(){return n.concat([Ge("focusManager",ru()),Ue("focusInside","onFocus",Me(function(n){return T(["onFocus","onEnterOrSpace","onApi"],n)?ie.value(n):ie.error("Invalid value for focusInside")})),zo("handler",r),zo("state",t),zo("sendFocusIn",u)])},processKey:c,toEvents:function(r,o){var n=r.focusInside!==ou.OnFocusMode?yn.none():u(r).map(function(e){return Je(Tt(),function(n,t){e(n,r,o),t.stop()})});return Ye(n.toArray().concat([Je(ht(),function(n,t){c(n,t,e,r,o).fold(function(){!function(t,e){var n=$i([32].concat([13]))(e.event());r.focusInside===ou.OnEnterOrSpaceMode&&n&&We(t,e)&&u(r).each(function(n){n(t,r,o),e.stop()})}(n,t)},function(n){t.stop()})}),Je(vt(),function(n,t){c(n,t,i,r,o).each(function(n){t.stop()})})]))}};return r}function vu(n){function i(n,t){var e=n.visibilitySelector.bind(function(n){return Pi(t,n)}).getOr(t);return 0<Ri(e)}function t(t,e,n){(function(n,t){var e=Vi(n.element(),t.selector),r=E(e,function(n){return i(t,n)});return yn.from(r[t.firstTabstop])})(t,e).each(function(n){e.focusManager.set(t,n)})}function u(t,n,e,r,o){return o(n,e,function(n){return function(n,t){return i(n,t)&&n.useTabstopAt(t)}(r,n)}).fold(function(){return r.cyclic?yn.some(!0):yn.none()},function(n){return r.focusManager.set(t,n),yn.some(!0)})}function o(t,n,e,r){var o=Vi(t.element(),e.selector);return function(n,t){return t.focusManager.get(n).bind(function(n){return Pi(n,t.selector)})}(t,e).bind(function(n){return M(o,S(nn,n)).bind(function(n){return u(t,o,n,e,r)})})}var e=[He("onEscape"),He("onEnter"),Ge("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ge("firstTabstop",0),Ge("useTabstopAt",b(!0)),He("visibilitySelector")].concat([n]),r=b([Yi(Wi([Xi,$i([9])]),function(n,t,e){var r=e.cyclic?zi:Li;return o(n,0,e,r)}),Yi($i([9]),function(n,t,e){var r=e.cyclic?Gi:Ui;return o(n,0,e,r)}),Yi($i([27]),function(t,e,n){return n.onEscape.bind(function(n){return n(t,e)})}),Yi(Wi([cu,$i([13])]),function(t,e,n){return n.onEnter.bind(function(n){return n(t,e)})})]),c=b([]);return hu(e,oo.init,r,c,function(){return yn.some(t)})}function yu(n){return"input"===X(n)&&"radio"!==lr(n,"type")||"textarea"===X(n)}function bu(n,t,e){return yu(e)&&$i([32])(t.event())?yn.none():function(n,t,e){return $(n,e,_t()),yn.some(!0)}(n,0,e)}function xu(n,t){return yn.some(!0)}function wu(n,t,e){return e.execute(n,t,n.element())}function Su(){var e=En(yn.none());return io({readState:function(){return e.get().map(function(n){return{numRows:String(n.numRows()),numColumns:String(n.numColumns())}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,t){e.set(yn.some({numRows:b(n),numColumns:b(t)}))},getNumRows:function(){return e.get().map(function(n){return n.numRows()})},getNumColumns:function(){return e.get().map(function(n){return n.numColumns()})}})}function Ou(t,e){return function(n){return"rtl"===zc(n)?e:t}}function Tu(i){return function(n,t,e,r){var o=i(n.element());return Lc(o,n,t,e,r)}}function ku(n,t){var e=Ou(n,t);return Tu(e)}function Eu(n,t){var e=Ou(t,n);return Tu(e)}function Cu(o){return function(n,t,e,r){return Lc(o,n,t,e,r)}}function _u(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom())}function Du(n,t,e){var r=Vi(n,e);return function(t,n){return M(t,n).map(function(n){return{index:b(n),candidates:b(t)}})}(E(r,_u),function(n){return nn(n,t)})}function Mu(n,t){return M(n,function(n){return nn(t,n)})}function Iu(e,n,r,t){return t(Math.floor(n/r),n%r).bind(function(n){var t=n.row()*r+n.column();return 0<=t&&t<e.length?yn.some(e[t]):yn.none()})}function Fu(o,n,i,u,c){return Iu(o,n,u,function(n,t){var e=n===i-1?o.length-n*u:u,r=Ji(t,c,0,e-1);return yn.some({row:b(n),column:b(r)})})}function Ru(i,n,u,c,a){return Iu(i,n,c,function(n,t){var e=Ji(n,a,0,u-1),r=e===u-1?i.length-e*c:c,o=Qi(t,0,r-1);return yn.some({row:b(e),column:b(o)})})}function Bu(t,e,n){Hi(t.element(),e.selector).each(function(n){e.focusManager.set(t,n)})}function Au(o){return function(n,t,e,r){return Du(n,t,e.selector).bind(function(n){return o(n.candidates(),n.index(),r.getNumRows().getOr(e.initSize.numRows),r.getNumColumns().getOr(e.initSize.numColumns))})}}function Vu(n,t,e){return e.captureTab?yn.some(!0):yn.none()}function Nu(n,t,e,o){var i=function(n,t,e){var r=Ji(t,o,0,e.length-1);return r===n?yn.none():function(n){return"button"===X(n)&&"disabled"===lr(n,"disabled")}(e[r])?i(n,r,e):yn.from(e[r])};return Du(n,e,t).bind(function(n){var t=n.index(),e=n.candidates();return i(t,t,e)})}function ju(t,e,r){return function(n,t){return t.focusManager.get(n).bind(function(n){return Pi(n,t.selector)})}(t,r).bind(function(n){return r.execute(t,e,n)})}function Hu(t,e,n){e.getInitial(t).orThunk(function(){return Hi(t.element(),e.selector)}).each(function(n){e.focusManager.set(t,n)})}function Pu(n,t,e){return Nu(n,e.selector,t,-1)}function zu(n,t,e){return Nu(n,e.selector,t,1)}function Lu(o){return function(n,t,e,r){return o(n,t,e,r).bind(function(){return e.executeOnMove?ju(n,t,e):yn.some(!0)})}}function Gu(n,t,e){return e.onEscape(n,t)}function Uu(n){return n.slice(0).sort()}function $u(t,n){if(!Xn(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");k(n,function(n){if(!$n(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})}function Wu(o,i){var u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return $u("required",o),$u("optional",i),function(n){var e=Uu(n);D(e,function(n,t){return t<e.length-1&&n===e[t+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}(u),function(t){var e=bn(t);R(o,function(n){return T(e,n)})||function(n,t){throw new Error("All required keys ("+Uu(n).join(", ")+") were not specified. Specified keys were: "+Uu(t).join(", ")+".")}(o,e);var n=E(e,function(n){return!T(u,n)});0<n.length&&function(n){throw new Error("Unsupported keys for object: "+Uu(n).join(", "))}(n);var r={};return k(o,function(n){r[n]=b(t[n])}),k(i,function(n){r[n]=b(Object.prototype.hasOwnProperty.call(t,n)?yn.some(t[n]):yn.none())}),r}}function Xu(n,t,e){return yn.from(n[t]).bind(function(n){return yn.from(n[e]).map(function(n){return ra({rowIndex:t,columnIndex:e,cell:n})})})}function qu(n,t,e,r){var o=n[t].length,i=Ji(e,r,0,o-1);return Xu(n,t,i)}function Yu(n,t,e,r){var o=Ji(e,r,0,n.length-1),i=n[o].length,u=Qi(t,0,i-1);return Xu(n,o,u)}function Ku(n,t,e,r){var o=n[t].length,i=Qi(e+r,0,o-1);return Xu(n,t,i)}function Ju(n,t,e,r){var o=Qi(e+r,0,n.length-1),i=n[o].length,u=Qi(t,0,i-1);return Xu(n,o,u)}function Qu(t,e,n){e.previousSelector(t).orThunk(function(){var n=e.selectors;return Hi(t.element(),n.cell)}).each(function(n){e.focusManager.set(t,n)})}function Zu(n,t){return function(o,e,i){var u=i.cycles?n:t;return Pi(e,i.selectors.row).bind(function(n){var t=Vi(n,i.selectors.cell);return Mu(t,e).bind(function(e){var r=Vi(o,i.selectors.row);return Mu(r,n).bind(function(n){var t=function(n,t){return nt(n,function(n){return Vi(n,t.selectors.cell)})}(r,i);return u(t,n,e).map(function(n){return n.cell()})})})})}}function nc(t,e,r){return r.focusManager.get(t).bind(function(n){return r.execute(t,e,n)})}function tc(t,e,n){Hi(t.element(),e.selector).each(function(n){e.focusManager.set(t,n)})}function ec(n,t,e){return Nu(n,e.selector,t,-1)}function rc(n,t,e){return Nu(n,e.selector,t,1)}function oc(t,n){return function(n,t,e){return Ue(n,t,Gr(e))}(t,{},nt(n,function(n){return function(t,e){return Wr(t,t,Nr(),ke(function(n){return Mr("The field: "+t+" is forbidden. "+e)}))}(n.name(),"Cannot configure "+n.name()+" for "+t)}).concat([$e("dump",y)]))}function ic(n){return n.dump}function uc(n,t){return x(x({},n.dump),uo(t))}function cc(n){return kn(n,"uiType")}function ac(n,t,e,r){return cc(e)&&e.uiType===Da?function(n,t,e,r){return n.exists(function(n){return n!==e.owner})?Ma.single(!0,b(e)):Tn(r,e.name).fold(function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+bn(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))},function(n){return n.replace()})}(n,0,e,r):Ma.single(!1,b(e))}function fc(t,e,n,r){var o=O(r,function(n,t){return function(n,t){var e=!1;return{name:b(n),required:function(){return t.fold(function(n,t){return n},function(n,t){return n})},used:function(){return e},replace:function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t}}}(t,n)}),i=function(t,e,n,r){return F(n,function(n){return Ia(t,e,n,r)})}(t,e,n,o);return wn(o,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),i}function sc(n){var t=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Aa+String(t)}function lc(n){function t(n){return n.name}return n.fold(t,t,t,t)}function dc(e,r){return function(n){var t=Be("Converting part type",r,n);return e(t)}}function mc(n,t,e,r){return ae(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))}function gc(o,n){var t={};return k(n,function(n){(function(n){return n.fold(yn.some,yn.none,yn.some,yn.some)})(n).each(function(e){var r=Qa(o,e.pname);t[e.name]=function(n){var t=Be("Part: "+e.name+" in "+o,Gr(e.schema),n);return x(x({},r),{config:n,validated:t})}})}),t}function pc(n,t,e){return function(n,e,t){var i={},r={};return k(t,function(n){n.fold(function(r){i[r.pname]=Fa(!0,function(n,t,e){return r.factory.sketch(mc(n,r,t,e))})},function(n){var t=e.parts[n.name];r[n.name]=b(n.factory.sketch(mc(e,n,t[Ja()]),t))},function(r){i[r.pname]=Fa(!1,function(n,t,e){return r.factory.sketch(mc(n,r,t,e))})},function(o){i[o.pname]=Ra(!0,function(t,n,e){var r=t[o.name];return nt(r,function(n){return o.factory.sketch(ae(o.defaults(t,n,e),n,o.overrides(t,n)))})})})}),{internals:b(i),externals:b(r)}}(0,t,e)}function hc(n,t,e){return fc(yn.some(n),t,t.components,e)}function vc(n,t,e){var r=t.partUids[e];return n.getSystem().getByUid(r).toOption()}function yc(n,t,e){return vc(n,t,e).getOrDie("Could not find part: "+e)}function bc(t,n){var e=function(n){return nt(n,lc)}(n);return ve(nt(e,function(n){return{key:n,value:t+"-"+n}}))}function xc(t){return Wr("partUids","partUids",Hr(function(n){return bc(n.uid,t)}),Yr())}function wc(n){return he(Za,n)}function Sc(r){return function(n,t){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:eo(i.slice(1))}},n}(function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return r.apply(undefined,[n.getApis()].concat([n].concat(t)))},r)}function Oc(n){return sc(n)}function Tc(n,t,e,r,o){var i=function(n,t){return(0<n.length?[je("parts",n)]:[]).concat([Ve("uid"),Ge("dom",{}),Ge("components",[]),Lo("originalSpec"),Ge("debug.sketcher",{})]).concat(t)}(r,o);return Be(n+" [SpecSchema]",Ee(i.concat(t)),e)}function kc(n,t,e,r,o){var i=cf(o),u=function(n){return F(n,function(n){return n.fold(yn.none,yn.some,yn.none,yn.none).map(function(n){return je(n.name,n.schema.concat([Lo(Ja())]))}).toArray()})}(e),c=xc(e),a=Tc(n,t,i,u,[c]),f=pc(0,a,e);return r(a,hc(n,a,f.internals()),i,f.externals())}var Ec,Cc,_c,Dc,Mc,Ic,Fc,Rc,Bc,Ac,Vc=vu($e("cyclic",b(!1))),Nc=vu($e("cyclic",b(!0))),jc=[Ge("execute",bu),Ge("useSpace",!1),Ge("useEnter",!0),Ge("useControlEnter",!1),Ge("useDown",!1)],Hc=hu(jc,oo.init,function(n,t,e,r){var o=e.useSpace&&!yu(n.element())?[32]:[],i=e.useEnter?[13]:[],u=e.useDown?[40]:[],c=o.concat(i).concat(u);return[Yi($i(c),wu)].concat(e.useControlEnter?[Yi(Wi([qi,$i([13])]),wu)]:[])},function(n,t,e,r){return e.useSpace&&!yu(n.element())?[Yi($i([32]),xu)]:[]},function(){return yn.none()}),Pc=/* */Object.freeze({__proto__:null,flatgrid:Su,init:function(n){return n.state(n)}}),zc=function(n){return"rtl"===ri(n,"direction")?"rtl":"ltr"},Lc=function(t,e,n,r,o){return r.focusManager.get(e).bind(function(n){return t(e.element(),n,r,o)}).map(function(n){return r.focusManager.set(e,n),!0})},Gc=Cu,Uc=Cu,$c=Cu,Wc=[Ve("selector"),Ge("execute",bu),jo("onEscape"),Ge("captureTab",!1),pi()],Xc=Au(function(n,t,e,r){return Fu(n,t,e,r,-1)}),qc=Au(function(n,t,e,r){return Fu(n,t,e,r,1)}),Yc=Au(function(n,t,e,r){return Ru(n,t,e,r,-1)}),Kc=Au(function(n,t,e,r){return Ru(n,t,e,r,1)}),Jc=b([Yi($i([37]),ku(Xc,qc)),Yi($i([39]),Eu(Xc,qc)),Yi($i([38]),Gc(Yc)),Yi($i([40]),Uc(Kc)),Yi(Wi([Xi,$i([9])]),Vu),Yi(Wi([cu,$i([9])]),Vu),Yi($i([27]),function(n,t,e){return e.onEscape(n,t)}),Yi($i([32].concat([13])),function(t,e,r,n){return function(n,t){return t.focusManager.get(n).bind(function(n){return Pi(n,t.selector)})}(t,r).bind(function(n){return r.execute(t,e,n)})})]),Qc=b([Yi($i([32]),xu)]),Zc=hu(Wc,Su,Jc,Qc,function(){return yn.some(Bu)}),na=[Ve("selector"),Ge("getInitial",yn.none),Ge("execute",bu),jo("onEscape"),Ge("executeOnMove",!1),Ge("allowVertical",!0)],ta=b([Yi($i([32]),xu)]),ea=hu(na,oo.init,function(n,t,e,r){var o=[37].concat(e.allowVertical?[38]:[]),i=[39].concat(e.allowVertical?[40]:[]);return[Yi($i(o),Lu(ku(Pu,zu))),Yi($i(i),Lu(Eu(Pu,zu))),Yi($i([13]),ju),Yi($i([32]),ju),Yi($i([27]),Gu)]},ta,function(){return yn.some(Hu)}),ra=Wu(["rowIndex","columnIndex","cell"],[]),oa=[je("selectors",[Ve("row"),Ve("cell")]),Ge("cycles",!0),Ge("previousSelector",yn.none),Ge("execute",bu)],ia=Zu(function(n,t,e){return qu(n,t,e,-1)},function(n,t,e){return Ku(n,t,e,-1)}),ua=Zu(function(n,t,e){return qu(n,t,e,1)},function(n,t,e){return Ku(n,t,e,1)}),ca=Zu(function(n,t,e){return Yu(n,e,t,-1)},function(n,t,e){return Ju(n,e,t,-1)}),aa=Zu(function(n,t,e){return Yu(n,e,t,1)},function(n,t,e){return Ju(n,e,t,1)}),fa=b([Yi($i([37]),ku(ia,ua)),Yi($i([39]),Eu(ia,ua)),Yi($i([38]),Gc(ca)),Yi($i([40]),Uc(aa)),Yi($i([32].concat([13])),function(t,e,r){return bo(t.element()).bind(function(n){return r.execute(t,e,n)})})]),sa=b([Yi($i([32]),xu)]),la=hu(oa,oo.init,fa,sa,function(){return yn.some(Qu)}),da=[Ve("selector"),Ge("execute",bu),Ge("moveOnTab",!1)],ma=b([Yi($i([38]),$c(ec)),Yi($i([40]),$c(rc)),Yi(Wi([Xi,$i([9])]),function(n,t,e,r){return e.moveOnTab?$c(ec)(n,t,e,r):yn.none()}),Yi(Wi([cu,$i([9])]),function(n,t,e,r){return e.moveOnTab?$c(rc)(n,t,e,r):yn.none()}),Yi($i([13]),nc),Yi($i([32]),nc)]),ga=b([Yi($i([32]),xu)]),pa=hu(da,oo.init,ma,ga,function(){return yn.some(tc)}),ha=[jo("onSpace"),jo("onEnter"),jo("onShiftEnter"),jo("onLeft"),jo("onRight"),jo("onTab"),jo("onShiftTab"),jo("onUp"),jo("onDown"),jo("onEscape"),Ge("stopSpaceKeyup",!1),He("focusIn")],va=hu(ha,oo.init,function(n,t,e){return[Yi($i([32]),e.onSpace),Yi(Wi([cu,$i([13])]),e.onEnter),Yi(Wi([Xi,$i([13])]),e.onShiftEnter),Yi(Wi([Xi,$i([9])]),e.onShiftTab),Yi(Wi([cu,$i([9])]),e.onTab),Yi($i([38]),e.onUp),Yi($i([40]),e.onDown),Yi($i([37]),e.onLeft),Yi($i([39]),e.onRight),Yi($i([32]),e.onSpace),Yi($i([27]),e.onEscape)]},function(n,t,e){return e.stopSpaceKeyup?[Yi($i([32]),xu)]:[]},function(n){return n.focusIn}),ya=Vc.schema(),ba=Nc.schema(),xa=ea.schema(),wa=Zc.schema(),Sa=la.schema(),Oa=Hc.schema(),Ta=pa.schema(),ka=va.schema(),Ea=(Ac=Be("Creating behaviour: "+(Bc={branchKey:"mode",branches:/* */Object.freeze({__proto__:null,acyclic:ya,cyclic:ba,flow:xa,flatgrid:wa,matrix:Sa,execution:Oa,menu:Ta,special:ka}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(t,e,r){e.sendFocusIn(e).fold(function(){t.getSystem().triggerFocus(t.element(),t.element())},function(n){n(t,e,r)})},setGridSize:function(n,t,e,r,o){!function(n){return v(n,"setGridSize")}(e)?g.console.error("Layout does not support setGridSize"):e.setGridSize(r,o)}},state:Pc}).name,ao,Bc),Ec=Ae(Ac.branchKey,Ac.branches),Cc=Ac.name,_c=Ac.active,Dc=Ac.apis,Mc=Ac.extra,Ic=Ac.state,Rc=ze(Cc,[Pe("config",Fc=Ec)]),ro(Fc,Rc,Cc,_c,Dc,Mc,Ic)),Ca=oc,_a=uc,Da="placeholder",Ma=ue([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Ia=function(i,u,c,a){return ac(i,0,c,a).fold(function(n,t){var e=cc(c)?t(u,c.config,c.validated):t(u),r=Tn(e,"components").getOr([]),o=F(r,function(n){return Ia(i,u,n,a)});return[x(x({},e),{components:o})]},function(n,t){if(cc(c)){var e=t(u,c.config,c.validated);return c.validated.preprocess.getOr(y)(e)}return t(u)})},Fa=Ma.single,Ra=Ma.multiple,Ba=b(Da),Aa=0,Va=ue([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Na=Ge("factory",{sketch:y}),ja=Ge("schema",[]),Ha=Ve("name"),Pa=Wr("pname","pname",jr(function(n){return"<alloy."+sc(n.name)+">"}),Yr()),za=$e("schema",function(){return[He("preprocess")]}),La=Ge("defaults",b({})),Ga=Ge("overrides",b({})),Ua=Gr([Na,ja,Ha,Pa,La,Ga]),$a=Gr([Na,ja,Ha,La,Ga]),Wa=Gr([Na,ja,Ha,Pa,La,Ga]),Xa=Gr([Na,za,Ha,Ve("unit"),Pa,La,Ga]),qa=dc(Va.required,Ua),Ya=(dc(Va.external,$a),dc(Va.optional,Wa)),Ka=dc(Va.group,Xa),Ja=b("entirety"),Qa=function(n,t){return{uiType:Ba(),owner:n,name:t}},Za=sc("alloy-premade"),nf=b("alloy-id-"),tf=b("data-alloy-id"),ef=nf(),rf=tf(),of=function(n,t){Object.defineProperty(n.dom(),rf,{value:t,writable:!0})},uf=function(n){var t=Ut(n)?n.dom()[rf]:null;return yn.from(t)},cf=function(n){return function(n){return kn(n,"uid")}(n)?n:x(x({},n),{uid:Oc("uid")})};function af(n){var t=Be("Sketcher for "+n.name,Ns,n),e=O(t.apis,Sc),r=O(t.extraApis,function(n,t){return er(n,t)});return x(x({name:b(t.name),configFields:b(t.configFields),sketch:function(n){return function(n,t,e,r){var o=cf(r);return e(Tc(n,t,o,[],[]),o)}(t.name,t.configFields,t.factory,n)}},e),r)}function ff(n){var t=Be("Sketcher for "+n.name,js,n),e=gc(t.name,t.partFields),r=O(t.apis,Sc),o=O(t.extraApis,function(n,t){return er(n,t)});return x(x({name:b(t.name),partFields:b(t.partFields),configFields:b(t.configFields),sketch:function(n){return kc(t.name,t.configFields,t.partFields,t.factory,n)},parts:b(e)},r),o)}function sf(n){var t=Pt.fromHtml(n),e=Kt(t),r=function(n){var t=n.dom().attributes!==undefined?n.dom().attributes:[];return _(t,function(n,t){var e;return"class"===t.name?n:x(x({},n),((e={})[t.name]=t.value,e))},{})}(t),o=function(n){return Array.prototype.slice.call(n.dom().classList,0)}(t),i=0===e.length?{}:{innerHtml:xo(t)};return x({tag:X(t),classes:o,attributes:r},i)}function lf(n){return{dom:zs(n)}}function df(n){return uo([Oi.config({toggleClass:ki("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Yo(n,function(n,t){(t?Oi.on:Oi.off)(n)})])}function mf(n,t,e,r){var o=df(e);return Ls(t,r,o,n)}function gf(n,t){var e=t.ui.registry.getAll().icons;return yn.from(e[n]).fold(function(){return zs('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return zs('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})}function pf(t){return Ya({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold(function(){return{}},function(r){return{events:Ye([Qe(ft(),function(n,t,e){return r(n,e)},[n]),Qe(dt(),function(n,t,e){return r(n,e)},[n]),Qe(mt(),function(n,t,e){e.mouseIsDown.get()&&r(n,e)},[n])])}})}})}function hf(n,t,e){t.store.manager.onLoad(n,t,e)}function vf(n,t,e){t.store.manager.onUnload(n,t,e)}function yf(){var n=En(null);return io({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function bf(){var i=En({}),u=En({});return io({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return Tn(i.get(),n).orThunk(function(){return Tn(u.get(),n)})},update:function(n){var t=i.get(),e=u.get(),r={},o={};k(n,function(t){r[t.value]=t,Tn(t,"meta").each(function(n){Tn(n,"text").each(function(n){o[n]=t})})}),i.set(x(x({},t),r)),u.set(x(x({},e),o))},clear:function(){i.set({}),u.set({})}})}function xf(n,t,e,r){var o=t.store;e.update([r]),o.setValue(n,r),t.onSetValue(n,r)}function wf(n,t){ul.set(n,t)}function Sf(n){return ul.get(n)}function Of(n){var t=n.event().raw();if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t;return e.touches!==undefined&&1===e.touches.length?yn.some(e.touches[0]).map(function(n){return al(n.clientX,n.clientY)}):yn.none()}var r=t;return r.clientX!==undefined?yn.some(r).map(function(n){return al(n.clientX,n.clientY)}):yn.none()}function Tf(n){return n.model.minX}function kf(n){return n.model.minY}function Ef(n){return n.model.minX-1}function Cf(n){return n.model.minY-1}function _f(n){return n.model.maxX}function Df(n){return n.model.maxY}function Mf(n){return n.model.maxX+1}function If(n){return n.model.maxY+1}function Ff(n,t,e){return t(n)-e(n)}function Rf(n){return Ff(n,_f,Tf)}function Bf(n){return Ff(n,Df,kf)}function Af(n){return Rf(n)/2}function Vf(n){return Bf(n)/2}function Nf(n){return n.stepSize}function jf(n){return n.snapToGrid}function Hf(n){return n.snapStart}function Pf(n){return n.rounded}function zf(n,t){return n[t+"-edge"]!==undefined}function Lf(n){return zf(n,"left")}function Gf(n){return zf(n,"right")}function Uf(n){return zf(n,"top")}function $f(n){return zf(n,"bottom")}function Wf(n){return n.model.value.get()}function Xf(n){return{x:b(n)}}function qf(n){return{y:b(n)}}function Yf(n,t){return{x:b(n),y:b(t)}}function Kf(n,t){G(n,fl(),{value:t})}function Jf(n,t,e,r){return n<t?n:e<n?e:n===t?t-1:Math.max(t,n-r)}function Qf(n,t,e,r){return e<n?n:n<t?t:n===e?e+1:Math.min(e,n+r)}function Zf(n,t,e){return Math.max(t,Math.min(e,n))}function ns(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?t-1:t,p=s?e+1:e;if(o<l)return g;if(d<o)return p;var h=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(o,l,d),v=Zf(h/m*r+t,g,p);return u&&t<=v&&v<=e?function(u,e,c,a,n){return n.fold(function(){var n=u-e,t=Math.round(n/a)*a;return Zf(e+t,e-1,c+1)},function(n){var t=(u-n)%a,e=Math.round(t/a),r=Math.floor((u-n)/a),o=Math.floor((c-n)/a),i=n+Math.min(o,r+e)*a;return Math.max(n,i)})}(v,t,e,i,c):a?Math.round(v):v}function ts(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<t?i?0:f:e<o?u?c:s:(o-t)/r*a}function es(n){return n.element().dom().getBoundingClientRect()}function rs(n,t){return n[t]}function os(n){var t=es(n);return rs(t,sl)}function is(n){var t=es(n);return rs(t,"right")}function us(n){var t=es(n);return rs(t,"top")}function cs(n){var t=es(n);return rs(t,"bottom")}function as(n){var t=es(n);return rs(t,"width")}function fs(n){var t=es(n);return rs(t,"height")}function ss(n,t,e){return(n+t)/2-e}function ls(n,t){var e=es(n),r=es(t),o=rs(e,sl),i=rs(e,"right"),u=rs(r,sl);return ss(o,i,u)}function ds(n,t){var e=es(n),r=es(t),o=rs(e,"top"),i=rs(e,"bottom"),u=rs(r,"top");return ss(o,i,u)}function ms(n,t){G(n,fl(),{value:t})}function gs(n){return{x:b(n)}}function ps(n,t,e){var r={min:Tf(t),max:_f(t),range:Rf(t),value:e,step:Nf(t),snap:jf(t),snapStart:Hf(t),rounded:Pf(t),hasMinEdge:Lf(t),hasMaxEdge:Gf(t),minBound:os(n),maxBound:is(n),screenRange:as(n)};return ns(r)}function hs(e){return function(n,t){return function(n,t,e){var r=(0<n?Qf:Jf)(Wf(e).x(),Tf(e),_f(e),Nf(e));return ms(t,gs(r)),yn.some(r)}(e,n,t).map(function(){return!0})}}function vs(n,t,e,r,o,i){var u=function(t,n,e,r,o){var i=as(t),u=r.bind(function(n){return yn.some(ls(n,t))}).getOr(0),c=o.bind(function(n){return yn.some(ls(n,t))}).getOr(i),a={min:Tf(n),max:_f(n),range:Rf(n),value:e,hasMinEdge:Lf(n),hasMaxEdge:Gf(n),minBound:os(t),minOffset:0,maxBound:is(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return ts(a)}(t,i,e,r,o);return os(t)-os(n)+u}function ys(n,t){G(n,fl(),{value:t})}function bs(n){return{y:b(n)}}function xs(n,t,e){var r={min:kf(t),max:Df(t),range:Bf(t),value:e,step:Nf(t),snap:jf(t),snapStart:Hf(t),rounded:Pf(t),hasMinEdge:Uf(t),hasMaxEdge:$f(t),minBound:us(n),maxBound:cs(n),screenRange:fs(n)};return ns(r)}function ws(e){return function(n,t){return function(n,t,e){var r=(0<n?Qf:Jf)(Wf(e).y(),kf(e),Df(e),Nf(e));return ys(t,bs(r)),yn.some(r)}(e,n,t).map(function(){return!0})}}function Ss(n,t,e,r,o,i){var u=function(t,n,e,r,o){var i=fs(t),u=r.bind(function(n){return yn.some(ds(n,t))}).getOr(0),c=o.bind(function(n){return yn.some(ds(n,t))}).getOr(i),a={min:kf(n),max:Df(n),range:Bf(n),value:e,hasMinEdge:Uf(n),hasMaxEdge:$f(n),minBound:us(t),minOffset:0,maxBound:cs(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return ts(a)}(t,i,e,r,o);return us(t)-us(n)+u}function Os(n,t){G(n,fl(),{value:t})}function Ts(n,t){return{x:b(n),y:b(t)}}function ks(e,r){return function(n,t){return function(n,t,e,r){var o=0<n?Qf:Jf,i=t?Wf(r).x():o(Wf(r).x(),Tf(r),_f(r),Nf(r)),u=t?o(Wf(r).y(),kf(r),Df(r),Nf(r)):Wf(r).y();return Os(e,Ts(i,u)),yn.some(i)}(e,r,n,t).map(function(){return!0})}}function Es(t,e,r,n){return Ls(e,function(){var n=r();t.setContextToolbar([{label:e+" group",items:n}])},{},n)}function Cs(n){return[function(o){function i(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"}return Il.sketch({dom:zs('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Il.parts()["left-edge"](lf('<div class="${prefix}-hue-slider-black"></div>')),Il.parts().spectrum({dom:zs('<div class="${prefix}-slider-gradient-container"></div>'),components:[lf('<div class="${prefix}-slider-gradient"></div>')],behaviours:uo([Oi.config({toggleClass:ki("thumb-active")})])}),Il.parts()["right-edge"](lf('<div class="${prefix}-hue-slider-white"></div>')),Il.parts().thumb({dom:zs('<div class="${prefix}-slider-thumb"></div>'),behaviours:uo([Oi.config({toggleClass:ki("thumb-active")})])})],onChange:function(n,t,e){var r=i(e.x());Mi(t.element(),"background-color",r),o.onChange(n,t,r)},onDragStart:function(n,t){Oi.on(t)},onDragEnd:function(n,t){Oi.off(t)},onInit:function(n,t,e,r){var o=i(r.x());Mi(t.element(),"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:function(){return o.getInitialValue()}}}},sliderBehaviours:uo([Ko(Il.refresh)])})}(n)]}function _s(n){var o=Be("SizeSlider",Fl,n);return Il.sketch({dom:{tag:"div",classes:[ki("slider-"+o.category+"-size-container"),ki("slider"),ki("slider-size-container")]},onChange:function(n,t,e){var r=e.x();!function(n){return 0<=n&&n<o.sizes.length}(r)||o.onChange(r)},onDragStart:function(n,t){Oi.on(t)},onDragEnd:function(n,t){Oi.off(t)},model:{mode:"x",minX:0,maxX:o.sizes.length-1,getInitialValue:function(){return{x:function(){return o.getInitialValue()}}}},stepSize:1,snapToGrid:!0,sliderBehaviours:uo([Ko(Il.refresh)]),components:[Il.parts().spectrum({dom:zs('<div class="${prefix}-slider-size-container"></div>'),components:[lf('<div class="${prefix}-slider-size-line"></div>')]}),Il.parts().thumb({dom:zs('<div class="${prefix}-slider-thumb"></div>'),behaviours:uo([Oi.config({toggleClass:ki("thumb-active")})])})]})}function Ds(t,n){return(Ut(n)?yn.some(n):en(n).filter(Ut)).map(function(n){return function(n,t,e){return go(function(n,t){return t(n)},po,n,t,e)}(n,function(n){return oi(n,"font-size").isSome()},t).bind(function(n){return oi(n,"font-size")}).getOrThunk(function(){return ri(n,"font-size")})}).getOr("")}function Ms(n){var t=n.selection.getStart(),e=Pt.fromDom(t),r=Pt.fromDom(n.getBody()),o=Ds(function(n){return nn(r,n)},e);return D(Rl,function(n){return o===n}).getOr("medium")}function Is(n){return function(t){return M(Rl,function(n){return n===t})}(Ms(n)).getOr(2)}function Fs(t,n){(function(n){return yn.from(Rl[n])})(n).each(function(n){!function(n,t){Ms(n)!==t&&n.execCommand("fontSize",!1,t)}(t,n)})}function Rs(n){return[lf('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),function(n){return _s({onChange:n.onChange,sizes:Bl,category:"font",getInitialValue:n.getInitialValue})}(n),lf('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]}function Bs(n){var t=function e(n){return n.uid!==undefined}(n)&&v(n,"uid")?n.uid:Oc("memento");return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).toOption()},asSpec:function(){return x(x({},n),{uid:t})}}}var As,Vs,Ns=Ee([Ve("name"),Ve("factory"),Ve("configFields"),Ge("apis",{}),Ge("extraApis",{})]),js=Ee([Ve("name"),Ve("factory"),Ve("configFields"),Ve("partFields"),Ge("apis",{}),Ge("extraApis",{})]),Hs=af({name:"Button",factory:function(n){function e(t){return Tn(n.dom,"attributes").bind(function(n){return Tn(n,t)})}var t=function(n){return Ye(I([n.map(function(e){return to(function(n,t){e(n),t.stop()})}).toArray(),Qo()]))}(n.action),r=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:_a(n.buttonBehaviours,[Di.config({}),Ea.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==r)return{role:e("role").getOr("button")};var n=e("type").getOr("button"),t=e("role").map(function(n){return{role:n}}).getOr({});return x({type:n},t)}()},eventOrder:n.eventOrder}},configFields:[Ge("uid",undefined),Ve("dom"),Ge("components",[]),Ca("buttonBehaviours",[Di,Ea]),He("action"),He("role"),Ge("eventOrder",{})]}),Ps=cr({fields:[],name:"unselecting",active:/* */Object.freeze({__proto__:null,events:function(){return Ye([Ke(St(),b(!0))])},exhibit:function(){return rr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),zs=function(n){var t=function(n,r){return n.replace(/\$\{([^{}]*)\}/g,function(n,t){var e=r[t];return function(n){var t=typeof n;return"string"==t||"number"==t}(e)?e.toString():n})}(n,{prefix:Ti});return sf(t)},Ls=function(n,t,e,r){return Hs.sketch({dom:gf(n,r),action:t,buttonBehaviours:ae(uo([Ps.config({})]),e)})},Gs=Ya({schema:[Ve("dom")],name:"label"}),Us=pf("top-left"),$s=pf("top"),Ws=pf("top-right"),Xs=pf("right"),qs=pf("bottom-right"),Ys=pf("bottom"),Ks=pf("bottom-left"),Js=[Gs,pf("left"),Xs,$s,Ys,Us,Ws,Ks,qs,qa({name:"thumb",defaults:b({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Ye([nr(ft(),n,"spectrum"),nr(st(),n,"spectrum"),nr(lt(),n,"spectrum"),nr(dt(),n,"spectrum"),nr(mt(),n,"spectrum"),nr(gt(),n,"spectrum")])}}}),qa({schema:[$e("mouseIsDown",function(){return En(!1)})],name:"spectrum",overrides:function(e){function r(t,n){return o.getValueFromEvent(n).map(function(n){return o.setValueFrom(t,e,n)})}var o=e.model.manager;return{behaviours:uo([Ea.config({mode:"special",onLeft:function(n){return o.onLeft(n,e)},onRight:function(n){return o.onRight(n,e)},onUp:function(n){return o.onUp(n,e)},onDown:function(n){return o.onDown(n,e)}}),Di.config({})]),events:Ye([Je(ft(),r),Je(st(),r),Je(dt(),r),Je(mt(),function(n,t){e.mouseIsDown.get()&&r(n,t)})])}}})],Qs=/* */Object.freeze({__proto__:null,onLoad:hf,onUnload:vf,setValue:function(n,t,e,r){t.store.manager.setValue(n,t,e,r)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),Zs=/* */Object.freeze({__proto__:null,events:function(e,r){var n=e.resetOnDom?[Qr(function(n,t){hf(n,e,r)}),Zr(function(n,t){vf(n,e,r)})]:[or(e,r,hf)];return Ye(n)}}),nl=/* */Object.freeze({__proto__:null,memory:yf,dataset:bf,manual:function(){return io({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),tl=[He("initialValue"),Ve("getFallbackEntry"),Ve("getDataKey"),Ve("setValue"),zo("manager",{setValue:xf,getValue:function(n,t,e){var r=t.store,o=r.getDataKey(n);return e.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(n){return n})},onLoad:function(t,e,r){e.store.initialValue.each(function(n){xf(t,e,r,n)})},onUnload:function(n,t,e){e.clear()},state:bf})],el=[Ve("getValue"),Ge("setValue",w),He("initialValue"),zo("manager",{setValue:function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(t,e,n){e.store.initialValue.each(function(n){e.store.setValue(t,n)})},onUnload:w,state:oo.init})],rl=[He("initialValue"),zo("manager",{setValue:function(n,t,e,r){e.set(r),t.onSetValue(n,r)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each(function(n){e.isNotSet()&&e.set(n)})},onUnload:function(n,t,e){e.clear()},state:yf})],ol=[Ue("store",{mode:"memory"},Ae("mode",{memory:rl,manual:el,dataset:tl})),No("onSetValue"),Ge("resetOnDom",!1)],il=cr({fields:ol,name:"representing",active:Zs,apis:Qs,extra:{setValueFrom:function(n,t){var e=il.getValue(t);il.setValue(n,e)}},state:nl}),ul=Fi("width",function(n){return n.dom().offsetWidth}),cl=function(e,r){return{left:b(e),top:b(r),translate:function(n,t){return cl(e+n,r+t)}}},al=cl,fl=b("slider.change.value"),sl="left",ll=hs(-1),dl=hs(1),ml=yn.none,gl=yn.none,pl={"top-left":yn.none(),top:yn.none(),"top-right":yn.none(),right:yn.some(function(n,t){Kf(n,Xf(Mf(t)))}),"bottom-right":yn.none(),bottom:yn.none(),"bottom-left":yn.none(),left:yn.some(function(n,t){Kf(n,Xf(Ef(t)))})},hl=/* */Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=ps(n,t,e),o=gs(r);return ms(n,o),r},setToMin:function(n,t){var e=Tf(t);ms(n,gs(e))},setToMax:function(n,t){var e=_f(t);ms(n,gs(e))},findValueOfOffset:ps,getValueFromEvent:function(n){return Of(n).map(function(n){return n.left()})},findPositionOfValue:vs,setPositionFromValue:function(n,t,e,r){var o=Wf(e),i=vs(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=Sf(t.element())/2;Mi(t.element(),"left",i-u+"px")},onLeft:ll,onRight:dl,onUp:ml,onDown:gl,edgeActions:pl}),vl=yn.none,yl=yn.none,bl=ws(-1),xl=ws(1),wl={"top-left":yn.none(),top:yn.some(function(n,t){Kf(n,qf(Cf(t)))}),"top-right":yn.none(),right:yn.none(),"bottom-right":yn.none(),bottom:yn.some(function(n,t){Kf(n,qf(If(t)))}),"bottom-left":yn.none(),left:yn.none()},Sl=/* */Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=xs(n,t,e),o=bs(r);return ys(n,o),r},setToMin:function(n,t){var e=kf(t);ys(n,bs(e))},setToMax:function(n,t){var e=Df(t);ys(n,bs(e))},findValueOfOffset:xs,getValueFromEvent:function(n){return Of(n).map(function(n){return n.top()})},findPositionOfValue:Ss,setPositionFromValue:function(n,t,e,r){var o=Wf(e),i=Ss(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),u=Ri(t.element())/2;Mi(t.element(),"top",i-u+"px")},onLeft:vl,onRight:yl,onUp:bl,onDown:xl,edgeActions:wl}),Ol=ks(-1,!1),Tl=ks(1,!1),kl=ks(-1,!0),El=ks(1,!0),Cl={"top-left":yn.some(function(n,t){Kf(n,Yf(Ef(t),Cf(t)))}),top:yn.some(function(n,t){Kf(n,Yf(Af(t),Cf(t)))}),"top-right":yn.some(function(n,t){Kf(n,Yf(Mf(t),Cf(t)))}),right:yn.some(function(n,t){Kf(n,Yf(Mf(t),Vf(t)))}),"bottom-right":yn.some(function(n,t){Kf(n,Yf(Mf(t),If(t)))}),bottom:yn.some(function(n,t){Kf(n,Yf(Af(t),If(t)))}),"bottom-left":yn.some(function(n,t){Kf(n,Yf(Ef(t),If(t)))}),left:yn.some(function(n,t){Kf(n,Yf(Ef(t),Vf(t)))})},_l=/* */Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=ps(n,t,e.left()),o=xs(n,t,e.top()),i=Ts(r,o);return Os(n,i),i},setToMin:function(n,t){var e=Tf(t),r=kf(t);Os(n,Ts(e,r))},setToMax:function(n,t){var e=_f(t),r=Df(t);Os(n,Ts(e,r))},getValueFromEvent:function(n){return Of(n)},setPositionFromValue:function(n,t,e,r){var o=Wf(e),i=vs(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=Ss(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),c=Sf(t.element())/2,a=Ri(t.element())/2;Mi(t.element(),"left",i-c+"px"),Mi(t.element(),"top",u-a+"px")},onLeft:Ol,onRight:Tl,onUp:kl,onDown:El,edgeActions:Cl}),Dl=[Ge("stepSize",1),Ge("onChange",w),Ge("onChoose",w),Ge("onInit",w),Ge("onDragStart",w),Ge("onDragEnd",w),Ge("snapToGrid",!1),Ge("rounded",!0),He("snapStart"),Ne("model",Ae("mode",{x:[Ge("minX",0),Ge("maxX",100),$e("value",function(n){return En(n.mode.minX)}),Ve("getInitialValue"),zo("manager",hl)],y:[Ge("minY",0),Ge("maxY",100),$e("value",function(n){return En(n.mode.minY)}),Ve("getInitialValue"),zo("manager",Sl)],xy:[Ge("minX",0),Ge("maxX",100),Ge("minY",0),Ge("maxY",100),$e("value",function(n){return En({x:b(n.mode.minX),y:b(n.mode.minY)})}),Ve("getInitialValue"),zo("manager",_l)]})),oc("sliderBehaviours",[Ea,il]),$e("mouseIsDown",function(){return En(!1)})],Ml=b("mouse.released"),Il=ff({name:"Slider",configFields:Dl,partFields:Js,factory:function(i,n,t,e){function u(n){return yc(n,i,"thumb")}function c(n){return yc(n,i,"spectrum")}function r(n){return vc(n,i,"left-edge")}function o(n){return vc(n,i,"right-edge")}function a(n){return vc(n,i,"top-edge")}function f(n){return vc(n,i,"bottom-edge")}function s(n,t){v.setPositionFromValue(n,t,i,{getLeftEdge:r,getRightEdge:o,getTopEdge:a,getBottomEdge:f,getSpectrum:c})}function l(n,t){h.value.set(t);var e=u(n);return s(n,e),i.onChange(n,e,t),yn.some(!0)}function d(e){var n=i.mouseIsDown.get();i.mouseIsDown.set(!1),n&&vc(e,i,"thumb").each(function(n){var t=h.value.get();i.onChoose(e,n,t)})}function m(n,t){t.stop(),i.mouseIsDown.set(!0),i.onDragStart(n,u(n))}function g(n,t){t.stop(),i.onDragEnd(n,u(n)),d(n)}var p,h=i.model,v=h.manager;return{uid:i.uid,dom:i.dom,components:n,behaviours:uc(i.sliderBehaviours,[Ea.config({mode:"special",focusIn:function(n){return vc(n,i,"spectrum").map(Ea.focusIn).map(b(!0))}}),il.config({store:{mode:"manual",getValue:function(n){return h.value.get()}}}),vi.config({channels:(p={},p[Ml()]={onReceive:d},p)})]),events:Ye([Je(fl(),function(n,t){l(n,t.event().value())}),Qr(function(n,t){var e=h.getInitialValue();h.value.set(e);var r=u(n);s(n,r);var o=c(n);i.onInit(n,r,o,h.value.get())}),Je(ft(),m),Je(lt(),g),Je(dt(),m),Je(gt(),g)]),apis:{resetToMin:function(n){v.setToMin(n,i)},resetToMax:function(n){v.setToMax(n,i)},changeValue:l,refresh:s},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),Fl=Ee([Ve("getInitialValue"),Ve("onChange"),Ve("category"),Ve("sizes")]),Rl=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],Bl=b(Rl)(),Al=window.Promise?window.Promise:(As=Vl.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(n){g.setTimeout(n,1)},Vs=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Vl.prototype["catch"]=function(n){return this.then(null,n)},Vl.prototype.then=function(e,r){var o=this;return new Vl(function(n,t){jl.call(o,new Ll(e,r,n,t))})},Vl.all=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var a=Array.prototype.slice.call(1===n.length&&Vs(n[0])?n[0]:n);return new Vl(function(o,i){if(0===a.length)return o([]);var u=a.length;function c(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void e.call(n,function(n){c(t,n)},i)}a[t]=n,0==--u&&o(a)}catch(r){i(r)}}for(var n=0;n<a.length;n++)c(n,a[n])})},Vl.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Vl?t:new Vl(function(n){n(t)})},Vl.reject=function(e){return new Vl(function(n,t){t(e)})},Vl.race=function(o){return new Vl(function(n,t){for(var e=0,r=o;e<r.length;e++)r[e].then(n,t)})},Vl);function Vl(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Gl(n,Nl(Hl,this),Nl(Pl,this))}function Nl(n,t){return function(){return n.apply(t,arguments)}}function jl(r){var o=this;null!==this._state?As(function(){var n=o._state?r.onFulfilled:r.onRejected;if(null!==n){var t;try{t=n(o._value)}catch(e){return void r.reject(e)}r.resolve(t)}else(o._state?r.resolve:r.reject)(o._value)}):this._deferreds.push(r)}function Hl(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void Gl(Nl(t,n),Nl(Hl,this),Nl(Pl,this))}this._state=!0,this._value=n,zl.call(this)}catch(e){Pl.call(this,e)}}function Pl(n){this._state=!1,this._value=n,zl.call(this)}function zl(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];jl.call(this,e)}this._deferreds=[]}function Ll(n,t,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r}function Gl(n,t,e){var r=!1;try{n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,e(n))})}catch(o){if(r)return;r=!0,e(o)}}function Ul(n){return function t(e){return new Al(function(n){var t=new g.FileReader;t.onloadend=function(){n(t.result)},t.readAsDataURL(e)})}(n).then(function(n){return n.split(",")[1]})}function $l(o,i){(function(n){return Ul(n)})(i).then(function(r){o.undoManager.transact(function(){var n=o.editorUpload.blobCache,t=n.create(sc("mceu"),i,r);n.add(t);var e=o.dom.createHTML("img",{src:t.blobUri()});o.insertContent(e)})})}function Wl(e){var t=Bs({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Ye([tr(xt()),Je(bt(),function(n,t){(function(n){var t=n.event(),e=t.raw().target.files||t.raw().dataTransfer.files;return yn.from(e[0])})(t).each(function(n){$l(e,n)})})])});return Hs.sketch({dom:gf("image",e),components:[t.asSpec()],action:function(n){t.get(n).element().dom().click()}})}function Xl(n){return n.dom().textContent}function ql(n){return 0<n.length}function Yl(n){return n===undefined||null===n?"":n}function Kl(n){return am(n).fold(function(){return function(n){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:yn.none()}}(n)},function(n){return function(n){var t=Xl(n),e=lr(n,"href"),r=lr(n,"title"),o=lr(n,"target");return{url:Yl(e),text:t!==e?Yl(t):"",title:Yl(r),target:Yl(o),link:yn.some(n)}}(n)})}function Jl(n,t,e){return e.text.toOption().filter(ql).fold(function(){return function(n){return lr(n,"href")===Xl(n)}(n)?yn.some(t):yn.none()},yn.some)}function Ql(t,o){o.url.toOption().filter(ql).fold(function(){!function(t,n){n.link.bind(y).each(function(n){t.execCommand("unlink")})}(t,o)},function(e){var r=function(n,t){var e={};return e.href=n,t.title.toOption().filter(ql).each(function(n){e.title=n}),t.target.toOption().filter(ql).each(function(n){e.target=n}),e}(e,o);o.link.bind(y).fold(function(){var n=o.text.toOption().filter(ql).getOr(e);t.insertContent(t.dom.createHTML("a",r,t.dom.encode(n)))},function(t){var n=Jl(t,e,o);sr(t,r),n.each(function(n){!function(n,t){n.dom().textContent=t}(t,n)})})})}function Zl(n,t){var e=t.selection.getRng();n(),t.selection.setRng(e)}function nd(n){return n.dom().value}function td(n,t){if(t===undefined)throw new Error("Value.set was undefined");n.dom().value=t}function ed(n){return x(x({},function(n){return uo([Di.config({onFocus:n.selectOnFocus?function(n){var t=n.element(),e=nd(t);t.dom().setSelectionRange(0,e.length)}:w})])}(n)),uc(n.inputBehaviours,[il.config({store:x(x({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return nd(n.element())},setValue:function(n,t){nd(n.element())!==t&&td(n.element(),t)}}),onSetValue:n.onSetValue})]))}function rd(n,t){var e=Bs(vm.sketch({inputAttributes:{placeholder:wm.translate(t)},onSetValue:function(n,t){L(n,yt())},inputBehaviours:uo([mm.config({find:yn.some}),xm.config({}),Ea.config({mode:"execution"})]),selectOnFocus:!1})),r=Bs(Hs.sketch({dom:zs('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var t=e.get(n);il.setValue(t,"")}}));return{name:n,spec:gm.sketch({dom:zs('<div class="${prefix}-input-container"></div>'),components:[e.asSpec(),r.asSpec()],containerBehaviours:uo([Oi.config({toggleClass:ki("input-container-empty")}),mm.config({find:function(n){return yn.some(e.get(n))}}),sm("input-clearing",[Je(yt(),function(n){var t=e.get(n);(0<il.getValue(t).length?Oi.off:Oi.on)(n)})])])})}}function od(n,t,e){t.disabled&&Om(n,t)}function id(n,t){return!0===t.useNative&&T(Sm,X(n.element()))}function ud(n){fr(n.element(),"disabled","disabled")}function cd(n){mr(n.element(),"disabled")}function ad(n){fr(n.element(),"aria-disabled","true")}function fd(n){fr(n.element(),"aria-disabled","false")}function sd(t,n,e){n.disableClass.each(function(n){xr(t.element(),n)}),(id(t,n)?cd:fd)(t),n.onEnabled(t)}function ld(n,t){return id(n,t)?function(n){return dr(n.element(),"disabled")}(n):function(n){return"true"===lr(n.element(),"aria-disabled")}(n)}function dd(n){return"<alloy.field."+n+">"}function md(){function t(){e.get().each(function(n){n.destroy()})}var e=En(yn.none());return{clear:function(){t(),e.set(yn.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(yn.some(n))},run:function(n){e.get().each(n)}}}function gd(){var t=En(yn.none());return{clear:function(){t.set(yn.none())},set:function(n){t.set(yn.some(n))},isSet:function(){return t.get().isSome()},on:function(n){t.get().each(n)}}}function pd(n){function r(t,n,e){return Hs.sketch({dom:zs('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){G(n,u,{direction:t})},buttonBehaviours:uo([Cm.config({disableClass:ki("toolbar-navigation-disabled"),disabled:!e})])})}function o(n,o){var i=Vi(n.element(),"."+ki("serialised-dialog-screen"));Hi(n.element(),"."+ki("serialised-dialog-chain")).each(function(r){0<=c.state.currentScreen.get()+o&&c.state.currentScreen.get()+o<i.length&&(oi(r,"left").each(function(n){var t=parseInt(n,10),e=Sf(i[0]);Mi(r,"left",t-o*e+"px")}),c.state.currentScreen.set(c.state.currentScreen.get()+o))})}function i(t){var n=Vi(t.element(),"input");yn.from(n[c.state.currentScreen.get()]).each(function(n){t.getSystem().getByDom(n).each(function(n){!function(n,t){n.getSystem().triggerFocus(t,n.element())}(t,n.element())})});var e=f.get(t);pu.highlightAt(e,c.state.currentScreen.get())}var u="navigateEvent",t=Gr([Ve("fields"),Ge("maxFieldIndex",n.fields.length-1),Ve("onExecute"),Ve("getInitialValue"),$e("state",function(){return{dialogSwipeState:gd(),currentScreen:En(0)}})]),c=Be("SerialisedDialog",t,n),a=Bs(Mm(function(e){return{dom:zs('<div class="${prefix}-serialised-dialog"></div>'),components:[gm.sketch({dom:zs('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:nt(c.fields,function(n,t){return t<=c.maxFieldIndex?gm.sketch({dom:zs('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[r(-1,"previous",0<t),e.field(n.name,n.spec),r(1,"next",t<c.maxFieldIndex)]}):e.field(n.name,n.spec)})})],formBehaviours:uo([Ko(function(n,t){!function(n,t){Hi(n.element(),"."+ki("serialised-dialog-chain")).each(function(n){Mi(n,"left",-c.state.currentScreen.get()*t.width+"px")})}(n,t)}),Ea.config({mode:"special",focusIn:function(n){i(n)},onTab:function(n){return o(n,1),yn.some(!0)},onShiftTab:function(n){return o(n,-1),yn.some(!0)}}),sm("form-events",[Qr(function(t,n){c.state.currentScreen.set(0),c.state.dialogSwipeState.clear();var e=f.get(t);pu.highlightFirst(e),c.getInitialValue(t).each(function(n){il.setValue(t,n)})}),to(c.onExecute),Je(wt(),function(n,t){"left"===t.event().raw().propertyName&&i(n)}),Je(u,function(n,t){var e=t.event().direction();o(n,e)})])])}})),f=Bs({dom:zs('<div class="${prefix}-dot-container"></div>'),behaviours:uo([pu.config({highlightClass:ki("dot-active"),itemClass:ki("dot-item")})]),components:F(c.fields,function(n,t){return t<=c.maxFieldIndex?[lf('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:zs('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),f.asSpec()],behaviours:uo([Ea.config({mode:"special",focusIn:function(n){var t=a.get(n);Ea.focusIn(t)}}),sm("serializer-wrapper-events",[Je(ft(),function(n,t){var e=t.event();c.state.dialogSwipeState.set(function(n){return{xValue:n,points:[]}}(e.raw().touches[0].clientX))}),Je(st(),function(n,t){var e=t.event();c.state.dialogSwipeState.on(function(n){t.event().prevent(),c.state.dialogSwipeState.set(function(n,t){if(t===n.xValue)return n;var e=0<t-n.xValue?1:-1,r={direction:e,xValue:t};return{xValue:t,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===e?n.points.slice(0,n.points.length-1):n.points).concat([r])}}(n,e.raw().touches[0].clientX))})}),Je(lt(),function(r){c.state.dialogSwipeState.on(function(n){var t=a.get(r),e=-1*function(n){if(0===n.points.length)return 0;var t=n.points[0].direction,e=n.points[n.points.length-1].direction;return-1===t&&-1===e?-1:1===t&&1===e?1:0}(n);o(t,e)})})])])}}function hd(t,e){return mf(e,"link","link",function(){var n=Im(t,e);t.setContextToolbar(n),function(n,t){(fm.os.isAndroid()?Zl:r)(t,n)}(e,function(){t.focusToolbar()}),am(e).each(function(n){e.selection.select(n.dom())})})}function vd(t){function n(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+To(t().element())+" is not in context.":""))}}return{debugInfo:b("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:b(!1)}}function yd(n,o){var i={};return wn(n,function(n,r){wn(n,function(n,t){var e=Tn(i,t).getOr([]);i[t]=e.concat([o(r,n)])})}),i}function bd(u,c,n,a){try{var t=function(n,t){var e=Jn.call(n,0);return e.sort(t),e}(n,function(n,t){var e=n[c](),r=t[c](),o=a.indexOf(e),i=a.indexOf(r);if(-1===o)throw new Error("The ordering for "+u+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(a,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(a,null,2));return o<i?-1:i<o?1:0});return ie.value(t)}catch(e){return ie.error([e])}}function xd(n){return n.cHandler}function wd(n,t){return{name:b(n),handler:b(t)}}function Sd(n,t,e){var r=x(x({},e),function(n,t){var e={};return k(n,function(n){e[n.name()]=n.handlers(t)}),e}(t,n));return yd(r,wd)}function Od(n){var i=function(n){return Yn(n)?{can:b(!0),abort:b(!1),run:n}:n}(n);return function(n,t){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var o=[n,t].concat(e);i.abort.apply(undefined,o)?t.stop():i.can.apply(undefined,o)&&i.run.apply(undefined,o)}}function Td(n,t,e){var r=t[e];return r?bd("Event: "+e,"name",n,r).map(function(n){var t=nt(n,function(n){return n.handler()});return qe(t)}):function(n,t){return ie.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(nt(t,function(n){return n.name()}),null,2)])}(e,n)}function kd(n){return Fe("custom.definition",Gr([Wr("dom","dom",Vr(),Gr([Ve("tag"),Ge("styles",{}),Ge("classes",[]),Ge("attributes",{}),He("value"),He("innerHtml")])),Ve("components"),Ve("uid"),Ge("events",{}),Ge("apis",{}),Wr("eventOrder","eventOrder",function(n){return Ar.mergeWithThunk(b(n))}({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),Yr()),He("domModification")]),n)}function Ed(t,n){k(n,function(n){yr(t,n)})}function Cd(t,n){k(n,function(n){xr(t,n)})}function _d(n,t){return function(t,n){var e=nt(n,function(n){return ze(n.name(),[Ve("config"),Ge("state",oo)])}),r=Fe("component.behaviours",Gr(e),t.behaviours).fold(function(n){throw new Error(qr(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(n){return n});return{list:n,data:O(r,function(n){var t=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return t}})}}(n,t)}function Dd(n){var t=function(n){var t=Tn(n,"behaviours").getOr({}),e=E(bn(t),function(n){return t[n]!==undefined});return nt(e,function(n){return t[n].me})}(n);return _d(n,t)}function Md(n,t,e){var r=function(n){return x(x({},n.dom),{uid:n.uid,domChildren:nt(n.components,function(n){return n.element()})})}(n),o=function(n){return n.domModification.fold(function(){return rr({})},rr)}(n),i={"alloy.base.modification":o};return function(n,t){return x(x({},n),{attributes:x(x({},n.attributes),t.attributes),styles:x(x({},n.styles),t.styles),classes:n.classes.concat(t.classes)})}(r,0<t.length?function(t,n,e,r){var o=x({},n);k(e,function(n){o[n.name()]=n.exhibit(t,r)});function i(n){return C(n,function(n,t){return x(x({},t.modification),n)},{})}var u=yd(o,function(n,t){return{name:n,modification:t}}),c=C(u.classes,function(n,t){return t.modification.concat(n)},[]),a=i(u.attributes),f=i(u.styles);return rr({classes:c,attributes:a,styles:f})}(e,i,t,r):o)}function Id(n,t,e){var r={"alloy.base.behaviour":function(n){return n.events}(n)};return function(n,t,e,r){var o=Sd(n,e,r);return jm(o,t)}(e,n.eventOrder,t,r).getOrDie()}function Fd(e){function n(){return s}var r=En(Vm),t=Re(kd(e)),o=Dd(e),i=function(n){return n.list}(o),u=function(n){return n.data}(o),c=function(n){var t=Pt.fromTag(n.tag);sr(t,n.attributes),Ed(t,n.classes),ei(t,n.styles),n.innerHtml.each(function(n){return wo(t,n)});var e=n.domChildren;return an(t,e),n.value.each(function(n){td(t,n)}),n.uid,of(t,n.uid),t}(Md(t,i,u)),a=Id(t,i,u),f=En(t.components),s={getSystem:r.get,config:function(n){var t=u;return(Yn(t[n.name()])?t[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(n){return Yn(u[n.name()])},spec:b(e),readState:function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return t.apis},connect:function(n){r.set(n)},disconnect:function(){r.set(vd(n))},element:b(c),syncComponents:function(){var n=Kt(c),t=F(n,function(n){return r.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});f.set(t)},components:f.get,events:b(a)};return s}function Rd(n){var t=Am(n),e=t.events,r=u(t,["events"]),o=function(n){var t=Tn(n,"components").getOr([]);return nt(t,zm)}(r),i=x(x({},r),{events:x(x({},Bm),e),components:o});return ie.value(Fd(i))}function Bd(n){var t=Pt.fromText(n);return Hm({element:t})}function Ad(n){(bo(n.element()).isNone()||Di.isFocused(n))&&(Di.isFocused(n)||Di.focus(n),G(n,Gm,{item:n}))}function Vd(n){G(n,Um,{item:n})}function Nd(n,e){var r=tn(e),t=yo(r).bind(function(t){function n(n){return nn(t,n)}return n(e)?yn.some(e):function(n,o){var i=function(n){for(var t=0;t<n.childNodes.length;t++){var e=Pt.fromDom(n.childNodes[t]);if(o(e))return yn.some(e);var r=i(n.childNodes[t]);if(r.isSome())return r}return yn.none()};return i(n.dom())}(e,n)}),o=n(e);return t.each(function(t){yo(r).filter(function(n){return nn(n,t)}).fold(function(){ho(t)},w)}),o}function jd(n,t,e,r){var o=n.getSystem().build(r);te(n,o,e)}function Hd(n,t,e,r){var o=eg(n);D(o,function(n){return nn(r.element(),n.element())}).each(dn)}function Pd(t,n,e,r,o){var i=eg(t);return yn.from(i[r]).map(function(n){return Hd(t,0,0,n),o.each(function(n){jd(t,0,function(n,t){!function(n,t,e){rn(n,e).fold(function(){Jt(n,t)},function(n){on(n,t)})}(n,t,r)},n)}),n})}function zd(n,t){var e={};wn(n,function(n,t){k(n,function(n){e[n]=t})});var r=t,o=function(n){return Sn(n,function(n,t){return{k:n,v:t}})}(t),i=O(o,function(n,t){return[t].concat(og(e,r,o,t))});return O(e,function(n){return Tn(i,n).getOr([n])})}function Ld(n,t,e,r){return Tn(t.routes,r.start).bind(function(n){return Tn(n,r.destination)})}function Gd(e,r,n){(function(t,e,r){return sg(t,e).bind(function(n){return fg(t,e,r,n)})})(e,r,n).each(function(n){var t=n.transition;xr(e.element(),t.transitionClass),mr(e.element(),r.destinationAttr)})}function Ud(n,t,e,r){Gd(n,t,e),dr(n.element(),t.stateAttr)&&lr(n.element(),t.stateAttr)!==r&&t.onFinish(n,r),fr(n.element(),t.stateAttr,r)}function $d(n){xr(n,pg)}function Wd(n){return Tn(n,"format").getOr(n.title)}function Xd(r){var n=function(r,o){var n=bg("Styles",[].concat(nt(r.items,function(n){return yg(Wd(n),n.title,n.isSelected(),n.getPreview(),v(r.expansions,Wd(n)))})),o,!1),t=O(r.menus,function(n,t){var e=nt(n,function(n){return yg(Wd(n),n.title,n.isSelected!==undefined&&n.isSelected(),n.getPreview!==undefined?n.getPreview():"",v(r.expansions,Wd(n)))});return bg(t,e,o,!0)}),e=ae(t,he("styles",n));return{tmenu:ag.tieredData("styles",e,r.expansions)}}(r.formats,function(){return t}),t=Bs(ag.sketch({dom:{tag:"div",classes:[ki("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(n,t){var e=il.getValue(t);return r.handle(t,e.value),yn.none()},onEscape:function(){return yn.none()},onOpenMenu:function(n,t){var e=Sf(n.element());wf(t.element(),e),gg.jumpTo(t,"current")},onOpenSubmenu:function(n,t,e){var r=Sf(n.element()),o=ji(t.element(),'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();wf(e.element(),r),gg.progressTo(i,"before"),gg.jumpTo(e,"after"),gg.progressTo(e,"current")},onCollapseMenu:function(n,t,e){var r=ji(t.element(),'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();gg.progressTo(o,"after"),gg.progressTo(e,"current")},navigateOnHover:!1,highlightImmediately:!0,data:n.tmenu,markers:{backgroundMenu:ki("styles-background-menu"),menu:ki("styles-menu"),selectedMenu:ki("styles-selected-menu"),item:ki("styles-item"),selectedItem:ki("styles-selected-item")}}));return t.asSpec()}function qd(n){return v(n,"items")?function(n){var t=ae(pe(n,["items"]),{menu:!0}),e=xg(n.items);return{item:t,menus:ae(e.menus,he(n.title,e.items)),expansions:ae(e.expansions,he(n.title,n.title))}}(n):{item:n,menus:{},expansions:{}}}function Yd(r,n){function o(n){return function(){return r.formatter.match(n)}}function i(n){return function(){return r.formatter.getCssText(n)}}var t=Tn(n,"style_formats").getOr(Fm),e=function(n){return nt(n,function(n){if(v(n,"items")){var t=e(n.items);return ae(function(n){return ae(n,{isSelected:b(!1),getPreview:b("")})}(n),{items:t})}return v(n,"format")?function(n){return ae(n,{isSelected:o(n.format),getPreview:i(n.format)})}(n):function(n){var t=sc(n.title),e=ae(n,{format:t,isSelected:o(t),getPreview:i(t)});return r.formatter.register(t,e),e}(n)})};return e(t)}function Kd(e,n,r){var t=function(t,n){var e=function(n){return F(n,function(n){return n.items===undefined?!v(n,"format")||t.formatter.canApply(n.format)?[n]:[]:0<e(n.items).length?[n]:[]})},r=e(n);return xg(r)}(e,n);return Xd({formats:t,handle:function(n,t){e.undoManager.transact(function(){Oi.isOn(n)?e.formatter.remove(t):e.formatter.apply(t)}),r()}})}function Jd(n){var t=n.replace(/\|/g," ").trim();return 0<t.length?t.split(/\s+/):[]}function Qd(t,r){function n(n){return function(){return function(n,t){return Ls(t,function(){n.execCommand(t)},{},n)}(r,n)}}function e(n){return function(){return function(n,t){var e=df(t);return Ls(t,function(){n.execCommand(t)},e,n)}(r,n)}}function o(n,t,e){return function(){return mf(r,n,t,e)}}function i(){return Kd(r,h,function(){r.fire("scrollIntoView")})}function u(n,t){return{isSupported:function(){var t=r.ui.registry.getAll().buttons;return n.forall(function(n){return v(t,n)})},sketch:t}}var c=n("undo"),a=n("redo"),f=e("bold"),s=e("italic"),l=e("underline"),d=n("removeformat"),m=o("unlink","link",function(){r.execCommand("unlink",null,!1)}),g=o("unordered-list","ul",function(){r.execCommand("InsertUnorderedList",null,!1)}),p=o("ordered-list","ol",function(){r.execCommand("InsertOrderedList",null,!1)}),h=Yd(r,r.settings);return{undo:u(yn.none(),c),redo:u(yn.none(),a),bold:u(yn.none(),f),italic:u(yn.none(),s),underline:u(yn.none(),l),removeformat:u(yn.none(),d),link:u(yn.none(),function(){return hd(t,r)}),unlink:u(yn.none(),m),image:u(yn.none(),function(){return Wl(r)}),bullist:u(yn.some("bullist"),g),numlist:u(yn.some("numlist"),p),fontsizeselect:u(yn.none(),function(){return function(n,t){var e={onChange:function(n){Fs(t,n)},getInitialValue:function(){return Is(t)}};return Es(n,"font-size",function(){return Rs(e)},t)}(t,r)}),forecolor:u(yn.none(),function(){return function(n,r){var t={onChange:function(n,t,e){r.undoManager.transact(function(){r.formatter.apply("forecolor",{value:e}),r.nodeChanged()})},getInitialValue:function(){return-1}};return Es(n,"color-levels",function(){return Cs(t)},r)}(t,r)}),styleselect:u(yn.none(),function(){return Ls("style-formats",function(n){r.fire("toReading"),t.dropup().appear(i,Oi.on,n)},uo([Oi.config({toggleClass:ki("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),vi.config({channels:ve([Jo(Mo,Oi.off),Jo(Io,Oi.off)])})]),r)})}}function Zd(n,e){var t=function(n){var t=n.toolbar!==undefined?n.toolbar:wg;return Xn(t)?Sg(t):Jd(t)}(n),r={};return F(t,function(n){var t=!v(r,n)&&v(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return r[n]=!0,t})}function nm(n){function t(){n.stopPropagation()}function e(){n.preventDefault()}var r=Pt.fromDom(n.target),o=i(e,t);return function(n,t,e,r,o,i,u){return{target:b(n),x:b(t),y:b(e),stop:r,prevent:o,kill:i,raw:b(u)}}(r,n.clientX,n.clientY,t,e,o,n)}function tm(n,t,e,r,o){var i=function(t,e){return function(n){t(n)&&e(nm(n))}}(e,r);return n.dom().addEventListener(t,i,o),{unbind:S(Og,n,t,i,o)}}function em(n,t,e){return function(n,t,e,r){return tm(n,t,e,r,!1)}(n,t,Tg,e)}function rm(n,t,e){return function(n,t,e,r){return tm(n,t,e,r,!0)}(n,t,Tg,e)}function om(n){var t=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:b(t)}}function im(r,t){var n=Pt.fromDom(r),o=null,e=em(n,"orientationchange",function(){kg.clearInterval(o);var n=om(r);t.onChange(n),i(function(){t.onReady(n)})}),i=function(n){kg.clearInterval(o);var t=r.innerHeight,e=0;o=kg.setInterval(function(){t!==r.innerHeight?(kg.clearInterval(o),n(yn.some(r.innerHeight))):20<e&&(kg.clearInterval(o),n(yn.none())),e++},50)};return{onAdjustment:i,destroy:function(){e.unbind()}}}var um,cm,am=function(n){var t=Pt.fromDom(n.selection.getStart());return Pi(t,"a")},fm=z(),sm=function(n,t){return{key:n,value:{config:{},me:function(n,t){var e=Ye(t);return cr({fields:[Ve("enabled")],name:n,active:{events:b(e)}})}(n,t),configAsRaw:b({}),initialConfig:{},state:oo}}},lm=/* */Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),dm=[Ve("find")],mm=cr({fields:dm,name:"composing",apis:lm}),gm=af({name:"Container",factory:function(n){var t=n.dom,e=t.attributes,r=u(t,["attributes"]);return{uid:n.uid,dom:x({tag:"div",attributes:x({role:"presentation"},e)},r),components:n.components,behaviours:ic(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[Ge("components",[]),oc("containerBehaviours",[]),Ge("events",{}),Ge("domModification",{}),Ge("eventOrder",{})]}),pm=af({name:"DataField",factory:function(e){return{uid:e.uid,dom:e.dom,behaviours:_a(e.dataBehaviours,[il.config({store:{mode:"memory",initialValue:e.getInitialValue()}}),mm.config({find:yn.some})]),events:Ye([Qr(function(n,t){il.setValue(n,e.getInitialValue())})])}},configFields:[Ve("uid"),Ve("dom"),Ve("getInitialValue"),Ca("dataBehaviours",[il,mm])]}),hm=b([He("data"),Ge("inputAttributes",{}),Ge("inputStyles",{}),Ge("tag","input"),Ge("inputClasses",[]),No("onSetValue"),Ge("styles",{}),Ge("eventOrder",{}),oc("inputBehaviours",[il,Di]),Ge("selectOnFocus",!0)]),vm=af({name:"Input",configFields:hm(),factory:function(n,t){return{uid:n.uid,dom:function(n){return{tag:n.tag,attributes:x({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}}(n),components:[],behaviours:ed(n),eventOrder:n.eventOrder}}}),ym=/* */Object.freeze({__proto__:null,exhibit:function(n,t){return rr({attributes:ve([{key:t.tabAttr,value:"true"}])})}}),bm=[Ge("tabAttr","data-alloy-tabstop")],xm=cr({fields:bm,name:"tabstopping",active:ym}),wm=tinymce.util.Tools.resolve("tinymce.util.I18n"),Sm=["input","button","textarea","select"],Om=function(t,n,e){n.disableClass.each(function(n){yr(t.element(),n)}),(id(t,n)?ud:ad)(t),n.onDisabled(t)},Tm=/* */Object.freeze({__proto__:null,enable:sd,disable:Om,isDisabled:ld,onLoad:od,set:function(n,t,e,r){(r?Om:sd)(n,t,e)}}),km=/* */Object.freeze({__proto__:null,exhibit:function(n,t){return rr({classes:t.disabled?t.disableClass.map(V).getOr([]):[]})},events:function(e,n){return Ye([Ke(_t(),function(n,t){return ld(n,e)}),or(e,n,od)])}}),Em=[Ge("disabled",!1),Ge("useNative",!0),He("disableClass"),No("onDisabled"),No("onEnabled")],Cm=cr({fields:Em,name:"disabling",active:km,apis:Tm}),_m=[oc("formBehaviours",[il])],Dm=function(r,n){return{uid:r.uid,dom:r.dom,components:n,behaviours:uc(r.formBehaviours,[il.config({store:{mode:"manual",getValue:function(n){var t=function(n,t){var e=n.getSystem();return O(t.partUids,function(n,t){return b(e.getByUid(n))})}(n,r);return O(t,function(n,t){return n().bind(function(n){return function(n,t){return n.fold(function(){return ie.error(t)},ie.value)}(mm.getCurrent(n),new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+To(n.element())))}).map(il.getValue)})},setValue:function(e,n){wn(n,function(t,n){vc(e,r,n).each(function(n){mm.getCurrent(n).each(function(n){il.setValue(n,t)})})})}}})]),apis:{getField:function(n,t){return vc(n,r,t).bind(mm.getCurrent)}}}},Mm=(Sc(function(n,t,e){return n.getField(t,e)}),function(n){var e,t=(e=[],{field:function(n,t){return e.push(n),function(n,t,e){return{uiType:Ba(),owner:n,name:t,config:e,validated:{}}}("form",dd(n),t)},record:function(){return e}}),r=n(t),o=t.record(),i=nt(o,function(n){return qa({name:n,pname:dd(n)})});return kc("form",_m,i,Dm,r)}),Im=W(function(e,r){return[{label:"the link group",items:[pd({fields:[rd("url","Type or paste URL"),rd("text","Link text"),rd("title","Link title"),rd("target","Link target"),function(n){return{name:n,spec:pm.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return yn.none()}})}}("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return yn.some(Kl(r))},onExecute:function(n){var t=il.getValue(n);Ql(r,t),e.restoreToolbar(),r.focus()}})]}]}),Fm=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Rm=Ye([(um=Tt(),cm=function(n,t){var e=t.event().originator(),r=t.event().target();return!function(n,t,e){return nn(t,n.element())&&!nn(t,e)}(n,e,r)||(g.console.warn(Tt()+" did not get interpreted by the desired target. \nOriginator: "+To(e)+"\nTarget: "+To(r)+"\nCheck the "+Tt()+" event handlers"),!1)},{key:um,value:Xe({can:cm})})]),Bm=/* */Object.freeze({__proto__:null,events:Rm}),Am=y,Vm=vd(),Nm=function(n,t){return function(n,t){return{cHandler:n,purpose:b(t)}}(S.apply(undefined,[n.handler].concat(t)),n.purpose())},jm=function(n,i){var t=On(n,function(r,o){return(1===r.length?ie.value(r[0].handler()):Td(r,i,o)).map(function(n){var t=Od(n),e=1<r.length?E(i[o],function(t){return h(r,function(n){return n.name()===t})}).join(" > "):r[0].name();return he(o,function(n,t){return{handler:n,purpose:b(t)}}(t,e))})});return ye(t,{})},Hm=function(n){var t=Be("external.component",Ee([Ve("element"),He("uid")]),n),e=En(vd());t.uid.each(function(n){of(t.element,n)});var r={getSystem:e.get,config:yn.none,hasConfigured:b(!1),connect:function(n){e.set(n)},disconnect:function(){e.set(vd(function(){return r}))},getApis:function(){return{}},element:b(t.element),spec:b(n),readState:b("No state"),syncComponents:w,components:b([]),events:b({})};return wc(r)},Pm=Oc,zm=function(t){return function(n){return Tn(n,Za)}(t).fold(function(){var n=t.hasOwnProperty("uid")?t:x({uid:Pm("")},t);return Rd(n).getOrDie()},function(n){return n})},Lm=wc,Gm="alloy.item-hover",Um="alloy.item-focus",$m=b(Gm),Wm=b(Um),Xm=[Ve("data"),Ve("components"),Ve("dom"),Ge("hasSubmenu",!1),He("toggling"),Ca("itemBehaviours",[Oi,Di,Ea,il]),Ge("ignoreFocus",!1),Ge("domModification",{}),zo("builder",function(n){return{dom:n.dom,domModification:x(x({},n.domModification),{attributes:x(x(x({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:_a(n.itemBehaviours,[n.toggling.fold(Oi.revoke,function(n){return Oi.config(x({aria:{mode:"checked"}},n))}),Di.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Vd(n)}}),Ea.config({mode:"execution"}),il.config({store:{mode:"memory",initialValue:n.data}}),sm("item-type-events",function a(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}(Qo(),[Je(pt(),Ad),Je(Dt(),Di.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),Ge("eventOrder",{})],qm=[Ve("dom"),Ve("components"),zo("builder",function(n){return{dom:n.dom,components:n.components,events:Ye([function(n){return Je(n,function(n,t){t.stop()})}(Dt())])}})],Ym=b([qa({name:"widget",overrides:function(t){return{behaviours:uo([il.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),Km=[Ve("uid"),Ve("data"),Ve("components"),Ve("dom"),Ge("autofocus",!1),Ge("ignoreFocus",!1),Ca("widgetBehaviours",[il,Di,Ea]),Ge("domModification",{}),xc(Ym()),zo("builder",function(e){function r(n){return vc(n,e,"widget").map(function(n){return Ea.focusIn(n),n})}function n(n,t){return yu(t.event().target())||e.autofocus&&t.setSource(n.element()),yn.none()}var t=pc(0,e,Ym()),o=hc("item-widget",e,t.internals());return{dom:e.dom,components:o,domModification:e.domModification,events:Ye([to(function(n,t){r(n).each(function(n){t.stop()})}),Je(pt(),Ad),Je(Dt(),function(n,t){e.autofocus?r(n):Di.focus(n)})]),behaviours:_a(e.widgetBehaviours,[il.config({store:{mode:"memory",initialValue:e.data}}),Di.config({ignore:e.ignoreFocus,onFocus:function(n){Vd(n)}}),Ea.config({mode:"special",focusIn:e.autofocus?function(n){r(n)}:fo(),onLeft:n,onRight:n,onEscape:function(n,t){return Di.isFocused(n)||e.autofocus?(e.autofocus&&t.setSource(n.element()),yn.none()):(Di.focus(n),yn.some(!0))}})])}})],Jm=Ae("type",{widget:Km,item:Xm,separator:qm}),Qm=b([Ka({factory:{sketch:function(n){var t=Be("menu.spec item",Jm,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:x(x({},t),{uid:Oc("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Zm=b([Ve("value"),Ve("items"),Ve("dom"),Ve("components"),Ge("eventOrder",{}),oc("menuBehaviours",[pu,il,mm,Ea]),Ue("movement",{mode:"menu",moveOnTab:!0},Ae("mode",{grid:[pi(),zo("config",function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}})],matrix:[zo("config",function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),Ve("rowSelector")],menu:[Ge("moveOnTab",!0),zo("config",function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}})]})),Ne("markers",mi()),Ge("fakeFocus",!1),Ge("focusManager",ru()),No("onHighlight")]),ng=b("alloy.menu-focus"),tg=ff({name:"Menu",configFields:Zm(),partFields:Qm(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:uc(n.menuBehaviours,[pu.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),il.config({store:{mode:"memory",initialValue:n.value}}),mm.config({find:yn.some}),Ea.config(n.movement.config(n,n.movement))]),events:Ye([Je(Wm(),function(t,e){var n=e.event();t.getSystem().getByDom(n.target()).each(function(n){pu.highlight(t,n),e.stop(),G(t,ng(),{menu:t,item:n})})}),Je($m(),function(n,t){var e=t.event().item();pu.highlight(n,e)})]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),eg=function(n,t){return n.components()},rg=cr({fields:[],name:"replacing",apis:/* */Object.freeze({__proto__:null,append:function(n,t,e,r){jd(n,0,Jt,r)},prepend:function(n,t,e,r){jd(n,0,cn,r)},remove:Hd,replaceAt:Pd,replaceBy:function(t,n,e,r,o){var i=eg(t);return M(i,r).bind(function(n){return Pd(t,0,0,n,o)})},set:function(t,n,e,r){Nd(function(){var n=nt(r,t.getSystem().build);ln(t,n)},t.element())},contents:eg})}),og=function(e,r,o,n){return Tn(o,n).bind(function(n){return Tn(e,n).bind(function(n){var t=og(e,r,o,n);return yn.some([n].concat(t))})}).getOr([])},ig=function(n){return"prepared"===n.type?yn.some(n.menu):yn.none()},ug={init:function(){function o(e){return function(n,t){for(var e=bn(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];if(t(u,i,n))return yn.some(u)}return yn.none()}(i.get(),function(n,t){return n===e})}var i=En({}),u=En({}),c=En({}),a=En(yn.none()),f=En({}),s=function(n){return t(n).bind(ig)},t=function(n){return Tn(u.get(),n)},e=function(n){return Tn(i.get(),n)};return{setMenuBuilt:function(n,t){var e;u.set(x(x({},u.get()),((e={})[n]={type:"prepared",menu:t},e)))},setContents:function(n,t,e,r){a.set(yn.some(n)),i.set(e),u.set(t),f.set(r);var o=zd(r,e);c.set(o)},expand:function(e){return Tn(i.get(),e).map(function(n){var t=Tn(c.get(),e).getOr([]);return[n].concat(t)})},refresh:function(n){return Tn(c.get(),n)},collapse:function(n){return Tn(c.get(),n).bind(function(n){return 1<n.length?yn.some(n.slice(1)):yn.none()})},lookupMenu:t,lookupItem:e,otherMenus:function(n){var t=f.get();return A(bn(t),n)},getPrimary:function(){return a.get().bind(s)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),c.set({}),a.set(yn.none())},isClear:function(){return a.get().isNone()},getTriggeringPath:function(n,r){var t=E(e(n).toArray(),function(n){return s(n).isSome()});return Tn(c.get(),n).bind(function(n){var e=B(t.concat(n));return function(n){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(!r.isSome())return yn.none();t.push(r.getOrDie())}return yn.some(t)}(F(e,function(n,t){return function(n,e,r){return s(n).bind(function(t){return o(n).bind(function(n){return e(n).map(function(n){return{triggeredMenu:t,triggeringItem:n,triggeringPath:r}})})})}(n,r,e.slice(0,t+1)).fold(function(){return a.get().is(n)?[]:[yn.none()]},function(n){return[yn.some(n)]})}))})}}},extractPreparedMenu:ig},cg=b("collapse-item"),ag=af({name:"TieredMenu",configFields:[Po("onExecute"),Po("onEscape"),Ho("onOpenMenu"),Ho("onOpenSubmenu"),No("onRepositionMenu"),No("onCollapseMenu"),Ge("highlightImmediately",!0),je("data",[Ve("primary"),Ve("menus"),Ve("expansions")]),Ge("fakeFocus",!1),No("onHighlight"),No("onHover"),je("markers",[Ve("backgroundMenu")].concat(li()).concat(di())),Ve("dom"),Ge("navigateOnHover",!0),Ge("stayInDom",!1),oc("tmenuBehaviours",[Ea,pu,mm,rg]),Ge("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(c,n){function r(r,o,n){return O(n,function(n,t){function e(){return tg.sketch(x(x({dom:n.dom},n),{value:t,items:n.items,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:c.fakeFocus?function(){function o(n){return pu.getHighlighted(n).map(function(n){return n.element()})}return{get:o,set:function(t,n){var e=o(t);t.getSystem().getByDom(n).fold(w,function(n){pu.highlight(t,n)});var r=o(t);eu(t,e,r)}}}():ru()}))}return t===o?{type:"prepared",menu:r.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})}function a(n){return il.getValue(n).value}function u(t,n){pu.highlight(t,n),pu.getHighlighted(n).orThunk(function(){return pu.getFirst(n)}).each(function(n){$(t,n.element(),Dt())})}function f(t,n){return Ki(nt(n,function(n){return t.lookupMenu(n).bind(function(n){return"prepared"===n.type?yn.some(n.menu):yn.none()})}))}function s(t,n,e){var r=f(n,n.otherMenus(e));k(r,function(n){Cd(n.element(),[c.markers.backgroundMenu]),c.stayInDom||rg.remove(t,n)})}function l(n,r){var t=function(r){return o.get().getOrThunk(function(){var e={},n=Vi(r.element(),"."+c.markers.item),t=E(n,function(n){return"true"===lr(n,"aria-haspopup")});return k(t,function(n){r.getSystem().getByDom(n).each(function(n){var t=a(n);e[t]=n})}),o.set(yn.some(e)),e})}(n);wn(t,function(n,t){var e=T(r,t);fr(n.element(),"aria-expanded",e)})}function d(r,o,i){return yn.from(i[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){if("notbuilt"===n.type)return yn.none();var t=n.menu,e=f(o,i.slice(1));return k(e,function(n){yr(n.element(),c.markers.backgroundMenu)}),Y(t.element())||rg.append(r,Lm(t)),Cd(t.element(),[c.markers.backgroundMenu]),u(r,t),s(r,o,i),yn.some(t)})})}var m,t,o=En(yn.none()),g=ug.init(),i=function(n){return O(c.data.menus,function(n,t){return F(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})};(t=m=m||{})[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";function p(o,i,u){void 0===u&&(u=m.HighlightSubmenu);var n=a(i);return g.expand(n).bind(function(r){return l(o,r),yn.from(r[0]).bind(function(e){return g.lookupMenu(e).bind(function(n){var t=function(n,t,e){if("notbuilt"!==e.type)return e.menu;var r=n.getSystem().build(e.nbMenu());return g.setMenuBuilt(t,r),r}(o,e,n);return Y(t.element())||rg.append(o,Lm(t)),c.onOpenSubmenu(o,i,t,B(r)),u===m.HighlightSubmenu?(pu.highlightFirst(t),d(o,g,r)):(pu.dehighlightAll(t),yn.some(i))})})})}function h(t,e){var n=a(e);return g.collapse(n).bind(function(n){return l(t,n),d(t,g,n).map(function(n){return c.onCollapseMenu(t,e,n),n})})}function e(e){return function(t,n){return Pi(n.getSource(),"."+c.markers.item).bind(function(n){return t.getSystem().getByDom(n).toOption().bind(function(n){return e(t,n).map(function(){return!0})})})}}function v(n){return pu.getHighlighted(n).bind(pu.getHighlighted)}var y=Ye([Je(ng(),function(e,r){var n=r.event().item();g.lookupItem(a(n)).each(function(){var n=r.event().menu();pu.highlight(e,n);var t=a(r.event().item());g.refresh(t).each(function(n){return s(e,g,n)})})}),to(function(t,n){var e=n.event().target();t.getSystem().getByDom(e).each(function(n){0===a(n).indexOf("collapse-item")&&h(t,n),p(t,n,m.HighlightSubmenu).fold(function(){c.onExecute(t,n)},function(){})})}),Qr(function(t,n){(function(n){var t=r(n,c.data.primary,c.data.menus),e=i();return g.setContents(c.data.primary,t,c.data.expansions,e),g.getPrimary()})(t).each(function(n){rg.append(t,Lm(n)),c.onOpenMenu(t,n),c.highlightImmediately&&u(t,n)})})].concat(c.navigateOnHover?[Je($m(),function(n,t){var e=t.event().item();!function(t,n){var e=a(n);g.refresh(e).bind(function(n){return l(t,n),d(t,g,n)})}(n,e),p(n,e,m.HighlightParent),c.onHover(n,e)})]:[])),b={collapseMenu:function(t){v(t).each(function(n){h(t,n)})},highlightPrimary:function(t){g.getPrimary().each(function(n){u(t,n)})},repositionMenus:function(r){g.getPrimary().bind(function(t){return v(r).bind(function(n){var t=a(n),e=function(n){return On(n,function(n){return n})}(g.getMenus()),r=Ki(nt(e,ug.extractPreparedMenu));return g.getTriggeringPath(t,function(n){return function(n,t,e){return N(t,function(n){if(!n.getSystem().isConnected())return yn.none();var t=pu.getCandidates(n);return D(t,function(n){return a(n)===e})})}(0,r,n)})}).map(function(n){return{primary:t,triggeringPath:n}})}).fold(function(){(function(n){return yn.from(n.components()[0]).filter(function(n){return"menu"===lr(n.element(),"role")})})(r).each(function(n){c.onRepositionMenu(r,n,[])})},function(n){var t=n.primary,e=n.triggeringPath;c.onRepositionMenu(r,t,e)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:uc(c.tmenuBehaviours,[Ea.config({mode:"special",onRight:e(function(n,t){return yu(t.element())?yn.none():p(n,t,m.HighlightSubmenu)}),onLeft:e(function(n,t){return yu(t.element())?yn.none():h(n,t)}),onEscape:e(function(n,t){return h(n,t).orThunk(function(){return c.onEscape(n,t).map(function(){return n})})}),focusIn:function(t,n){g.getPrimary().each(function(n){$(t,n.element(),Dt())})}}),pu.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),mm.config({find:function(n){return pu.getHighlighted(n)}}),rg.config({})]),eventOrder:c.eventOrder,apis:b,events:y}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:he(n,t),expansions:{}}},collapseItem:function(n){return{value:sc(cg()),meta:{text:n}}}}}),fg=function(n,t,e,r){return Ld(0,t,0,r).bind(function(t){return t.transition.map(function(n){return{transition:n,route:t}})})},sg=function(n,t,e){var r=n.element();return dr(r,t.destinationAttr)?yn.some({start:lr(n.element(),t.stateAttr),destination:lr(n.element(),t.destinationAttr)}):yn.none()},lg=/* */Object.freeze({__proto__:null,findRoute:Ld,disableTransition:Gd,getCurrentRoute:sg,jumpTo:Ud,progressTo:function(e,r,o,i){!function(n,t){dr(n.element(),t.destinationAttr)&&(fr(n.element(),t.stateAttr,lr(n.element(),t.destinationAttr)),mr(n.element(),t.destinationAttr))}(e,r);var n=function(n,t,e,r){return{start:lr(n.element(),t.stateAttr),destination:r}}(e,r,0,i);fg(e,r,o,n).fold(function(){Ud(e,r,o,i)},function(n){Gd(e,r,o);var t=n.transition;yr(e.element(),t.transitionClass),fr(e.element(),r.destinationAttr,i)})},getState:function(n,t,e){var r=n.element();return dr(r,t.stateAttr)?yn.some(lr(r,t.stateAttr)):yn.none()}}),dg=/* */Object.freeze({__proto__:null,events:function(o,i){return Ye([Je(wt(),function(e,n){var r=n.event().raw();sg(e,o).each(function(t){Ld(0,o,0,t).each(function(n){n.transition.each(function(n){r.propertyName===n.property&&(Ud(e,o,i,t.destination),o.onTransition(e,t))})})})}),Qr(function(n,t){Ud(n,o,i,o.initialState)})])}}),mg=[Ge("destinationAttr","data-transitioning-destination"),Ge("stateAttr","data-transitioning-state"),Ve("initialState"),No("onTransition"),No("onFinish"),Ne("routes",Ie(ie.value,Ie(ie.value,Ee([Le("transition",[Ve("property"),Ve("transitionClass")])]))))],gg=cr({fields:mg,name:"transitioning",active:dg,apis:lg,extra:{createRoutes:function(n){var r={};return wn(n,function(n,t){var e=t.split("<->");r[e[0]]=he(e[1],n),r[e[1]]=he(e[0],n)}),r},createBistate:function(n,t,e){return ve([{key:n,value:he(t,e)},{key:t,value:he(n,e)}])},createTristate:function(n,t,e,r){return ve([{key:n,value:ve([{key:t,value:r},{key:e,value:r}])},{key:t,value:ve([{key:n,value:r},{key:e,value:r}])},{key:e,value:ve([{key:n,value:r},{key:t,value:r}])}])}}}),pg=ki("scrollable"),hg=function(n){yr(n,pg)},vg=pg,yg=function(n,t,e,r,o){return{data:{value:n,text:t},type:"item",dom:{tag:"div",classes:o?[ki("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:ki("format-matches"),selected:e},itemBehaviours:uo(o?[]:[Yo(n,function(n,t){(t?Oi.on:Oi.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},bg=function(n,t,e,r){return{value:n,dom:{tag:"div"},components:[Hs.sketch({dom:{tag:"div",classes:[ki("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[ki("styles-collapse-icon")]}},Bd(n)]:[Bd(n)],action:function(n){if(r){var t=e().get(n);ag.collapseMenu(t)}}}),{dom:{tag:"div",classes:[ki("styles-menu-items-container")]},components:[tg.parts().items({})],behaviours:uo([sm("adhoc-scrollable-menu",[Qr(function(n,t){Mi(n.element(),"overflow-y","auto"),Mi(n.element(),"-webkit-overflow-scrolling","touch"),hg(n.element())}),Zr(function(n){ii(n.element(),"overflow-y"),ii(n.element(),"-webkit-overflow-scrolling"),$d(n.element())})])])}],items:t,menuBehaviours:uo([gg.config({initialState:"after",routes:gg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},xg=function(n){return C(n,function(n,t){var e=qd(t);return{menus:ae(n.menus,e.menus),items:[e.item].concat(n.items),expansions:ae(n.expansions,e.expansions)}},{menus:{},expansions:{},items:[]})},wg=["undo","bold","italic","link","image","bullist","styleselect"],Sg=function(n){return F(n,function(n){return Xn(n)?Sg(n):Jd(n)})},Og=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},Tg=b(!0),kg=tinymce.util.Tools.resolve("tinymce.util.Delay");function Eg(n){var t=n.raw();return t.touches===undefined||1!==t.touches.length?yn.none():yn.some(t.touches[0])}function Cg(e){var r=En(yn.none()),o=En(!1),i=function n(e,r){var o=null;return{cancel:function(){null!==o&&(g.clearTimeout(o),o=null)},schedule:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];o=g.setTimeout(function(){e.apply(null,n),o=null},r)}}}(function(n){e.triggerEvent(It(),n),o.set(!0)},400),u=ve([{key:ft(),value:function(e){return Eg(e).each(function(n){i.cancel();var t={x:b(n.clientX),y:b(n.clientY),target:e.target};i.schedule(e),o.set(!1),r.set(yn.some(t))}),yn.none()}},{key:st(),value:function(n){return i.cancel(),Eg(n).each(function(t){r.get().each(function(n){!function(n,t){var e=Math.abs(n.clientX-t.x()),r=Math.abs(n.clientY-t.y());return 5<e||5<r}(t,n)||r.set(yn.none())})}),yn.none()}},{key:lt(),value:function(t){i.cancel();return r.get().filter(function(n){return nn(n.target(),t.target())}).map(function(n){return o.get()?(t.prevent(),!1):e.triggerEvent(Mt(),t)})}}]);return{fireIfReady:function(t,n){return Tn(u,n).bind(function(n){return n(t)})}}}function _g(e){var t=Cg({triggerEvent:function(n,t){e.onTapContent(t)}});return{fireTouchstart:function(n){t.fireIfReady(n,"touchstart")},onTouchend:function(){return em(e.body(),"touchend",function(n){t.fireIfReady(n,"touchend")})},onTouchmove:function(){return em(e.body(),"touchmove",function(n){t.fireIfReady(n,"touchmove")})}}}function Dg(r,t,e){function o(n){return!nn(n.start(),n.finish())||n.soffset()!==n.foffset()}function n(){var n=r.doc().dom().hasFocus()&&r.getSelection().exists(o);e.getByDom(t).each(!0===(n||yo(u).filter(function(n){return"input"===X(n)}).exists(function(n){return n.dom().selectionStart!==n.dom().selectionEnd}))?Oi.on:Oi.off)}var i=_g(r),u=tn(t),c=[em(r.body(),"touchstart",function(n){r.onTouchContent(),i.fireTouchstart(n)}),i.onTouchmove(),i.onTouchend(),em(t,"touchstart",function(n){r.onTouchToolstrip()}),r.onToReading(function(){vo(r.body())}),r.onToEditing(w),r.onScrollToCursor(function(n){n.preventDefault(),r.getCursorBox().each(function(n){var t=r.win(),e=n.top()>t.innerHeight||n.bottom()>t.innerHeight?n.bottom()-t.innerHeight+50:0;0!=e&&t.scrollTo(t.pageXOffset,t.pageYOffset+e)})})].concat(!0==Ig?[]:[em(Pt.fromDom(r.win()),"blur",function(){e.getByDom(t).each(Oi.off)}),em(u,"select",n),em(r.doc(),"selectionchange",n)]);return{destroy:function(){k(c,function(n){n.unbind()})}}}function Mg(n,t){var e=parseInt(lr(n,t),10);return isNaN(e)?0:e}var Ig=6<=z().os.version.major;function Fg(n){return"img"===X(n)?1:function(n){return pp.getOption(n)}(n).fold(function(){return Kt(n).length},function(n){return n.length})}function Rg(n,t,e){var r=n.document.createRange();return function(e,n){n.fold(function(n){e.setStartBefore(n.dom())},function(n,t){e.setStart(n.dom(),t)},function(n){e.setStartAfter(n.dom())})}(r,t),function(e,n){n.fold(function(n){e.setEndBefore(n.dom())},function(n,t){e.setEnd(n.dom(),t)},function(n){e.setEndAfter(n.dom())})}(r,e),r}function Bg(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(r.dom(),o),i}function Ag(n){return{left:b(n.left),top:b(n.top),right:b(n.right),bottom:b(n.bottom),width:b(n.width),height:b(n.height)}}function Vg(n,t,e){return t(Pt.fromDom(e.startContainer),e.startOffset,Pt.fromDom(e.endContainer),e.endOffset)}function Ng(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return wp.rtl(Pt.fromDom(n.endContainer),n.endOffset,Pt.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Vg(0,wp.ltr,e)}):Vg(0,wp.ltr,e)}(0,function(o,n){return n.match({domRange:function(n){return{ltr:b(n),rtl:yn.none}},relative:function(n,t){return{ltr:W(function(){return Rg(o,n,t)}),rtl:W(function(){return yn.some(Rg(o,t,n))})}},exact:function(n,t,e,r){return{ltr:W(function(){return Bg(o,n,t,e,r)}),rtl:W(function(){return yn.some(Bg(o,e,r,n,t))})}}})}(n,t))}function jg(n,t){var e=X(n);return"input"===e?yp.after(n):T(["br","img"],e)?0===t?yp.before(n):yp.after(n):yp.on(n,t)}function Hg(n,t,e,r){var o=function(n,t,e,r){var o=tn(n).dom().createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o}(n,t,e,r),i=nn(n,e)&&t===r;return o.collapsed&&!i}function Pg(n,t,e,r,o){!function(n,t){yn.from(n.getSelection()).each(function(n){n.removeAllRanges(),n.addRange(t)})}(n,Bg(n,t,e,r,o))}function zg(n,t,e,r,o){!function(u,n){Ng(u,n).match({ltr:function(n,t,e,r){Pg(u,n,t,e,r)},rtl:function(n,t,e,r){var o=u.getSelection();if(o.setBaseAndExtent)o.setBaseAndExtent(n.dom(),t,e.dom(),r);else if(o.extend)try{!function(n,t,e,r,o,i){t.collapse(e.dom(),r),t.extend(o.dom(),i)}(0,o,n,t,e,r)}catch(i){Pg(u,e,r,n,t)}else Pg(u,e,r,n,t)}})}(n,function(n,t,e,r){var o=jg(n,t),i=jg(e,r);return xp.relative(o,i)}(t,e,r,o))}function Lg(n){var t=Pt.fromDom(n.anchorNode),e=Pt.fromDom(n.focusNode);return Hg(t,n.anchorOffset,e,n.focusOffset)?yn.some(hp(t,n.anchorOffset,e,n.focusOffset)):function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return yn.some(hp(Pt.fromDom(t.startContainer),t.startOffset,Pt.fromDom(e.endContainer),e.endOffset))}return yn.none()}(n)}function Gg(n){return yn.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(Lg)}function Ug(n,t){return function(n){var t=n.getClientRects(),e=0<t.length?t[0]:n.getBoundingClientRect();return 0<e.width||0<e.height?yn.some(e).map(Ag):yn.none()}(function(i,n){return Ng(i,n).match({ltr:function(n,t,e,r){var o=i.document.createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o},rtl:function(n,t,e,r){var o=i.document.createRange();return o.setStart(e.dom(),r),o.setEnd(n.dom(),t),o}})}(n,t))}function $g(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:b(2),height:n.height}}function Wg(n){return{left:b(n.left),top:b(n.top),right:b(n.right),bottom:b(n.bottom),width:b(n.width),height:b(n.height)}}function Xg(n){var t=n.getSelection();return t!==undefined&&0<t.rangeCount?function(e){if(e.collapsed){var r=Pt.fromDom(e.startContainer);return en(r).bind(function(n){var t=xp.exact(r,e.startOffset,n,Fg(n));return Ug(e.startContainer.ownerDocument.defaultView,t).map($g).map(V)}).getOr([])}return nt(e.getClientRects(),Wg)}(t.getRangeAt(0)):[]}function qg(n){n.focus();var t=Pt.fromDom(n.document.body);(yo().exists(function(n){return T(["input","textarea"],X(n))})?function(n){kg.setTimeout(function(){n()},0)}:r)(function(){yo().each(vo),ho(t)})}function Yg(n,t){fr(n,Sp,t)}function Kg(n){return{top:b(n.top()),bottom:b(n.top()+n.height())}}function Jg(n,t){var e=function(n){return Mg(n,Sp)}(t),r=n.innerHeight;return r<e?yn.some(e-r):yn.none()}function Qg(n,r){var t=Pt.fromDom(r.document.body),e=em(Pt.fromDom(n),"resize",function(){Jg(n,t).each(function(e){(function(n){var t=Xg(n);return 0<t.length?yn.some(t[0]).map(Kg):yn.none()})(r).each(function(n){var t=function(n,t,e){return t.top()>n.innerHeight||t.bottom()>n.innerHeight?Math.min(e,t.bottom()-n.innerHeight+50):0}(r,n,e);0!==t&&r.scrollTo(r.pageXOffset,r.pageYOffset+t)})}),Yg(t,n.innerHeight)});return Yg(t,n.innerHeight),{toEditing:function(){qg(r)},destroy:function(){e.unbind()}}}function Zg(n){return yn.from(n.dom().contentWindow)}function np(n){return Zg(n).bind(Gg)}function tp(n){return n.getFrame()}function ep(n,t,e,r){return n[e].getOrThunk(function(){return function(n){return em(t,r,n)}})}function rp(n){return{left:b(n.left),top:b(n.top),right:b(n.right),bottom:b(n.bottom),width:b(n.width),height:b(n.height)}}function op(c){var a=tp(c);return function(n){return yn.some(Pt.fromDom(n.dom().contentWindow.document.body))}(a).bind(function(u){return function(n){return yn.some(Pt.fromDom(n.dom().contentWindow.document))}(a).bind(function(i){return Zg(a).map(function(o){var n=Pt.fromDom(i.dom().documentElement),t=c.getCursorBox.getOrThunk(function(){return function(){return function(n){return Gg(n).map(function(n){return xp.exact(n.start(),n.soffset(),n.finish(),n.foffset())})}(o).bind(function(n){return Ug(o,n).orThunk(function(){return function(n){return Gg(n).filter(function(n){return nn(n.start(),n.finish())&&n.soffset()===n.foffset()}).bind(function(n){var t=n.start().dom().getBoundingClientRect();return 0<t.width||0<t.height?yn.some(t).map(rp):yn.none()})}(o)})})}}),e=c.setSelection.getOrThunk(function(){return function(n,t,e,r){zg(o,n,t,e,r)}}),r=c.clearSelection.getOrThunk(function(){return function(){!function(n){n.getSelection().removeAllRanges()}(o)}});return{body:b(u),doc:b(i),win:b(o),html:b(n),getSelection:S(np,a),setSelection:e,clearSelection:r,frame:b(a),onKeyup:ep(c,i,"onKeyup","keyup"),onNodeChanged:ep(c,i,"onNodeChanged","SelectionChange"),onDomChanged:c.onDomChanged,onScrollToCursor:c.onScrollToCursor,onScrollToElement:c.onScrollToElement,onToReading:c.onToReading,onToEditing:c.onToEditing,onToolbarScrollStart:c.onToolbarScrollStart,onTouchContent:c.onTouchContent,onTapContent:c.onTapContent,onTouchToolstrip:c.onTouchToolstrip,getCursorBox:t}})})})}function ip(n,t){function e(r){return function(n){var t=lr(n,"style"),e=t===undefined?"no-styles":t.trim();e!==r&&(fr(n,Tp,e),fr(n,"style",r))}}var r=function(n,t,e){return Bi(n,function(n){return K(n,t)},e)}(n,"*"),o=F(r,function(n){return function(n,t){return Ai(n,function(n){return K(n,t)})}(n,"*")}),i=function(n){var t=ri(n,"background-color");return t!==undefined&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"}(t);k(o,e("display:none!important;")),k(r,e(kp+Ep+i)),e((!0===Cp?"":kp)+Ep+i)(n)}function up(){var n=function(n){return Q(n)}("["+Tp+"]");k(n,function(n){var t=lr(n,Tp);"no-styles"!==t?fr(n,"style",t):mr(n,"style"),mr(n,Tp)})}function cp(){var t=Ni("head").getOrDie(),n=Ni('meta[name="viewport"]').getOrThunk(function(){var n=Pt.fromTag("meta");return fr(n,"name","viewport"),Jt(t,n),n}),e=lr(n,"content");return{maximize:function(){fr(n,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){e!==undefined&&null!==e&&0<e.length?fr(n,"content",e):fr(n,"content","user-scalable=yes")}}}function ap(e,r){var o=null;return{cancel:function(){null!==o&&(g.clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null!==o&&g.clearTimeout(o),o=g.setTimeout(function(){e.apply(null,n),o=null},r)}}}function fp(n,t){var e=Bs(gm.sketch({dom:zs('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:uo([Oi.config({toggleClass:ki("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=function(e,r){var o=null;return{cancel:function(){null!==o&&(g.clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null===o&&(o=g.setTimeout(function(){e.apply(null,n),o=null},r))}}}(n,200);return gm.sketch({dom:zs('<div class="${prefix}-disabled-mask"></div>'),components:[gm.sketch({dom:zs('<div class="${prefix}-content-container"></div>'),components:[Hs.sketch({dom:zs('<div class="${prefix}-content-tap-section"></div>'),components:[e.asSpec()],action:function(n){r.throttle()},buttonBehaviours:uo([Oi.config({toggleClass:ki("mask-tap-icon-selected")})])})]})]})}function sp(n){var t=Be("Getting AndroidWebapp schema",_p,n);Mi(t.toolstrip,"width","100%");var e=zm(fp(function(){t.setReadOnly(t.readOnlyOnInit()),o.enter()},t.translate));t.alloy.add(e);var r={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}};Jt(t.container,e.element());var o=function(t,n){var e=cp(),r=md(),o=md();return{enter:function(){n.hide(),yr(t.container,ki("fullscreen-maximized")),yr(t.container,ki("android-maximized")),e.maximize(),yr(t.body,ki("android-scroll-reload")),r.set(Qg(t.win,Op(t.editor).getOrDie("no"))),op(t.editor).each(function(n){ip(t.container,n.body()),o.set(Dg(n,t.toolstrip,t.alloy))})},exit:function(){e.restore(),n.show(),xr(t.container,ki("fullscreen-maximized")),xr(t.container,ki("android-maximized")),up(),xr(t.body,ki("android-scroll-reload")),o.clear(),r.clear()}}}(t,r);return{setReadOnly:t.setReadOnly,refreshStructure:w,enter:o.enter,exit:o.exit,destroy:w}}function lp(n){return"true"===lr(n,Ap)?function(n){return 0<n.dom().scrollLeft||function(n){n.dom().scrollLeft=1;var t=0!==n.dom().scrollLeft;return n.dom().scrollLeft=0,t}(n)}(n):function(n){return 0<n.dom().scrollTop||function(n){n.dom().scrollTop=1;var t=0!==n.dom().scrollTop;return n.dom().scrollTop=0,t}(n)}(n)}var dp,mp,gp,pp=function kv(e,r){var t=function(n){return e(n)?yn.from(n.dom().nodeValue):yn.none()};return{get:function(n){if(!e(n))throw new Error("Can only get "+r+" value of a "+r+" node");return t(n).getOr("")},getOption:t,set:function(n,t){if(!e(n))throw new Error("Can only set raw "+r+" value of a "+r+" node");n.dom().nodeValue=t}}}($t,"text"),hp=function(n,t,e,r){return{start:b(n),soffset:b(t),finish:b(e),foffset:b(r)}},vp=ue([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),yp={before:vp.before,on:vp.on,after:vp.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(y,y,y)}},bp=ue([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),xp={domRange:bp.domRange,relative:bp.relative,exact:bp.exact,exactFromRange:function(n){return bp.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){return function(n){return Pt.fromDom(n.dom().ownerDocument.defaultView)}(function(n){return n.match({domRange:function(n){return Pt.fromDom(n.startContainer)},relative:function(n,t){return yp.getStart(n)},exact:function(n,t,e,r){return n}})}(n))},range:hp},wp=ue([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Sp=(wp.ltr,wp.rtl,"data-"+ki("last-outer-height")),Op=(dp="getWin",mp=Zg,function(t){return t[dp].getOrThunk(function(){var n=tp(t);return function(){return mp(n)}})()}),Tp="data-ephox-mobile-fullscreen-style",kp="position:absolute!important;",Ep="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Cp=z().os.isAndroid(),_p=Gr([je("editor",[Ve("getFrame"),He("getBody"),He("getDoc"),He("getWin"),He("getSelection"),He("setSelection"),He("clearSelection"),He("cursorSaver"),He("onKeyup"),He("onNodeChanged"),He("getCursorBox"),Ve("onDomChanged"),Ge("onTouchContent",w),Ge("onTapContent",w),Ge("onTouchToolstrip",w),Ge("onScrollToCursor",b({unbind:w})),Ge("onScrollToElement",b({unbind:w})),Ge("onToEditing",b({unbind:w})),Ge("onToReading",b({unbind:w})),Ge("onToolbarScrollStart",y)]),Ve("socket"),Ve("toolstrip"),Ve("dropup"),Ve("toolbar"),Ve("container"),Ve("alloy"),$e("win",function(n){return tn(n.socket).dom().defaultView}),$e("body",function(n){return Pt.fromDom(n.socket.dom().ownerDocument.body)}),Ge("translate",y),Ge("setReadOnly",w),Ge("readOnlyOnInit",b(!0))]),Dp=b([Ve("dom"),Ge("shell",!0),oc("toolbarBehaviours",[rg])]),Mp=b([Ya({name:"groups",overrides:function(){return{behaviours:uo([rg.config({})])}}})]),Ip=ff({name:"Toolbar",configFields:Dp(),partFields:Mp(),factory:function(t,n,e,r){var o=function(n){return t.shell?yn.some(n):vc(n,t,"groups")},i=t.shell?{behaviours:[rg.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:uc(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,t){o(n).fold(function(){throw g.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){rg.set(n,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),Fp=b([Ve("items"),(gp=["itemSelector"],je("markers",nt(gp,Ve))),oc("tgroupBehaviours",[Ea])]),Rp=b([Ka({name:"items",unit:"item"})]),Bp=ff({name:"ToolbarGroup",configFields:Fp(),partFields:Rp(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:uc(n.tgroupBehaviours,[Ea.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Ap="data-"+ki("horizontal-scroll"),Vp=function(n){fr(n,Ap,"true")};function Np(){function t(n){var t=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:zs('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:uo([sm("adhoc-scrollable-toolbar",!0===n.scrollable?[no(function(n,t){Mi(n.element(),"overflow-x","auto"),Vp(n.element()),hg(n.element())})]:[])]),components:[gm.sketch({components:[Bp.parts().items({})]})],markers:{itemSelector:"."+ki("toolbar-group-item")},items:n.items}}function e(){Ip.setGroups(r,o.get()),Oi.off(r)}var r=zm(Ip.sketch({dom:zs('<div class="${prefix}-toolbar"></div>'),components:[Ip.parts().groups({})],toolbarBehaviours:uo([Oi.config({toggleClass:ki("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Ea.config({mode:"cyclic"})]),shell:!0})),n=zm(gm.sketch({dom:{classes:[ki("toolstrip")]},components:[Lm(r)],containerBehaviours:uo([Oi.config({toggleClass:ki("android-selection-context-toolbar"),toggleOnExecute:!1})])})),o=En([]);return{wrapper:b(n),toolbar:b(r),createGroups:function(n){return nt(n,i(Bp.sketch,t))},setGroups:function(n){o.set(n),e()},setContextToolbar:function(n){Oi.on(r),Ip.setGroups(r,n)},restoreToolbar:function(){Oi.isOn(r)&&e()},refresh:function(){},focus:function(){Ea.focusIn(r)}}}function jp(n){return zm(Hs.sketch({dom:zs('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))}function Hp(){return zm(gm.sketch({dom:zs('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:uo([rg.config({})])}))}function Pp(n,t){rg.append(n,Lm(t))}function zp(n,t){rg.remove(n,t)}function Lp(n,t,e,r){(!0===e?mo.toAlpha:mo.toOmega)(r),(e?Pp:zp)(n,t)}function Gp(t,n){return n.getAnimationRoot.fold(function(){return t.element()},function(n){return n(t)})}function Up(n){return n.dimension.property}function $p(n,t){return n.dimension.getDimension(t)}function Wp(n,t){var e=Gp(n,t);Cd(e,[t.shrinkingClass,t.growingClass])}function Xp(n,t){xr(n.element(),t.openClass),yr(n.element(),t.closedClass),Mi(n.element(),Up(t),"0px"),ui(n.element())}function qp(n,t){xr(n.element(),t.closedClass),yr(n.element(),t.openClass),ii(n.element(),Up(t))}function Yp(n,t,e,r){e.setCollapsed(),Mi(n.element(),Up(t),$p(t,n.element())),ui(n.element()),Wp(n,t),Xp(n,t),t.onStartShrink(n),t.onShrunk(n)}function Kp(n,t,e,r){var o=r.getOrThunk(function(){return $p(t,n.element())});e.setCollapsed(),Mi(n.element(),Up(t),o),ui(n.element());var i=Gp(n,t);xr(i,t.growingClass),yr(i,t.shrinkingClass),Xp(n,t),t.onStartShrink(n)}function Jp(n,t,e){var r=$p(t,n.element());("0px"===r?Yp:Kp)(n,t,e,yn.some(r))}function Qp(n,t,e){var r=Gp(n,t),o=wr(r,t.shrinkingClass),i=$p(t,n.element());qp(n,t);var u=$p(t,n.element());(o?function(){Mi(n.element(),Up(t),i),ui(n.element())}:function(){Xp(n,t)})(),xr(r,t.shrinkingClass),yr(r,t.growingClass),qp(n,t),Mi(n.element(),Up(t),u),e.setExpanded(),t.onStartGrow(n)}function Zp(n,t,e){var r=Gp(n,t);return!0===wr(r,t.growingClass)}function nh(n,t,e){var r=Gp(n,t);return!0===wr(r,t.shrinkingClass)}function th(t,e){var r=zm(gm.sketch({dom:{tag:"div",classes:[ki("dropup")]},components:[],containerBehaviours:uo([rg.config({}),lh.config({closedClass:ki("dropup-closed"),openClass:ki("dropup-open"),shrinkingClass:ki("dropup-shrinking"),growingClass:ki("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){t(),e(),rg.set(n,[])},onGrown:function(n){t(),e()}}),Ko(function(n,t){o(w)})])})),o=function(n){g.window.requestAnimationFrame(function(){n(),lh.shrink(r)})};return{appear:function(n,t,e){!0===lh.hasShrunk(r)&&!1===lh.isTransitioning(r)&&g.window.requestAnimationFrame(function(){t(e),rg.set(r,[n()]),lh.grow(r)})},disappear:o,component:b(r),element:r.element}}function eh(n){return 8===n.raw().which&&!T(["input","textarea"],X(n.target()))&&!function(n,t,e){return Pi(n,t,e).isSome()}(n.target(),'[contenteditable="true"]')}function rh(t,n){var e=Be("Getting GUI events settings",mh,n),r=Cg(e),o=nt(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return em(t,n,function(t){r.fireIfReady(t,n).each(function(n){n&&t.kill()}),e.triggerEvent(n,t)&&t.kill()})}),i=En(yn.none()),u=em(t,"paste",function(t){r.fireIfReady(t,"paste").each(function(n){n&&t.kill()}),e.triggerEvent("paste",t)&&t.kill(),i.set(yn.some(g.setTimeout(function(){e.triggerEvent(Et(),t)},0)))}),c=em(t,"keydown",function(n){e.triggerEvent("keydown",n)?n.kill():!0===e.stopBackspace&&eh(n)&&n.prevent()}),a=function(n,t){return dh?rm(n,"focus",t):em(n,"focusin",t)}(t,function(n){e.triggerEvent("focusin",n)&&n.kill()}),f=En(yn.none()),s=function(n,t){return dh?rm(n,"blur",t):em(n,"focusout",t)}(t,function(n){e.triggerEvent("focusout",n)&&n.kill(),f.set(yn.some(g.setTimeout(function(){e.triggerEvent(kt(),n)},0)))});return{unbind:function(){k(o,function(n){n.unbind()}),c.unbind(),a.unbind(),s.unbind(),u.unbind(),i.get().each(g.clearTimeout),f.get().each(g.clearTimeout)}}}function oh(n,t){var e=Tn(n,"target").map(function(n){return n()}).getOr(t);return En(e)}function ih(n,r,t,e,o,i){var u=n(r,e),c=function(n,t){var e=En(!1),r=En(!1);return{stop:function(){e.set(!0)},cut:function(){r.set(!0)},isStopped:e.get,isCut:r.get,event:b(n),setSource:t.set,getSource:t.get}}(t,o);return u.fold(function(){return i.logEventNoHandlers(r,e),gh.complete()},function(t){var e=t.descHandler();return xd(e)(c),c.isStopped()?(i.logEventStopped(r,t.element(),e.purpose()),gh.stopped()):c.isCut()?(i.logEventCut(r,t.element(),e.purpose()),gh.complete()):en(t.element()).fold(function(){return i.logNoParent(r,t.element(),e.purpose()),gh.complete()},function(n){return i.logEventResponse(r,t.element(),e.purpose()),gh.resume(n)})})}function uh(n,t,e){var r=function(n){var t=En(!1);return{stop:function(){t.set(!0)},cut:w,isStopped:t.get,isCut:b(!1),event:b(n),setSource:o("Cannot set source of a broadcasted event"),getSource:o("Cannot get source of a broadcasted event")}}(t);return k(n,function(n){var t=n.descHandler();xd(t)(r)}),r.isStopped()}var ch,ah=/* */Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){ii(n.element(),Up(t));var r=$p(t,n.element());Mi(n.element(),Up(t),r)}},grow:function(n,t,e){e.isExpanded()||Qp(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&Jp(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&Yp(n,t,e,yn.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:Zp,isShrinking:nh,isTransitioning:function(n,t,e){return!0===Zp(n,t)||!0===nh(n,t)},toggleGrow:function(n,t,e){(e.isExpanded()?Jp:Qp)(n,t,e)},disableTransitions:Wp}),fh=/* */Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.expanded;return rr(e?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:he(t.dimension.property,"0px")})},events:function(e,r){return Ye([function(n,t){return Ze(n)(t)}(wt(),function(n,t){t.event().raw().propertyName===e.dimension.property&&(Wp(n,e),r.isExpanded()&&ii(n.element(),e.dimension.property),(r.isExpanded()?e.onGrown:e.onShrunk)(n))})])}}),sh=[Ve("closedClass"),Ve("openClass"),Ve("shrinkingClass"),Ve("growingClass"),He("getAnimationRoot"),No("onShrunk"),No("onStartShrink"),No("onGrown"),No("onStartGrow"),Ge("expanded",!1),Ne("dimension",Ae("property",{width:[zo("property","width"),zo("getDimension",function(n){return Sf(n)+"px"})],height:[zo("property","height"),zo("getDimension",function(n){return Ri(n)+"px"})]}))],lh=cr({fields:sh,name:"sliding",active:fh,apis:ah,state:/* */Object.freeze({__proto__:null,init:function(n){var t=En(n.expanded);return io({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:S(t.set,!1),setExpanded:S(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),dh=z().browser.isFirefox(),mh=Ee([(ch="triggerEvent",Ne(ch,Kr)),Ge("stopBackspace",!0)]),gh=ue([{stopped:[]},{resume:["element"]},{complete:[]}]),ph=function(t,e,r,n,o,i){return ih(t,e,r,n,o,i).fold(function(){return!0},function(n){return ph(t,e,r,n,o,i)},function(){return!1})},hh=function(n,t,e,r,o){var i=oh(e,r);return ph(n,t,e,r,i,o)},vh=function(n,t){return{element:b(n),descHandler:b(t)}},yh=function(n,t){return{id:b(n),descHandler:b(t)}};function bh(){var i={};return{registerId:function(r,o,n){wn(n,function(n,t){var e=i[t]!==undefined?i[t]:{};e[o]=Nm(n,r),i[t]=e})},unregisterId:function(e){wn(i,function(n,t){n.hasOwnProperty(e)&&delete n[e]})},filterByType:function(n){return Tn(i,n).map(function(n){return On(n,function(n,t){return yh(t,n)})}).getOr([])},find:function(n,t,e){var r=Tn(i,t);return Jr(e,function(n){return function(n,e){return uf(e).fold(function(){return yn.none()},function(t){return n.bind(function(n){return Tn(n,t)}).map(function(n){return vh(e,n)})})}(r,n)},n)}}}function xh(){function r(n){var t=n.element();return uf(t).fold(function(){return function(n,t){var e=sc(ef+n);return of(t,e),e}("uid-",n.element())},function(n){return n})}var o=bh(),i={},u=function(n){uf(n.element()).each(function(n){delete i[n],o.unregisterId(n)})};return{find:function(n,t,e){return o.find(n,t,e)},filter:function(n){return o.filterByType(n)},register:function(n){var t=r(n);v(i,t)&&function(n,t){var e=i[t];if(e!==n)throw new Error('The tagId "'+t+'" is already used by: '+To(e.element())+"\nCannot use it for: "+To(n.element())+"\nThe conflicting element is"+(Y(e.element())?" ":" not ")+"already in the DOM");u(n)}(n,t);var e=[n];o.registerId(e,t,n.events()),i[t]=n},unregister:u,getById:function(n){return Tn(i,n)}}}var wh=function(e){function r(t){return en(e.element()).fold(function(){return!0},function(n){return nn(t,n)})}function o(n,t){return u.find(r,n,t)}function i(e){var n=u.filter(Ct());k(n,function(n){var t=n.descHandler();xd(t)(e)})}var u=xh(),n=rh(e.element(),{triggerEvent:function(t,e){return Ao(t,e.target(),function(n){return function(n,t,e,r){var o=e.target();return hh(n,t,e,o,r)}(o,t,e,n)})}}),c={debugInfo:b("real"),triggerEvent:function(t,e,r){Ao(t,e,function(n){return hh(o,t,r,e,n)})},triggerFocus:function(t,e){uf(t).fold(function(){ho(t)},function(n){Ao(Tt(),t,function(n){return function(n,t,e,r,o){var i=oh(e,r);ih(n,t,e,r,i,o)}(o,Tt(),{originator:b(e),kill:w,prevent:w,target:b(t)},t,n),!1})})},triggerEscape:function(n,t){c.triggerEvent("keydown",n.element(),t.event())},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:zm,addToGui:function(n){f(n)},removeFromGui:function(n){s(n)},addToWorld:function(n){t(n)},removeFromWorld:function(n){a(n)},broadcast:function(n){l(n)},broadcastOn:function(n,t){d(n,t)},broadcastEvent:function(n,t){m(n,t)},isConnected:b(!0)},t=function(n){n.connect(c),$t(n.element())||(u.register(n),k(n.components(),t),c.triggerEvent(Ft(),n.element(),{target:b(n.element())}))},a=function(n){$t(n.element())||(k(n.components(),a),u.unregister(n)),n.disconnect()},f=function(n){!function(n,t){te(n,t,Jt)}(e,n)},s=function(n){dn(n)},l=function(n){i({universal:b(!0),data:b(n)})},d=function(n,t){i({universal:b(!1),channels:b(n),data:b(t)})},m=function(n,t){var e=u.filter(n);return uh(e,t)},g=function(n){return u.getById(n).fold(function(){return ie.error(new Error('Could not find component with uid: "'+n+'" in system.'))},ie.value)},p=function(n){var t=uf(n).getOr("not found");return g(t)};return t(e),{root:b(e),element:e.element,destroy:function(){n.unbind(),Qt(e.element())},add:f,remove:s,getByUid:g,getByDom:p,addToWorld:t,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Sh=ki("readonly-mode"),Oh=ki("edit-mode");function Th(n){var t=zm(gm.sketch({dom:{classes:[ki("outer-container")].concat(n.classes)},containerBehaviours:uo([mo.config({alpha:Sh,omega:Oh})])}));return wh(t)}function kh(n,t){var e=Pt.fromTag("input");ei(e,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),Jt(n,e),ho(e),t(e),Qt(e)}function Eh(n){var t=n.getSelection();if(0<t.rangeCount){var e=t.getRangeAt(0),r=n.document.createRange();r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(r)}}function Ch(n,t){yo().each(function(n){nn(n,t)||vo(n)}),n.focus(),ho(Pt.fromDom(n.document.body)),Eh(n)}function _h(n,t,e,r){function o(){Ch(t,r)}var i=em(e,"keydown",function(n){T(["input","textarea"],X(n.target()))||o()});return{toReading:function(){kh(n,vo)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}}function Dh(t,r,e,o,n){function i(){r.run(function(n){n.refreshSelection()})}function u(n,t){var e=n-o.dom().scrollTop;r.run(function(n){n.scrollIntoView(e,e+t)})}function c(){r.run(function(n){n.clearSelection()})}function a(){t.getCursorBox().each(function(n){u(n.top(),n.height())}),r.run(function(n){n.syncHeight()})}var f=_g(t),s=ap(a,300),l=[t.onKeyup(function(){c(),s.throttle()}),t.onNodeChanged(i),t.onDomChanged(s.throttle),t.onDomChanged(i),t.onScrollToCursor(function(n){n.preventDefault(),s.throttle()}),t.onScrollToElement(function(n){n.element(),u(r,o)}),t.onToEditing(function(){r.run(function(n){n.toEditing()})}),t.onToReading(function(){r.run(function(n){n.toReading()})}),em(t.doc(),"touchend",function(n){nn(t.html(),n.target())||nn(t.body(),n.target())}),em(e,"transitionend",function(n){"height"===n.raw().propertyName&&function(){var t=Ri(e);r.run(function(n){n.setViewportOffset(t)}),i(),a()}()}),rm(e,"touchstart",function(n){r.run(function(n){n.highlightSelection()}),function(t){r.run(function(n){n.onToolbarTouch(t)})}(n),t.onTouchToolstrip()}),em(t.body(),"touchstart",function(n){c(),t.onTouchContent(),f.fireTouchstart(n)}),f.onTouchmove(),f.onTouchend(),em(t.body(),"click",function(n){n.kill()}),em(e,"touchmove",function(){t.onToolbarScrollStart()})];return{destroy:function(){k(l,function(n){n.unbind()})}}}var Mh,Ih,Fh,Rh,Bh={},Ah={exports:Bh};Mh=undefined,Ih=Bh,Fh=Ah,Rh=undefined,function(n){"object"==typeof Ih&&void 0!==Fh?Fh.exports=n():"function"==typeof Mh&&Mh.amd?Mh([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function s(i,u,c){function a(t,n){if(!u[t]){if(!i[t]){var e="function"==typeof Rh&&Rh;if(!n&&e)return e(t,!0);if(f)return f(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[t]={exports:{}};i[t][0].call(o.exports,function(n){return a(i[t][1][n]||n)},o,o.exports,s,i,u,c)}return u[t].exports}for(var f="function"==typeof Rh&&Rh,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var t=s.length;t;){for(f=s,s=[];++d<t;)f&&f[d].run();d=-1,t=s.length}f=null,l=!1,function e(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{return o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function h(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];s.push(new p(n,t)),1!==s.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,t){(function(t){function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],s(n,this)}function o(r,o){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var n=1===r._state?o.onFulfilled:o.onRejected;if(null!==n){var t;try{t=n(r._value)}catch(e){return void c(o.promise,e)}u(o.promise,t)}else(1===r._state?u:c)(o.promise,r._value)})):r._deferreds.push(o)}function u(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof i)return n._state=3,n._value=t,void a(n);if("function"==typeof e)return void s(function r(n,t){return function(){n.apply(t,arguments)}}(e,t),n)}n._state=1,n._value=t,a(n)}catch(o){c(n,o)}}function c(n,t){n._state=2,n._value=t,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var t=0,e=n._deferreds.length;t<e;t++)o(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function s(n,t){var e=!1;try{n(function(n){e||(e=!0,u(t,n))},function(n){e||(e=!0,c(t,n))})}catch(r){if(e)return;e=!0,c(t,r)}}var n,e;n=this,e=setTimeout,i.prototype["catch"]=function(n){return this.then(null,n)},i.prototype.then=function(n,t){var e=new this.constructor(r);return o(this,new f(n,t,e)),e},i.all=function(n){var a=Array.prototype.slice.call(n);return new i(function(o,i){if(0===a.length)return o([]);var u=a.length;function c(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void e.call(n,function(n){c(t,n)},i)}a[t]=n,0==--u&&o(a)}catch(r){i(r)}}for(var n=0;n<a.length;n++)c(n,a[n])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(n){n(t)})},i.reject=function(e){return new i(function(n,t){t(e)})},i.race=function(o){return new i(function(n,t){for(var e=0,r=o.length;e<r;e++)o[e].then(n,t)})},i._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,t){var r=a("process/browser.js").nextTick,e=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,t){this._id=n,this._clearFn=t}f.setTimeout=function(){return new c(e.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(e.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;0<=t&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))},f.setImmediate="function"==typeof n?n:function(n){var t=u++,e=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(e?n.apply(null,e):n.call(null),f.clearImmediate(t))}),t},f.clearImmediate="function"==typeof t?t:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});function Vh(n){g.setTimeout(function(){throw n},0)}function Nh(t,e){return N([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return function(n,t){return n?yn.some(t):yn.none()}(t<=n.width&&e<=n.height,n.keyboard)}).getOr({portrait:e/5,landscape:t/4})}function jh(n){var t=om(n).isPortrait(),e=function(n){return Nh(n.screen.width,n.screen.height)}(n),r=t?e.portrait:e.landscape;return(t?n.screen.height:n.screen.width)-n.innerHeight>r?0:r}function Hh(n,t){var e=tn(n).dom().defaultView;return Ri(n)+Ri(t)-jh(e)}function Ph(n,t,e){var r=Hh(t,e),o=Ri(t)+Ri(e)-r;Mi(n,"padding-bottom",o+"px")}function zh(n){return Mg(n,iv)}function Lh(n,t){var e=function(n){return lr(n,uv)}(n);return ov.fixed(n,e,t)}function Gh(n,t){return ov.scroller(n,t)}function Uh(n){var t=zh(n);return("true"===lr(n,cv)?Gh:Lh)(n,t)}function $h(n,t,e){var r=tn(n).dom().defaultView.innerHeight;return fr(n,av,r+"px"),r-t-e}function Wh(r,o,i,u){function n(){var n=e.innerHeight;return function(n){return Mg(n,av)}(r)<n}function t(){if(d){var n=Ri(i),t=Ri(u),e=$h(r,n,t);fr(r,iv,n+"px"),Mi(r,"height",e+"px"),Ph(o,r,u)}}var e=tn(r).dom().defaultView,c=function(n){var t=lr(n,"style");ei(n,{position:"absolute",top:"0px"}),fr(n,iv,"0px"),fr(n,uv,"top");return{restore:function(){fr(n,"style",t||""),mr(n,iv),mr(n,uv)}}}(i),a=Ri(i),f=Ri(u),s=function(n,t,e){var r=lr(e,"style");hg(e),ei(e,{position:"absolute",height:t+"px",width:"100%",top:n+"px"}),fr(e,iv,n+"px"),fr(e,cv,"true"),fr(e,uv,"top");return{restore:function(){$d(e),fr(e,"style",r||""),mr(e,iv),mr(e,cv),mr(e,uv)}}}(a,$h(r,a,f),r),l=function(n){var t=lr(n,"style");ei(n,{position:"absolute",bottom:"0px"}),fr(n,iv,"0px"),fr(n,uv,"bottom");return{restore:function(){fr(n,"style",t||""),mr(n,iv),mr(n,uv)}}}(u),d=!0;return Ph(o,r,u),{setViewportOffset:function(n){fr(r,iv,n+"px"),t()},isExpanding:n,isShrinking:m(n),refresh:t,restore:function(){d=!1,c.restore(),s.restore(),l.restore()}}}function Xh(n){var t=oi(n,"top").getOr("0");return parseInt(t,10)}function qh(n){return parseInt(n.dom().scrollTop,10)}function Yh(o,i){return ev(function(n){var t=S(qh,o);fr(o,sv,t());var e=Math.abs(i-t()),r=Math.ceil(e/10);fv.animate(t,i,r,function(n,t){Mg(o,sv)!==o.dom().scrollTop?t(o.dom().scrollTop):(o.dom().scrollTop=n,fr(o,sv,n))},function(){o.dom().scrollTop=i,fr(o,sv,i),n(i)},10)})}function Kh(n,t){var e=t+zh(n)+"px";Mi(n,"top",e)}var Jh,Qh=Ah.exports.boltExport,Zh=function(n){var e=yn.none(),t=[],r=function(n){o()?u(n):t.push(n)},o=function(){return e.isSome()},i=function(n){k(n,u)},u=function(t){e.each(function(n){g.setTimeout(function(){t(n)},0)})};return n(function(n){e=yn.some(n),i(t),t=[]}),{get:r,map:function(e){return Zh(function(t){r(function(n){t(e(n))})})},isReady:o}},nv={nu:Zh,pure:function(t){return Zh(function(n){n(t)})}},tv=function(e){function n(n){e().then(n,Vh)}return{map:function(n){return tv(function(){return e().then(n)})},bind:function(t){return tv(function(){return e().then(function(n){return t(n).toPromise()})})},anonBind:function(n){return tv(function(){return e().then(function(){return n.toPromise()})})},toLazy:function(){return nv.nu(n)},toCached:function(){var n=null;return tv(function(){return null===n&&(n=e()),n})},toPromise:e,get:n}},ev=function(n){return tv(function(){return new Qh(n)})},rv=function(n){return tv(function(){return Qh.resolve(n)})},ov=ue([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),iv="data-"+ki("position-y-fixed"),uv="data-"+ki("y-property"),cv="data-"+ki("scrolling"),av="data-"+ki("last-window-height"),fv=(Jh=null,{animate:function(r,o,n,i,t,e){function u(n){c=!0,t(n)}var c=!1;function a(n){kg.clearInterval(Jh),u(n)}kg.clearInterval(Jh),Jh=kg.setInterval(function(){var e=r();(function(n,t,e){return Math.abs(n-t)<=e?yn.none():n<t?yn.some(n+e):yn.some(n-e)})(e,o,n).fold(function(){kg.clearInterval(Jh),u(o)},function(n){if(i(n,a),!c){var t=r();(t!==n||Math.abs(t-o)>Math.abs(e-o))&&(kg.clearInterval(Jh),u(o))}})},e)}}),sv="data-"+ki("last-scroll-top");function lv(i,n){return n(function(e){var r=[],o=0;0===i.length?e([]):k(i,function(n,t){n.get(function(t){return function(n){r[t]=n,++o>=i.length&&e(r)}}(t))})})}function dv(n,t,e){var r=t+e,o=oi(n,"top").getOr(e),i=r-parseInt(o,10),u=n.dom().scrollTop+i;return function(e,r,o){return ev(function(n){var t=S(qh,e);fv.animate(t,r,15,function(n){e.dom().scrollTop=n,Mi(e,"top",Xh(e)+15+"px")},function(){e.dom().scrollTop=r,Mi(e,"top",o+"px"),n(r)},10)})}(n,u,r)}function mv(n,r){return n.fold(function(n,t,e){return function(n,t,e,r){return Mi(n,t,e+r+"px"),rv(r)}(n,t,r,e)},function(n,t){return dv(n,r,t)})}function gv(n,t){var e=function(n){var t=Vi(n,"["+iv+"]");return nt(t,Uh)}(n);return function(n){return lv(n,ev)}(nt(e,function(n){return mv(n,t)}))}function pv(t,e,n,r,o,i){var u=function f(e){var r=En(nv.pure({}));return{start:function(t){var n=nv.nu(function(n){return e(t).get(n)});r.set(n)},idle:function(n){r.get().get(function(){n()})}}}(function(n){return function(t,e,r){var o=tn(t).dom().defaultView;return ev(function(n){Kh(t,r),Kh(e,r),o.scrollTo(0,r),n(r)})}(t,e,n)}),c=ap(function(){u.idle(function(){gv(n,r.pageYOffset).get(function(){(function(){var n=Xg(i);return yn.from(n[0]).bind(function(n){var t=n.top()-e.dom().scrollTop;return t>r.innerHeight+5||t<-5?yn.some({top:b(t),bottom:b(t+n.height())}):yn.none()})})().each(function(n){e.dom().scrollTop=e.dom().scrollTop+n.top()}),u.start(0),o.refresh()})})},1e3),a=em(Pt.fromDom(r),"scroll",function(){r.pageYOffset<0||c.throttle()});return gv(n,r.pageYOffset).get(y),{unbind:a.unbind}}function hv(n){var e=n.cWin(),t=n.ceBody(),r=n.socket(),o=n.toolstrip(),i=n.toolbar(),u=n.contentElement(),c=n.keyboardType(),a=n.outerWindow(),f=n.dropup(),s=Wh(r,t,o,f),l=c(n.outerBody(),e,Wt(),u,o,i),d=im(a,{onChange:w,onReady:s.refresh});d.onAdjustment(function(){s.refresh()});var m=em(Pt.fromDom(a),"resize",function(){s.isExpanding()&&s.refresh()}),g=pv(o,r,n.outerBody(),a,s,e),p=function v(e,t){var n=e.document,r=Pt.fromTag("div");function o(n){var t=Pt.fromTag("span");return Ed(t,[ki("layer-editor"),ki("unfocused-selection")]),ei(t,{left:n.left()+"px",top:n.top()+"px",width:n.width()+"px",height:n.height()+"px"}),t}yr(r,ki("unfocused-selections")),Jt(Pt.fromDom(n.documentElement),r);var i=em(r,"touchstart",function(n){n.prevent(),Ch(e,t),u()}),u=function(){fn(r)};return{update:function(){u();var n=Xg(e),t=nt(n,o);an(r,t)},isActive:function(){return 0<Kt(r).length},destroy:function(){i.unbind(),Qt(r)},clear:u}}(e,u),h=function(){p.clear()};return{toEditing:function(){l.toEditing(),h()},toReading:function(){l.toReading()},onToolbarTouch:function(n){l.onToolbarTouch(n)},refreshSelection:function(){p.isActive()&&p.update()},clearSelection:h,highlightSelection:function(){p.update()},scrollIntoView:function(n,t){!function(n,t,e,r,o){var i=Hh(t,e),u=S(Eh,n);i<r||i<o?Yh(t,t.dom().scrollTop-i+o).get(u):r<0&&Yh(t,t.dom().scrollTop+r).get(u)}(e,r,f,n,t)},updateToolbarPadding:w,setViewportOffset:function(n){s.setViewportOffset(n),function(i,u){return ev(function(n){function t(n){Mi(i,"top",n+"px")}var e=S(Xh,i),r=Math.abs(u-e()),o=Math.ceil(r/10);fv.animate(e,u,o,t,function(){t(u),n(u)},10)})}(r,n).get(y)},syncHeight:function(){Mi(u,"height",u.dom().contentWindow.document.body.scrollHeight+"px")},refreshStructure:s.refresh,destroy:function(){s.restore(),d.destroy(),g.unbind(),m.unbind(),l.destroy(),p.destroy(),kh(Wt(),vo)}}}function vv(r,n){var o=cp(),i=gd(),u=gd(),c=md(),a=md();return{enter:function(){n.hide();var e=Pt.fromDom(g.document);op(r.editor).each(function(n){i.set({socketHeight:oi(r.socket,"height"),iframeHeight:oi(n.frame(),"height"),outerScroll:g.document.body.scrollTop}),u.set({exclusives:function(n,t){return em(n,"touchmove",function(n){Pi(n.target(),t).filter(lp).fold(function(){n.raw().preventDefault()},w)})}(e,"."+vg)}),yr(r.container,ki("fullscreen-maximized")),ip(r.container,n.body()),o.maximize(),Mi(r.socket,"overflow","scroll"),Mi(r.socket,"-webkit-overflow-scrolling","touch"),ho(n.body());var t=Wu(["cWin","ceBody","socket","toolstrip","toolbar","dropup","contentElement","cursor","keyboardType","isScrolling","outerWindow","outerBody"],[]);c.set(hv(t({cWin:n.win(),ceBody:n.body(),socket:r.socket,toolstrip:r.toolstrip,toolbar:r.toolbar,dropup:r.dropup.element(),contentElement:n.frame(),cursor:w,outerBody:r.body,outerWindow:r.win,keyboardType:_h,isScrolling:function(){return u.get().exists(function(n){return n.socket.isScrolling()})}}))),c.run(function(n){n.syncHeight()}),a.set(Dh(n,c,r.toolstrip,r.socket,r.dropup))})},refreshStructure:function(){c.run(function(n){n.refreshStructure()})},exit:function(){o.restore(),a.clear(),c.clear(),n.show(),i.on(function(n){n.socketHeight.each(function(n){Mi(r.socket,"height",n)}),n.iframeHeight.each(function(n){Mi(r.editor.getFrame(),"height",n)}),g.document.body.scrollTop=n.scrollTop}),i.clear(),u.on(function(n){n.exclusives.unbind()}),u.clear(),xr(r.container,ki("fullscreen-maximized")),up(),$d(r.toolbar),ii(r.socket,"overflow"),ii(r.socket,"-webkit-overflow-scrolling"),vo(r.editor.getFrame()),op(r.editor).each(function(n){n.clearSelection()})}}}function yv(n){var t=Th({classes:[ki("ios-container")]}),e=Np(),r=md(),o=jp(r),i=Hp(),u=th(function(){r.run(function(n){n.refreshStructure()})},n);t.add(e.wrapper()),t.add(i),t.add(u.component());return{system:b(t),element:t.element,init:function(n){r.set(function(n){var t=Be("Getting IosWebapp schema",_p,n);Mi(t.toolstrip,"width","100%"),Mi(t.container,"position","relative");var e=zm(fp(function(){t.setReadOnly(t.readOnlyOnInit()),o.enter()},t.translate));t.alloy.add(e);var r={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}},o=vv(t,r);return{setReadOnly:t.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:w}}(n))},exit:function(){r.run(function(n){rg.remove(i,o),n.exit()})},setToolbarGroups:function(n){var t=e.createGroups(n);e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n);e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){Lp(i,o,n,t.root())},socket:b(i),dropup:b(u)}}function bv(n,t,e){n.system().broadcastOn([Do],{command:t,state:e})}function xv(n){function t(){n._skinLoaded=!0,n.fire("SkinLoaded")}return function(){n.initialized?t():n.on("init",t)}}function wv(m){return{getNotificationManagerImpl:function(){return{open:b({progressBar:{value:w},close:w,text:w,getEl:b(null),moveTo:w,moveRel:w,settings:{}}),close:w,reposition:w,getArgs:b({})}},renderUI:function(){var n=m.getElement(),t=function(n){var t=Tn(n.settings,"skin_url").fold(function(){return Sv.baseURL+"/skins/ui/oxide"},function(n){return n});return{content:t+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"}}(m);!1===function(n){return!1===n.settings.skin}(m)?(m.contentCSS.push(t.content),Co.DOM.styleSheetLoader.load(t.ui,xv(m))):xv(m)();function e(){m.fire("ScrollIntoView")}var f=z().os.isAndroid()?function c(n){var t=Th({classes:[ki("android-container")]}),e=Np(),r=md(),o=jp(r),i=Hp(),u=th(w,n);return t.add(e.wrapper()),t.add(i),t.add(u.component()),{system:b(t),element:t.element,init:function(n){r.set(sp(n))},exit:function(){r.run(function(n){n.exit(),rg.remove(i,o)})},setToolbarGroups:function(n){var t=e.createGroups(n);e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n);e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){Lp(i,o,n,t.root())},socket:b(i),dropup:b(u)}}(e):yv(e);!function(n,t){ee(n,t,un)}(Pt.fromDom(n),f.system());function s(n,t,e,r){!1===r&&m.selection.collapse();var o=i(n,t,e);f.setToolbarGroups(!0===r?o.readOnly:o.main),m.setMode(!0===r?"readonly":"design"),m.fire(!0===r?Ov:Tv),f.updateMode(r)}function l(n,t){return m.on(n,t),{unbind:function(){m.off(n)}}}var r=n.ownerDocument.defaultView,d=im(r,{onChange:function(){f.system().broadcastOn([Mo],{width:function(n){var t=z().os.isiOS(),e=om(n).isPortrait();return t&&!e?n.screen.height:n.screen.width}(r)})},onReady:w}),i=function(n,t,e){var r=n.get();return{readOnly:r.backToMask.concat(t.get()),main:r.backToMask.concat(e.get())}};return m.on("init",function(){f.init({editor:{getFrame:function(){return Pt.fromDom(m.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:w}},onToReading:function(n){return l(Ov,n)},onToEditing:function(n){return l(Tv,n)},onScrollToCursor:function(t){m.on("ScrollIntoView",function(n){t(n)});return{unbind:function(){m.off("ScrollIntoView"),d.destroy()}}},onTouchToolstrip:function(){n()},onTouchContent:function(){(function(n){return bo(n).bind(function(n){return f.system().getByDom(n).toOption()})})(Pt.fromDom(m.editorContainer.querySelector("."+ki("toolbar")))).each(U),f.restoreToolbar(),n()},onTapContent:function(n){var t=n.target();if("img"===X(t))m.selection.select(t.dom()),n.kill();else if("a"===X(t)){f.system().getByDom(Pt.fromDom(m.editorContainer)).each(function(n){mo.isAlpha(n)&&function(n){var t=g.document.createElement("a");t.target="_blank",t.href=n.href,t.rel="noreferrer noopener";var e=g.document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,g.window,0,0,0,0,0,!1,!1,!1,!1,0,null),g.document.body.appendChild(t),t.dispatchEvent(e),g.document.body.removeChild(t)}(t.dom())})}}},container:Pt.fromDom(m.editorContainer),socket:Pt.fromDom(m.contentAreaContainer),toolstrip:Pt.fromDom(m.editorContainer.querySelector("."+ki("toolstrip"))),toolbar:Pt.fromDom(m.editorContainer.querySelector("."+ki("toolbar"))),dropup:f.dropup(),alloy:f.system(),translate:w,setReadOnly:function(n){s(a,c,u,n)},readOnlyOnInit:function(){return!1}});var n=function(){f.dropup().disappear(function(){f.system().broadcastOn([Io],{})})},t={label:"The first group",scrollable:!1,items:[Ls("back",function(){m.selection.collapse(),f.exit()},{},m)]},e={label:"Back to read only",scrollable:!1,items:[Ls("readonly-back",function(){s(a,c,u,!0)},{},m)]},r=Qd(f,m),o=Zd(m.settings,r),i={label:"The extra group",scrollable:!1,items:[]},u=En([{label:"the action group",scrollable:!0,items:o},i]),c=En([{label:"The read only mode group",scrollable:!0,items:[]},i]),a=En({backToMask:[t],backToReadOnly:[e]});!function(r,n){var t=bn(n.formatter.get());k(t,function(t){n.formatter.formatChanged(t,function(n){bv(r,t,n)})}),k(["ul","ol"],function(e){n.selection.selectorChanged(e,function(n,t){bv(r,e,n)})})}(f,m)}),m.on("remove",function(){f.exit()}),m.on("detach",function(){!function(t){var n=Kt(t.element());k(n,function(n){t.getByDom(n).each(Zt)}),Qt(t.element())}(f.system()),f.system().destroy()}),{iframeContainer:f.socket().element().dom(),editorContainer:f.element().dom()}}}}var Sv=tinymce.util.Tools.resolve("tinymce.EditorManager"),Ov="toReading",Tv="toEditing";!function Ev(){_o.add("mobile",wv)}()}(window);