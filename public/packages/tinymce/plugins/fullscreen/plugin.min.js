/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.3.0 (TBD)
 */
!function(d){"use strict";function r(n){return{isFullscreen:function(){return null!==n.get()}}}function t(){}function m(n){return function(){return n}}function n(){return s}var u=function(n){function e(){return r}var r=n;return{get:e,set:function(n){r=n},clone:function(){return u(e())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=m(!1),i=m(!0),s={fold:function(n,e){return n()},is:c,isSome:c,isNone:i,getOr:a,getOrThunk:f,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(undefined),or:a,orThunk:f,map:n,each:t,bind:n,exists:c,forall:i,filter:n,equals:o,equals_:o,toArray:function(){return[]},toString:m("none()")};function o(n){return n.isNone()}function f(n){return n()}function a(n){return n}function l(){return function(n){function e(){r.get().each(n)}var r=u(G.none());return{clear:function(){e(),r.set(G.none())},isSet:function(){return r.get().isSome()},set:function(n){e(),r.set(G.some(n))}}}(function(n){n.unbind()})}function h(e){return function(n){return function(n){var e=typeof n;return null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}}function v(e){return function(n){return typeof n===e}}function g(n,e){for(var r=n.length,t=new Array(r),o=0;o<r;o++){var i=n[o];t[o]=e(i,o)}return t}function p(n,e){for(var r=0,t=n.length;r<t;r++){e(n[r],r)}}function w(n,e){for(var r=[],t=0,o=n.length;t<o;t++){var i=n[t];e(i,t)&&r.push(i)}return r}function S(n,e){return function(n){for(var e=[],r=0,t=n.length;r<t;++r){if(!K(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);nn.apply(e,n[r])}return e}(g(n,e))}function y(n,e){return-1!==n.indexOf(e)}function O(n){return n.style!==undefined&&Q(n.style.getPropertyValue)}function E(n,e,r){!function(n,e,r){if(!($(r)||J(r)||Z(r)))throw d.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}(n.dom(),e,r)}function x(n,e){var r=n.dom().getAttribute(e);return null===r?undefined:r}function T(n,e){n.dom().removeAttribute(e)}function N(n,e){var r=n.dom();!function(n,e){for(var r=en(n),t=0,o=r.length;t<o;t++){var i=r[t];e(n[i],i)}}(e,function(n,e){!function(n,e,r){if(!$(r))throw d.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);O(n)&&n.style.setProperty(e,r)}(r,e,n)})}function b(n,e){var r=n.dom(),t=d.window.getComputedStyle(r).getPropertyValue(e),o=""!==t||function(n){var e=sn(n)?n.dom().parentNode:n.dom();return e!==undefined&&null!==e&&e.ownerDocument.body.contains(e)}(n)?t:fn(r,e);return null===o?undefined:o}function C(n){function e(){n.stopPropagation()}function r(){n.preventDefault()}var t=tn.fromDom(n.target),o=function(r,t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(t.apply(null,n))}}(r,e);return function(n,e,r,t,o,i,u){return{target:m(n),x:m(e),y:m(r),stop:t,prevent:o,kill:i,raw:m(u)}}(t,n.clientX,n.clientY,e,r,o,n)}function D(n,e){var r=function(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t.test(e))return t}return undefined}(n,e);if(!r)return{major:0,minor:0};function t(n){return Number(e.replace(r,"$"+n))}return ln(t(1),t(2))}function A(n,e){var r=String(e).toLowerCase();return function(n,e){for(var r=0,t=n.length;r<t;r++){var o=n[r];if(e(o,r))return G.some(o)}return G.none()}(n,function(n){return n.search(r)})}function k(e){return function(n){return y(n,e)}}function M(){return An.get()}function F(n,e){var r=n.dom();if(r.nodeType!==kn)return!1;var t=r;if(t.matches!==undefined)return t.matches(e);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(e);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(e);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function _(n,e){var r=e===undefined?d.document:e.dom();return function(n){return n.nodeType!==kn&&n.nodeType!==Mn||0===n.childElementCount}(r)?[]:g(r.querySelectorAll(n),tn.fromDom)}function R(e){return function(n){return G.from(n.dom().parentNode).map(tn.fromDom)}(e).map(Fn).map(function(n){return w(n,function(n){return!function(n,e){return n.dom()===e.dom()}(e,n)})}).getOr([])}function L(n){var e=n===undefined?d.window:n;return G.from(e.visualViewport)}function P(n,e,r,t){return{x:m(n),y:m(e),width:m(r),height:m(t),right:m(n+r),bottom:m(e+t)}}function I(n){var t=n===undefined?d.window:n,e=t.document,o=function(n){var e=n!==undefined?n.dom():d.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,t=e.body.scrollTop||e.documentElement.scrollTop;return Rn(r,t)}(tn.fromDom(e));return L(t).fold(function(){var n=t.document.documentElement,e=n.clientWidth,r=n.clientHeight;return P(o.left(),o.top(),e,r)},function(n){return P(Math.max(n.pageLeft,o.left()),Math.max(n.pageTop,o.top()),n.width,n.height)})}function H(r,n,e){return L(e).map(function(n){function e(n){return C(n)}return n.addEventListener(r,e),{unbind:function(){return n.removeEventListener(r,e)}}}).getOrThunk(function(){return{unbind:t}})}function W(n,e){n.fire("FullscreenStateChanged",{state:e})}function U(n,e,r){return w(function(n,e){for(var r=Q(e)?e:c,t=n.dom(),o=[];null!==t.parentNode&&t.parentNode!==undefined;){var i=t.parentNode,u=tn.fromDom(i);if(o.push(u),!0===r(u))break;t=i}return o}(n,r),e)}function B(n,e){return function(n,e){return w(R(n),e)}(n,function(n){return F(n,e)})}function V(o,n,e){function r(t){return function(n){var e=x(n,"style"),r=e===undefined?"no-styles":e.trim();r!==t&&(E(n,Hn,r),N(n,o.parseStyle(t)))}}var t=function(n,e,r){return U(n,function(n){return F(n,e)},r)}(n,"*"),i=S(t,function(n){return B(n,"*:not(.tox-silver-sink)")}),u=function(n){var e=b(n,"background-color");return e!==undefined&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"}(e);p(i,r("display:none!important;")),p(t,r(Wn+Un+u)),r((!0===Bn?"":Wn)+Un+u)(n)}function q(r){var n=function(n){return _(n)}("["+Hn+"]");p(n,function(n){var e=x(n,Hn);"no-styles"!==e?N(n,r.parseStyle(e)):T(n,"style"),T(n,Hn)})}function X(n,e){var r,t,o,i=d.document.body,u=d.document.documentElement;t=n.getContainer();var c=tn.fromDom(t),s=e.get(),f=tn.fromDom(n.getBody()),a=Pn.deviceType.isTouch();if(r=t.style,o=n.getContentAreaContainer().firstChild.style,s)o.width=s.iframeWidth,o.height=s.iframeHeight,r.width=s.containerWidth,r.height=s.containerHeight,r.top=s.containerTop,r.left=s.containerLeft,a&&q(n.dom),Vn.removeClass(i,"tox-fullscreen"),Vn.removeClass(u,"tox-fullscreen"),Vn.removeClass(t,"tox-fullscreen"),function(n){d.window.scrollTo(n.x,n.y)}(s.scrollPos),e.set(null),W(n,!1),qn.unbind(),n.off("remove",qn.unbind);else{var l={scrollPos:function(){var n=I(d.window);return{x:n.x(),y:n.y()}}(),containerWidth:r.width,containerHeight:r.height,containerTop:r.top,containerLeft:r.left,iframeWidth:o.width,iframeHeight:o.height};a&&V(n.dom,c,f),o.width=o.height="100%",r.width=r.height="",Vn.addClass(i,"tox-fullscreen"),Vn.addClass(u,"tox-fullscreen"),Vn.addClass(t,"tox-fullscreen"),qn.bind(c),n.on("remove",qn.unbind),e.set(l),W(n,!0)}}function j(r,t){return function(e){e.setActive(null!==t.get());function n(n){return e.setActive(n.state)}return r.on("FullscreenStateChanged",n),function(){return r.off("FullscreenStateChanged",n)}}}var Y,z=function(r){function n(){return o}function e(n){return n(r)}var t=m(r),o={fold:function(n,e){return e(r)},is:function(n){return r===n},isSome:i,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(n){return z(n(r))},each:function(n){n(r)},bind:e,exists:e,forall:e,filter:function(n){return n(r)?o:s},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(n){return n.is(r)},equals_:function(n,e){return n.fold(c,function(n){return e(r,n)})}};return o},G={some:z,none:n,from:function(n){return null===n||n===undefined?s:z(n)}},$=h("string"),K=h("array"),J=v("boolean"),Q=v("function"),Z=v("number"),nn=Array.prototype.push,en=Object.keys,rn=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:m(n)}},tn={fromHtml:function(n,e){var r=(e||d.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw d.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return rn(r.childNodes[0])},fromTag:function(n,e){var r=(e||d.document).createElement(n);return rn(r)},fromText:function(n,e){var r=(e||d.document).createTextNode(n);return rn(r)},fromDom:rn,fromPoint:function(n,e,r){var t=n.dom();return G.from(t.elementFromPoint(e,r)).map(rn)}},on=(d.Node.ATTRIBUTE_NODE,d.Node.CDATA_SECTION_NODE,d.Node.COMMENT_NODE,d.Node.DOCUMENT_NODE),un=(d.Node.DOCUMENT_TYPE_NODE,d.Node.DOCUMENT_FRAGMENT_NODE,d.Node.ELEMENT_NODE),cn=d.Node.TEXT_NODE,sn=(d.Node.PROCESSING_INSTRUCTION_NODE,d.Node.ENTITY_REFERENCE_NODE,d.Node.ENTITY_NODE,d.Node.NOTATION_NODE,"undefined"!=typeof d.window?d.window:Function("return this;")(),Y=cn,function(n){return function(n){return n.dom().nodeType}(n)===Y}),fn=function(n,e){return O(n)?n.style.getPropertyValue(e):""},an=function(){return ln(0,0)},ln=function(n,e){return{major:n,minor:e}},dn={nu:ln,detect:function(n,e){var r=String(e).toLowerCase();return 0===n.length?an():D(n,r)},unknown:an},mn="Firefox",hn=function(n){function e(n){return function(){return r===n}}var r=n.current,t=n.version;return{current:r,version:t,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(mn),isSafari:e("Safari")}},vn={unknown:function(){return hn({current:undefined,version:dn.unknown()})},nu:hn,edge:m("Edge"),chrome:m("Chrome"),ie:m("IE"),opera:m("Opera"),firefox:m(mn),safari:m("Safari")},gn="Windows",pn="Android",wn="Solaris",Sn="FreeBSD",yn="ChromeOS",On=function(n){function e(n){return function(){return r===n}}var r=n.current,t=n.version;return{current:r,version:t,isWindows:e(gn),isiOS:e("iOS"),isAndroid:e(pn),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(wn),isFreeBSD:e(Sn),isChromeOS:e(yn)}},En={unknown:function(){return On({current:undefined,version:dn.unknown()})},nu:On,windows:m(gn),ios:m("iOS"),android:m(pn),linux:m("Linux"),osx:m("OSX"),solaris:m(wn),freebsd:m(Sn),chromeos:m(yn)},xn=function(n,r){return A(n,r).map(function(n){var e=dn.detect(n.versionRegexes,r);return{current:n.name,version:e}})},Tn=function(n,r){return A(n,r).map(function(n){var e=dn.detect(n.versionRegexes,r);return{current:n.name,version:e}})},Nn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,bn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return y(n,"edge/")&&y(n,"chrome")&&y(n,"safari")&&y(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Nn],search:function(n){return y(n,"chrome")&&!y(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return y(n,"msie")||y(n,"trident")}},{name:"Opera",versionRegexes:[Nn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:k("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:k("firefox")},{name:"Safari",versionRegexes:[Nn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(y(n,"safari")||y(n,"mobile/"))&&y(n,"applewebkit")}}],Cn=[{name:"Windows",search:k("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return y(n,"iphone")||y(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:k("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:k("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:k("linux"),versionRegexes:[]},{name:"Solaris",search:k("sunos"),versionRegexes:[]},{name:"FreeBSD",search:k("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:k("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Dn={browsers:m(bn),oses:m(Cn)},An=u(function(n,e){var r=Dn.browsers(),t=Dn.oses(),o=xn(r,n).fold(vn.unknown,vn.nu),i=Tn(t,n).fold(En.unknown,En.nu);return{browser:o,os:i,deviceType:function(n,e,r,t){var o=n.isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||t("(pointer:coarse)"),s=o||!i&&u&&t("(min-device-width:768px)"),f=i||u&&!s,a=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),l=!f&&!s&&!a;return{isiPad:m(o),isiPhone:m(i),isTablet:m(s),isPhone:m(f),isTouch:m(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:m(a),isDesktop:m(l)}}(i,o,n,e)}}(d.navigator.userAgent,function(n){return d.window.matchMedia(n).matches})),kn=un,Mn=on,Fn=(M().browser.isIE(),function(n){return g(n.dom().childNodes,tn.fromDom)}),_n=function(r,t){return{left:m(r),top:m(t),translate:function(n,e){return _n(r+n,t+e)}}},Rn=_n,Ln=(M().browser.isSafari(),tinymce.util.Tools.resolve("tinymce.dom.DOMUtils")),Pn=tinymce.util.Tools.resolve("tinymce.Env"),In=tinymce.util.Tools.resolve("tinymce.util.Delay"),Hn="data-ephox-mobile-fullscreen-style",Wn="position:absolute!important;",Un="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Bn=Pn.os.isAndroid(),Vn=Ln.DOM,qn=L().fold(function(){return{bind:t,unbind:t}},function(e){var r=function(){var e=u(G.none());return{clear:function(){e.set(G.none())},set:function(n){e.set(G.some(n))},isSet:function(){return e.get().isSome()},on:function(n){e.get().each(n)}}}(),t=l(),o=l(),i=In.throttle(function(){d.document.body.scrollTop=0,d.document.documentElement.scrollTop=0,d.window.requestAnimationFrame(function(){r.on(function(n){return N(n,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(n){r.set(n),i(),t.set(H("resize")),o.set(H("scroll"))},unbind:function(){r.on(function(){t.clear(),o.clear()}),r.clear()}}});!function Xn(){e.add("fullscreen",function(n){var e=u(null);return n.settings.inline||(function(n,e){n.addCommand("mceFullScreen",function(){X(n,e)})}(n,e),function(n,e){n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:j(n,e)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:j(n,e)})}(n,e),n.addShortcut("Meta+Shift+F","","mceFullScreen")),r(e)})}()}(window);