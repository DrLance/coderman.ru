/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.3.0 (TBD)
 */
!function(l){"use strict";function d(n){return function(){return n}}function o(n){return n}var x=function(n){function t(){return e}var e=n;return{get:t,set:function(n){e=n},clone:function(){return x(t())}}},C=function(){};function b(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=o.concat(n);return r.apply(null,e)}}function m(t){return function(n){return!t(n)}}function n(){return i}var s=d(!1),u=d(!0),i={fold:function(n,t){return n()},is:s,isSome:s,isNone:u,getOr:r,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(undefined),or:r,orThunk:e,map:n,each:C,bind:n,exists:s,forall:u,filter:n,equals:t,equals_:t,toArray:function(){return[]},toString:d("none()")};function t(n){return n.isNone()}function e(n){return n()}function r(n){return n}function c(t){return function(n){return function(n){var t=typeof n;return null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(n)===t}}function a(t){return function(n){return typeof n===t}}function f(n,t){return-1<function(n,t){return zn.call(n,t)}(n,t)}function g(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return!0}return!1}function p(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r}function h(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}}function v(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e}function w(n,t,e){return function(n,t){for(var e=n.length-1;0<=e;e--){t(n[e],e)}}(n,function(n){e=t(e,n)}),e}function y(n,t,e){return h(n,function(n){e=t(e,n)}),e}function S(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return In.some(o)}return In.none()}function R(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return In.some(e)}return In.none()}function T(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!Pn(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);Ln.apply(t,n[e])}return t}function O(n,t){return T(p(n,t))}function D(n,t){for(var e=0,r=n.length;e<r;++e){if(!0!==t(n[e],e))return!1}return!0}function A(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return In.none()}function N(n,t){for(var e=Fn(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}}function E(n,e){return Hn(n,function(n,t){return{k:t,v:e(n,t)}})}function I(n,t){return qn(n,t)?In.from(n[t]):In.none()}function B(n){return n.dom().nodeType}function k(t){return function(n){return B(n)===t}}function P(n){return B(n)===Vn||"#comment"===Xn(n)}function M(n,t,e){if(!(kn(e)||Mn(e)||jn(e)))throw l.console.error("Invalid call to Attr.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}function _(n,t,e){M(n.dom(),t,e)}function j(n,t){var e=n.dom();N(t,function(n,t){M(e,t,n)})}function W(n,t){var e=n.dom().getAttribute(t);return null===e?undefined:e}function z(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)}function L(n,t){n.dom().removeAttribute(t)}function F(n){return y(n.dom().attributes,function(n,t){return n[t.name]=t.value,n},{})}function U(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}function H(n,t){return-1!==n.indexOf(t)}function q(n,t){return U(n,t,0)}function V(n){return n.style!==undefined&&_n(n.style.getPropertyValue)}function Y(e){var r,o=!1;return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return o||(o=!0,r=e.apply(null,n)),r}}function K(n){var t=Jn(n)?n.dom().parentNode:n.dom();return t!==undefined&&null!==t&&t.ownerDocument.body.contains(t)}function G(n,t,e){if(!kn(e))throw l.console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);V(n)&&n.style.setProperty(t,e)}function X(n,t,e){var r=n.dom();G(r,t,e)}function $(n,t){var e=n.dom();N(t,function(n,t){G(e,t,n)})}function J(n,t){var e=n.dom(),r=l.window.getComputedStyle(e).getPropertyValue(t),o=""!==r||K(n)?r:rt(e,t);return null===o?undefined:o}function Q(n,t){var e=n.dom(),r=rt(e,t);return In.from(r).filter(function(n){return 0<n.length})}function Z(n,t){!function(n,t){V(n)&&n.style.removeProperty(t)}(n.dom(),t),z(n,"style")&&""===Qn(W(n,"style"))&&L(n,"style")}function nn(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}return undefined}(n,t);if(!e)return{major:0,minor:0};function r(n){return Number(t.replace(e,"$"+n))}return it(r(1),r(2))}function tn(n,t){var e=String(t).toLowerCase();return S(n,function(n){return n.search(e)})}function en(t){return function(n){return H(n,t)}}function rn(){return Rt.get()}function on(n,t){var e=n.dom();if(e.nodeType!==Tt)return!1;var r=e;if(r.matches!==undefined)return r.matches(t);if(r.msMatchesSelector!==undefined)return r.msMatchesSelector(t);if(r.webkitMatchesSelector!==undefined)return r.webkitMatchesSelector(t);if(r.mozMatchesSelector!==undefined)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function un(n){return n.nodeType!==Tt&&n.nodeType!==Ot||0===n.childElementCount}function cn(n){return nt.fromDom(n.dom().ownerDocument)}function an(n){return In.from(n.dom().parentNode).map(nt.fromDom)}function fn(n,t){for(var e=_n(t)?t:s,r=n.dom(),o=[];null!==r.parentNode&&r.parentNode!==undefined;){var u=r.parentNode,i=nt.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o}function ln(n){return In.from(n.dom().previousSibling).map(nt.fromDom)}function sn(n){return In.from(n.dom().nextSibling).map(nt.fromDom)}function dn(n){return p(n.dom().childNodes,nt.fromDom)}function mn(n,t){var e=n.dom().childNodes;return In.from(e[t]).map(nt.fromDom)}function gn(t,e){an(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})}function pn(n,t){sn(n).fold(function(){an(n).each(function(n){Et(n,t)})},function(n){gn(n,t)})}function hn(t,e){(function(n){return mn(n,0)})(t).fold(function(){Et(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})}function vn(n,t){gn(n,t),Et(t,n)}function bn(r,o){h(o,function(n,t){var e=0===t?r:o[t-1];pn(e,n)})}function wn(t,n){h(n,function(n){Et(t,n)})}function yn(n){n.dom().textContent="",h(dn(n),function(n){It(n)})}function Sn(n){var t=dn(n);0<t.length&&function(t,n){h(n,function(n){gn(t,n)})}(n,t),It(n)}function xn(n,t,e){return{element:d(n),rowspan:d(t),colspan:d(e)}}function Cn(n,t,e){return{element:d(n),cells:d(t),section:d(e)}}function Rn(n,t){return{element:d(n),isNew:d(t)}}function Tn(n,t){return{cells:d(n),section:d(t)}}function On(n,t,e){return function(n,t,e){return v(fn(n,e),t)}(n,function(n){return on(n,t)},e)}function Dn(n,t){return function(n,t){return v(dn(n),t)}(n,function(n){return on(n,t)})}function An(n,t){return function(n,t){var e=t===undefined?l.document:t.dom();return un(e)?[]:p(e.querySelectorAll(n),nt.fromDom)}(t,n)}var Nn,En=function(e){function n(){return o}function t(n){return n(e)}var r=d(e),o={fold:function(n,t){return t(e)},is:function(n){return e===n},isSome:u,isNone:s,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return En(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?o:i},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,t){return n.fold(s,function(n){return t(e,n)})}};return o},In={some:En,none:n,from:function(n){return null===n||n===undefined?i:En(n)}},Bn=tinymce.util.Tools.resolve("tinymce.PluginManager"),kn=c("string"),Pn=c("array"),Mn=a("boolean"),_n=a("function"),jn=a("number"),Wn=Array.prototype.slice,zn=Array.prototype.indexOf,Ln=Array.prototype.push,Fn=Object.keys,Un=Object.hasOwnProperty,Hn=function(n,r){var o={};return N(n,function(n,t){var e=r(n,t);o[e.k]=e.v}),o},qn=function(n,t){return Un.call(n,t)},Vn=(l.Node.ATTRIBUTE_NODE,l.Node.CDATA_SECTION_NODE,l.Node.COMMENT_NODE),Yn=l.Node.DOCUMENT_NODE,Kn=(l.Node.DOCUMENT_TYPE_NODE,l.Node.DOCUMENT_FRAGMENT_NODE,l.Node.ELEMENT_NODE),Gn=l.Node.TEXT_NODE,Xn=(l.Node.PROCESSING_INSTRUCTION_NODE,l.Node.ENTITY_REFERENCE_NODE,l.Node.ENTITY_NODE,l.Node.NOTATION_NODE,"undefined"!=typeof l.window?l.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),$n=k(Kn),Jn=k(Gn),Qn=(Nn=/^\s+|\s+$/g,function(n){return n.replace(Nn,"")}),Zn=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:d(n)}},nt={fromHtml:function(n,t){var e=(t||l.document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw l.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Zn(e.childNodes[0])},fromTag:function(n,t){var e=(t||l.document).createElement(n);return Zn(e)},fromText:function(n,t){var e=(t||l.document).createTextNode(n);return Zn(e)},fromDom:Zn,fromPoint:function(n,t,e){var r=n.dom();return In.from(r.elementFromPoint(t,e)).map(Zn)}},tt=Y(function(){return et(nt.fromDom(l.document))}),et=function(n){var t=n.dom().body;if(null===t||t===undefined)throw new Error("Body is not available yet");return nt.fromDom(t)},rt=function(n,t){return V(n)?n.style.getPropertyValue(t):""},ot=function(){return(ot=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},ut=function(){return it(0,0)},it=function(n,t){return{major:n,minor:t}},ct={nu:it,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?ut():nn(n,e)},unknown:ut},at="Firefox",ft=function(n){function t(n){return function(){return e===n}}var e=n.current,r=n.version;return{current:e,version:r,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t(at),isSafari:t("Safari")}},lt={unknown:function(){return ft({current:undefined,version:ct.unknown()})},nu:ft,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d(at),safari:d("Safari")},st="Windows",dt="Android",mt="Solaris",gt="FreeBSD",pt="ChromeOS",ht=function(n){function t(n){return function(){return e===n}}var e=n.current,r=n.version;return{current:e,version:r,isWindows:t(st),isiOS:t("iOS"),isAndroid:t(dt),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t(mt),isFreeBSD:t(gt),isChromeOS:t(pt)}},vt={unknown:function(){return ht({current:undefined,version:ct.unknown()})},nu:ht,windows:d(st),ios:d("iOS"),android:d(dt),linux:d("Linux"),osx:d("OSX"),solaris:d(mt),freebsd:d(gt),chromeos:d(pt)},bt=function(n,e){return tn(n,e).map(function(n){var t=ct.detect(n.versionRegexes,e);return{current:n.name,version:t}})},wt=function(n,e){return tn(n,e).map(function(n){var t=ct.detect(n.versionRegexes,e);return{current:n.name,version:t}})},yt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,St=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return H(n,"edge/")&&H(n,"chrome")&&H(n,"safari")&&H(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,yt],search:function(n){return H(n,"chrome")&&!H(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return H(n,"msie")||H(n,"trident")}},{name:"Opera",versionRegexes:[yt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:en("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:en("firefox")},{name:"Safari",versionRegexes:[yt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(H(n,"safari")||H(n,"mobile/"))&&H(n,"applewebkit")}}],xt=[{name:"Windows",search:en("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return H(n,"iphone")||H(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:en("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:en("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:en("linux"),versionRegexes:[]},{name:"Solaris",search:en("sunos"),versionRegexes:[]},{name:"FreeBSD",search:en("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:en("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ct={browsers:d(St),oses:d(xt)},Rt=x(function(n,t){var e=Ct.browsers(),r=Ct.oses(),o=bt(e,n).fold(lt.unknown,lt.nu),u=wt(r,n).fold(vt.unknown,vt.nu);return{browser:o,os:u,deviceType:function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!o,i=n.isiOS()||n.isAndroid(),c=i||r("(pointer:coarse)"),a=o||!u&&i&&r("(min-device-width:768px)"),f=u||i&&!a,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),s=!f&&!a&&!l;return{isiPad:d(o),isiPhone:d(u),isTablet:d(a),isPhone:d(f),isTouch:d(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:d(l),isDesktop:d(s)}}(u,o,n,t)}}(l.navigator.userAgent,function(n){return l.window.matchMedia(n).matches})),Tt=Kn,Ot=Yn,Dt=function(n,t){return n.dom()===t.dom()},At=rn().browser.isIE()?function(n,t){return function(n,t){return function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)}(n,t,l.Node.DOCUMENT_POSITION_CONTAINED_BY)}(n.dom(),t.dom())}:function(n,t){var e=n.dom(),r=t.dom();return e!==r&&e.contains(r)},Nt=on,Et=function(n,t){n.dom().appendChild(t.dom())},It=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Bt=function(n,t){var e=[];return h(dn(n),function(n){t(n)&&(e=e.concat([n])),e=e.concat(Bt(n,t))}),e};function kt(n,t,e,r,o){return n(e,r)?In.some(e):_n(o)&&o(e)?In.none():t(e,r,o)}function Pt(n,t,e){for(var r=n.dom(),o=_n(e)?e:d(!1);r.parentNode;){r=r.parentNode;var u=nt.fromDom(r);if(t(u))return In.some(u);if(o(u))break}return In.none()}function Mt(n,t,e){return Pt(n,function(n){return on(n,t)},e)}function _t(n,t){return function(n,t){return S(n.dom().childNodes,function(n){return t(nt.fromDom(n))}).map(nt.fromDom)}(n,function(n){return on(n,t)})}function jt(n,t){return function(n,t){var e=t===undefined?l.document:t.dom();return un(e)?In.none():In.from(e.querySelector(n)).map(nt.fromDom)}(t,n)}function Wt(n,t,e){return kt(on,Mt,n,t,e)}function zt(n,t){return Kt(n,t,d(!0))}function Lt(n,t){return function(n,t,e){if(void 0===e&&(e=s),e(t))return In.none();if(f(n,Xn(t)))return In.some(t);return Mt(t,n.join(","),function(n){return on(n,"table")||e(n)})}(["td","th"],n,t)}function Ft(n){return zt(n,"th,td")}function Ut(t,n){return an(n).map(function(n){return Dn(n,t)})}function Ht(n){var t=function(n){return zt(n,"tr")}(n);return p(t,function(n){var t=n,e=an(t).map(function(n){var t=Xn(n);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}).getOr("tbody"),r=p(Ft(n),function(n){var t=z(n,"rowspan")?parseInt(W(n,"rowspan"),10):1,e=z(n,"colspan")?parseInt(W(n,"colspan"),10):1;return xn(n,t,e)});return Cn(t,r,e)})}function qt(n,t){return n+","+t}function Vt(n,u){var t=n.grid().columns(),i=n.grid().rows(),c=t,a=0,f=0;return N(n.access(),function(n){if(u(n)){var t=n.row(),e=t+n.rowspan()-1,r=n.column(),o=r+n.colspan()-1;t<i?i=t:a<e&&(a=e),r<c?c=r:f<o&&(f=o)}}),function(n,t,e,r){return{minRow:d(n),minCol:d(t),maxRow:d(e),maxCol:d(r)}}(i,c,a,f)}function Yt(n,t){function e(n){return on(n.element(),t)}var r=Ht(n),o=$t.generate(r),u=Vt(o,e),i="th:not("+t+"),td:not("+t+")",c=Kt(n,"th,td",function(n){return on(n,i)});return h(c,It),function(n,t,e,r){for(var o,u,i,c=t.grid().columns(),a=t.grid().rows(),f=0;f<a;f++)for(var l=!1,s=0;s<c;s++){if(!(f<e.minRow()||f>e.maxRow()||s<e.minCol()||s>e.maxCol()))$t.getAt(t,f,s).filter(r).isNone()?(o=l,void 0,u=n[f].element(),i=nt.fromTag("td"),Et(i,nt.fromTag("br")),(o?Et:hn)(u,i)):l=!0}}(r,o,u,e),function(n,t){var e=v(zt(n,"tr"),function(n){return 0===n.dom().childElementCount});h(e,It),t.minCol()!==t.maxCol()&&t.minRow()!==t.maxRow()||h(zt(n,"th,td"),function(n){L(n,"rowspan"),L(n,"colspan")}),L(n,"width"),L(n,"height"),Z(n,"width"),Z(n,"height")}(n,u),n}var Kt=function(n,t,e){return O(dn(n),function(n){return on(n,t)?e(n)?[n]:[]:Kt(n,t,e)})},Gt=(b(Ut,"th,td"),b(Ut,"tr"),function(n,t){return Wt(n,"table",t)}),Xt=function(n,t){var e=O(n.all(),function(n){return n.cells()});return v(e,t)},$t={generate:function(n){var f={},t=[],e=n.length,l=0;h(n,function(n,c){var a=[];h(n.cells(),function(n){for(var t=0;f[qt(c,t)]!==undefined;)t++;for(var e=function(n,t,e,r,o){return{element:d(n),rowspan:d(t),colspan:d(e),row:d(r),column:d(o)}}(n.element(),n.rowspan(),n.colspan(),c,t),r=0;r<n.colspan();r++)for(var o=0;o<n.rowspan();o++){var u=t+r,i=qt(c+o,u);f[i]=e,l=Math.max(l,u+1)}a.push(e)}),t.push(Cn(n.element(),a,n.section()))});var r=function(n,t){return{rows:d(n),columns:d(t)}}(e,l);return{grid:d(r),access:d(f),all:d(t)}},getAt:function(n,t,e){var r=n.access()[qt(t,e)];return r!==undefined?In.some(r):In.none()},findItem:function(n,t,e){var r=Xt(n,function(n){return e(t,n.element())});return 0<r.length?In.some(r[0]):In.none()},filterItems:Xt,justCells:function(n){var t=p(n.all(),function(n){return n.cells()});return T(t)}};function Jt(n){return xe.get(n)}function Qt(n){return xe.getOption(n)}function Zt(n,t){xe.set(n,t)}function ne(n){return"img"===Xn(n)?1:Qt(n).fold(function(){return dn(n).length},function(n){return n.length})}function te(n){return function(n){return Qt(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()}(n)||f(Ce,Xn(n))}function ee(n){return function(n,o){var u=function(n){for(var t=0;t<n.childNodes.length;t++){var e=nt.fromDom(n.childNodes[t]);if(o(e))return In.some(e);var r=u(n.childNodes[t]);if(r.isSome())return r}return In.none()};return u(n.dom())}(n,te)}function re(n){return Re(n,te)}function oe(n,t){return nt.fromDom(n.dom().cloneNode(t))}function ue(n){return oe(n,!1)}function ie(n){return oe(n,!0)}function ce(n,t){var e=function(n,t){var e=nt.fromTag(t),r=F(n);return j(e,r),e}(n,t),r=dn(ie(n));return wn(e,r),e}function ae(){var n=nt.fromTag("td");return Et(n,nt.fromTag("br")),n}function fe(n,t,e){var r=ce(n,t);return N(e,function(n,t){null===n?L(r,t):_(r,t,n)}),r}function le(n){return n}function se(n){return function(){return nt.fromTag("tr",n.dom())}}function de(n){return{row:se(n),cell:ae,replace:le,gap:ae}}function me(n,t){var e=t.column(),r=t.column()+t.colspan()-1,o=t.row(),u=t.row()+t.rowspan()-1;return e<=n.finishCol()&&r>=n.startCol()&&o<=n.finishRow()&&u>=n.startRow()}function ge(n,t){return t.column()>=n.startCol()&&t.column()+t.colspan()-1<=n.finishCol()&&t.row()>=n.startRow()&&t.row()+t.rowspan()-1<=n.finishRow()}function pe(n,t){return function(n,t,e,r){return{startRow:d(n),startCol:d(t),finishRow:d(e),finishCol:d(r)}}(Math.min(n.row(),t.row()),Math.min(n.column(),t.column()),Math.max(n.row()+n.rowspan()-1,t.row()+t.rowspan()-1),Math.max(n.column()+n.colspan()-1,t.column()+t.colspan()-1))}function he(n,t,e){var r=$t.findItem(n,t,Dt),o=$t.findItem(n,e,Dt);return r.bind(function(t){return o.map(function(n){return pe(t,n)})})}function ve(t,n,e){return he(t,n,e).bind(function(n){return function(n,t){for(var e=!0,r=b(ge,t),o=t.startRow();o<=t.finishRow();o++)for(var u=t.startCol();u<=t.finishCol();u++)e=e&&$t.getAt(n,o,u).exists(r);return e?In.some(t):In.none()}(t,n)})}function be(e,n,t){return he(e,n,t).map(function(n){var t=$t.filterItems(e,b(me,n));return p(t,function(n){return n.element()})})}function we(n,t){return $t.findItem(n,t,function(n,t){return At(t,n)}).map(function(n){return n.element()})}function ye(t,e,r){return Gt(t).bind(function(n){return function(r,n,o,u){return $t.findItem(r,n,Dt).bind(function(n){var t=0<o?n.row()+n.rowspan()-1:n.row(),e=0<u?n.column()+n.colspan()-1:n.column();return $t.getAt(r,t+o,e+u).map(function(n){return n.element()})})}(Oe(n),t,e,r)})}function Se(n,t,e,r,o){var u=Oe(n),i=Dt(n,e)?In.some(t):we(u,t),c=Dt(n,o)?In.some(r):we(u,r);return i.bind(function(t){return c.bind(function(n){return be(u,t,n)})})}var xe=function Dl(e,r){var t=function(n){return e(n)?In.from(n.dom().nodeValue):In.none()};return{get:function(n){if(!e(n))throw new Error("Can only get "+r+" value of a "+r+" node");return t(n).getOr("")},getOption:t,set:function(n,t){if(!e(n))throw new Error("Can only set raw "+r+" value of a "+r+" node");n.dom().nodeValue=t}}}(Jn,"text"),Ce=["img","br"],Re=function(n,u){var i=function(n){for(var t=dn(n),e=t.length-1;0<=e;e--){var r=t[e];if(u(r))return In.some(r);var o=i(r);if(o.isSome())return o}return In.none()};return i(n)},Te=function(u,n,i){return{row:se(n),cell:function(n){var t=cn(n.element()),e=nt.fromTag(Xn(n.element()),t.dom()),r=i.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),o=0<r.length?function(r,o,u){return ee(r).map(function(n){var t=u.join(","),e=On(n,t,function(n){return Dt(n,r)});return w(e,function(n,t){var e=ue(t);return L(e,"contenteditable"),Et(n,e),e},o)}).getOr(o)}(n.element(),e,r):e;return Et(o,nt.fromTag("br")),function(n,t){var e=n.dom(),r=t.dom();V(e)&&V(r)&&(r.style.cssText=e.style.cssText)}(n.element(),e),Z(e,"height"),1!==n.colspan()&&Z(n.element(),"width"),u(n.element(),e),e},replace:fe,gap:ae}},Oe=function(n){var t=Ht(n);return $t.generate(t)},De=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ae(){return{up:d({selector:Mt,closest:Wt,predicate:Pt,all:fn}),down:d({selector:An,predicate:Bt}),styles:d({get:J,getRaw:Q,set:X,remove:Z}),attrs:d({get:W,set:_,remove:L,copyTo:function(n,t){var e=F(n);j(t,e)}}),insert:d({before:gn,after:pn,afterAll:bn,append:Et,appendAll:wn,prepend:hn,wrap:vn}),remove:d({unwrap:Sn,remove:It}),create:d({nu:nt.fromTag,clone:function(n){return nt.fromDom(n.dom().cloneNode(!1))},text:nt.fromText}),query:d({comparePosition:function(n,t){return n.dom().compareDocumentPosition(t.dom())},prevSibling:ln,nextSibling:sn}),property:d({children:dn,name:Xn,parent:an,document:function(n){return n.dom().ownerDocument},isText:Jn,isComment:P,isElement:$n,getText:Jt,setText:Zt,isBoundary:function(n){return!!$n(n)&&("body"===Xn(n)||f(De,Xn(n)))},isEmptyTag:function(n){return!!$n(n)&&f(["br","img","hr","input"],Xn(n))},isNonEditable:function(n){return $n(n)&&"false"===W(n,"contenteditable")}}),eq:Dt,is:Nt}}function Ne(n){return n.slice(0).sort()}function Ee(n,t){throw new Error("All required keys ("+Ne(n).join(", ")+") were not specified. Specified keys were: "+Ne(t).join(", ")+".")}function Ie(n){throw new Error("Unsupported keys for object: "+Ne(n).join(", "))}function Be(t,n){if(!Pn(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");h(n,function(n){if(!kn(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})}function ke(n){var e=Ne(n);S(e,function(n,t){return t<e.length-1&&n===e[t+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}function Pe(n){return Mt(n,"table")}function Me(c,a,r){function f(t){return function(n){return r!==undefined&&r(n)||Dt(n,t)}}return Dt(c,a)?In.some(Je.create({boxes:In.some([c]),start:c,finish:a})):Pe(c).bind(function(i){return Pe(a).bind(function(u){if(Dt(i,u))return In.some(Je.create({boxes:function(n,t,e){var r=Oe(n);return be(r,t,e)}(i,c,a),start:c,finish:a}));if(At(i,u)){var n=0<(t=On(a,"td,th",f(i))).length?t[t.length-1]:a;return In.some(Je.create({boxes:Se(i,c,i,a,u),start:c,finish:n}))}if(At(u,i)){var t,e=0<(t=On(c,"td,th",f(u))).length?t[t.length-1]:c;return In.some(Je.create({boxes:Se(u,c,i,a,u),start:c,finish:e}))}return function(n,t,e){return Ke(Ge,n,t,e)}(c,a).shared().bind(function(n){return Wt(n,"table",r).bind(function(n){var t=On(a,"td,th",f(n)),e=0<t.length?t[t.length-1]:a,r=On(c,"td,th",f(n)),o=0<r.length?r[r.length-1]:c;return In.some(Je.create({boxes:Se(n,c,i,a,u),start:o,finish:e}))})})})})}function _e(n,t){var e=An(n,t);return 0<e.length?In.some(e):In.none()}function je(n,t,r){return jt(n,t).bind(function(e){return jt(n,r).bind(function(t){return Xe(Pe,[e,t]).map(function(n){return{first:d(e),last:d(t),table:d(n)}})})})}function We(n,t,e,r,o){return function(n,t){return S(n,function(n){return on(n,t)})}(n,o).bind(function(n){return ye(n,t,e).bind(function(n){return function(t,e){return Mt(t,"table").bind(function(n){return jt(n,e).bind(function(n){return Me(n,t).bind(function(t){return t.boxes().map(function(n){return{boxes:d(n),start:d(t.start()),finish:d(t.finish())}})})})})}(n,r)})})}function ze(o,n,t){return je(o,n,t).bind(function(e){function n(n){return Dt(o,n)}var t=Mt(e.first(),"thead,tfoot,tbody,table",n),r=Mt(e.last(),"thead,tfoot,tbody,table",n);return t.bind(function(t){return r.bind(function(n){return Dt(t,n)?function(n,t,e){var r=Oe(n);return ve(r,t,e)}(e.table(),e.first(),e.last()):In.none()})})})}function Le(n,t,e,r){return n.fold(t,e,r)}function Fe(n,t){return Le(t.get(),d([]),o,d([n]))}function Ue(n){return{element:d(n),mergable:In.none,unmergable:In.none,selection:d([n])}}function He(n,t,e){return{element:d(e),mergable:d(function(e,n){return Le(n.get(),In.none,function(t,n){return 0===t.length?In.none():ze(e,rr,ur).bind(function(n){return 1<t.length?In.some({bounds:d(n),cells:d(t)}):In.none()})},In.none)}(t,n)),unmergable:d(function(n,t){var e=Fe(n,t);return 0<e.length&&D(e,function(n){return z(n,"rowspan")&&1<parseInt(W(n,"rowspan"),10)||z(n,"colspan")&&1<parseInt(W(n,"colspan"),10)})?In.some(e):In.none()}(e,n)),selection:d(Fe(e,n))}}var qe=function(r,o,n,t){var e=o(r,n);return w(t,function(n,t){var e=o(r,t);return Ve(r,n,e)},e)},Ve=function(t,n,e){return n.bind(function(n){return e.filter(b(t.eq,n))})},Ye=function(n,t,e){return 0<e.length?function(n,t,e,r){return r(n,t,e[0],e.slice(1))}(n,t,e,qe):In.none()},Ke=function(t,n,e,r){void 0===r&&(r=s);function o(t){return R(t,r).fold(function(){return t},function(n){return t.slice(0,n+1)})}var u=[n].concat(t.up().all(n)),i=[e].concat(t.up().all(e)),c=o(u),a=o(i),f=S(c,function(n){return g(a,function(n,t){return b(n.eq,t)}(t,n))});return{firstpath:d(c),secondpath:d(a),shared:d(f)}},Ge=Ae(),Xe=function(e,n){return Ye(Ge,function(n,t){return e(t)},n)},$e=function(o,u){var i=o.concat(u);if(0===i.length)throw new Error("You must specify at least one required or optional field.");return Be("required",o),Be("optional",u),ke(i),function(t){var e=Fn(t);D(o,function(n){return f(e,n)})||Ee(o,e);var n=v(e,function(n){return!f(i,n)});0<n.length&&Ie(n);var r={};return h(o,function(n){r[n]=d(t[n])}),h(u,function(n){r[n]=d(Object.prototype.hasOwnProperty.call(t,n)?In.some(t[n]):In.none())}),r}},Je={create:$e(["boxes","start","finish"],[])},Qe="data-mce-first-selected",Ze="data-mce-last-selected",nr="td[data-mce-selected],th[data-mce-selected]",tr="[data-mce-selected]",er=Qe,rr="td[data-mce-first-selected],th[data-mce-first-selected]",or=Ze,ur="td[data-mce-last-selected],th[data-mce-last-selected]",ir=/* */Object.freeze({__proto__:null,selected:"data-mce-selected",selectedSelector:nr,attributeSelector:tr,firstSelected:er,firstSelectedSelector:rr,lastSelected:or,lastSelectedSelector:ur}),cr=function(i){if(!Pn(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],e={};return h(i,function(n,r){var t=Fn(n);if(1!==t.length)throw new Error("one and only one name per case");var o=t[0],u=n[o];if(e[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!Pn(u))throw new Error("case arguments must be an array");c.push(o),e[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var e=new Array(n),t=0;t<e.length;t++)e[t]=arguments[t];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,e)},match:function(n){var t=Fn(n);if(c.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+t.join(","));if(!D(c,function(n){return f(t,n)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,e)},log:function(n){l.console.log(n,{constructors:c,constructor:o,params:e})}}}}),e},ar=cr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),fr=ar.none,lr=ar.multiple,sr=ar.single,dr=function(c,n,a,f){c.on("BeforeGetContent",function(t){!0===t.selection&&Le(n.get(),C,function(n){t.preventDefault(),function(n){return Gt(n[0]).map(ie).map(function(n){return[Yt(n,tr)]})}(n).each(function(n){t.content="text"===t.format?function(n){return p(n,function(n){return n.dom().innerText}).join("")}(n):function(t,n){return p(n,function(n){return t.selection.serializer.serialize(n.dom(),{})}).join("")}(c,n)})},C)}),c.on("BeforeSetContent",function(i){!0===i.selection&&!0===i.paste&&In.from(c.dom.getParent(c.selection.getStart(),"th,td")).each(function(n){var u=nt.fromDom(n);Gt(u).each(function(t){var n=v(function(n,t){var e=(t||l.document).createElement("div");return e.innerHTML=n,dn(nt.fromDom(e))}(i.content),function(n){return"meta"!==Xn(n)});if(1===n.length&&"table"===Xn(n[0])){i.preventDefault();var e=nt.fromDom(c.getDoc()),r=de(e),o=function(n,t,e){return{element:d(n),clipboard:d(t),generators:d(e)}}(u,n[0],r);a.pasteCells(t,o).each(function(n){c.selection.setRng(n),c.focus(),f.clear(t)})}})})})};function mr(r,o){function n(n){var t=o(n);if(t<=0||null===t){var e=J(n,r);return parseFloat(e)||0}return t}function u(o,n){return y(n,function(n,t){var e=J(o,t),r=e===undefined?0:parseInt(e,10);return isNaN(r)?n:n+r},0)}return{set:function(n,t){if(!jn(t)&&!t.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+t);var e=n.dom();V(e)&&(e.style[r]=t+"px")},get:n,getOuter:n,aggregate:u,max:function(n,t,e){var r=u(n,e);return r<t?t-r:0}}}function gr(n){return qr.get(n)}function pr(n){return qr.getOuter(n)}function hr(n){return Vr.get(n)}function vr(n){return Vr.getOuter(n)}function br(n,t,e){return function(n,t){var e=parseFloat(n);return isNaN(e)?t:e}(J(n,t),e)}function wr(n){return Yr.browser.isIE()||Yr.browser.isEdge()?function(n){var t=br(n,"padding-top",0),e=br(n,"padding-bottom",0),r=br(n,"border-top-width",0),o=br(n,"border-bottom-width",0),u=n.dom().getBoundingClientRect().height;return"border-box"===J(n,"box-sizing")?u:u-t-e-(r+o)}(n):br(n,"height",gr(n))}function yr(n,t){X(n,"width",t+"px")}function Sr(n,t){X(n,"width",t+"%")}function xr(n,t){X(n,"height",t+"px")}function Cr(n,t,e,r){var o=parseInt(n,10);return function(n,t){return U(n,t,n.length-t.length)}(n,"%")&&"table"!==Xn(t)?function(n,e,r,t){var o=Gt(n).map(function(n){var t=r(n);return Math.floor(e/100*t)}).getOr(e);return t(n,o),o}(t,o,e,r):o}function Rr(n){var t=function(n){return Q(n,"height").getOrThunk(function(){return wr(n)+"px"})}(n);return t?Cr(t,n,gr,xr):gr(n)}function Tr(n){return Q(n,"width").fold(function(){return In.from(W(n,"width"))},function(n){return In.some(n)})}function Or(n,t){return n/t.pixelWidth()*100}function Dr(t,e){return Tr(t).fold(function(){var n=hr(t);return Or(n,e)},function(n){return function(n,t,e){var r=Gr.exec(t);if(null!==r)return parseFloat(r[1]);var o=hr(n);return Or(o,e)}(t,n,e)})}function Ar(t,e){return Tr(t).fold(function(){return hr(t)},function(n){return function(n,t,e){var r=Xr.exec(t);if(null!==r)return parseInt(r[1],10);var o=Gr.exec(t);return null===o?hr(n):function(n,t){return n/100*t.pixelWidth()}(parseFloat(o[1]),e)}(t,n,e)})}function Nr(n){return function(n,t,e){return e(n)/$r(n,t)}(n,"rowspan",Rr)}function Er(n,t,e){X(n,"width",t+e)}function Ir(e,r){(function(n){return Tr(n).bind(function(n){var t=Kr.exec(n);return null!==t?In.some({width:d(parseFloat(t[1])),unit:d(t[3])}):In.none()})})(e).each(function(n){var t=n.width()/2;Er(e,t,n.unit()),Er(r,t,n.unit())})}function Br(n,t){return n!==undefined?n:t!==undefined?t:0}function kr(n){var t=n.dom().ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom())return no(e.offsetLeft,e.offsetTop);var u=Br(r.pageYOffset,o.scrollTop),i=Br(r.pageXOffset,o.scrollLeft),c=Br(o.clientTop,e.clientTop),a=Br(o.clientLeft,e.clientLeft);return to(n).translate(i-a,u-c)}function Pr(n,t){return{row:d(n),y:d(t)}}function Mr(n,t){return{col:d(n),x:d(t)}}function _r(n){return kr(n).left()+vr(n)}function jr(n){return kr(n).left()}function Wr(n,t){return Mr(n,jr(t))}function zr(n,t){return Mr(n,_r(t))}function Lr(n){return kr(n).top()}function Fr(n,t){return Pr(n,Lr(t))}function Ur(n,t){return Pr(n,Lr(t)+pr(t))}function Hr(e,t,r){if(0===r.length)return[];var n=p(r.slice(1),function(n,t){return n.map(function(n){return e(t,n)})}),o=r[r.length-1].map(function(n){return t(r.length-1,n)});return n.concat([o])}var qr=mr("height",function(n){var t=n.dom();return K(n)?t.getBoundingClientRect().height:t.offsetHeight}),Vr=mr("width",function(n){return n.dom().offsetWidth}),Yr=rn(),Kr=/(\d+(\.\d+)?)(\w|%)*/,Gr=/(\d+(\.\d+)?)%/,Xr=/(\d+(\.\d+)?)px|em/,$r=function(n,t){return z(n,t)?parseInt(W(n,t),10):1},Jr=d(Gr),Qr=d(Xr),Zr=function(e,r){return{left:d(e),top:d(r),translate:function(n,t){return Zr(e+n,r+t)}}},no=Zr,to=function(n){var t=n.dom(),e=t.ownerDocument.body;return e===t?no(e.offsetLeft,e.offsetTop):K(n)?function(n){var t=n.getBoundingClientRect();return no(t.left,t.top)}(t):no(0,0)},eo={height:{delta:o,positions:function(n){return Hr(Fr,Ur,n)},edge:Lr},rtl:{delta:function(n){return-n},edge:_r,positions:function(n){return Hr(zr,Wr,n)}},ltr:{delta:o,edge:jr,positions:function(n){return Hr(Wr,zr,n)}}},ro={ltr:eo.ltr,rtl:eo.rtl};function oo(t){function e(n){return t(n).isRtl()?ro.rtl:ro.ltr}return{delta:function(n,t){return e(t).delta(n,t)},edge:function(n){return e(n).edge(n)},positions:function(n,t){return e(t).positions(n,t)}}}function uo(n){var t=Ht(n);return $t.generate(t).grid()}function io(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}function co(n,t,e,r){e===r?L(n,t):_(n,t,e)}function ao(o,n){function t(n,t){0<n.length?function(n,t){var e=_t(o,t).getOrThunk(function(){var n=nt.fromTag(t,cn(o).dom());return Et(o,n),n});yn(e);var r=p(n,function(n){n.isNew()&&u.push(n.element());var t=n.element();return yn(t),h(n.cells(),function(n){n.isNew()&&i.push(n.element()),co(n.element(),"colspan",n.colspan(),1),co(n.element(),"rowspan",n.rowspan(),1),Et(t,n.element())}),t});wn(e,r)}(n,t):function(n){_t(o,n).each(It)}(t)}var u=[],i=[],e=[],r=[],c=[];return h(n,function(n){switch(n.section()){case"thead":e.push(n);break;case"tbody":r.push(n);break;case"tfoot":c.push(n)}}),t(e,"thead"),t(r,"tbody"),t(c,"tfoot"),{newRows:d(u),newCells:d(i)}}function fo(n,t){var e=W(n,t);return e===undefined||""===e?[]:e.split(" ")}function lo(n){return n.dom().classList!==undefined}function so(n,t){return function(n,t,e){var r=fo(n,t).concat([e]);return _(n,t,r.join(" ")),!0}(n,"class",t)}function mo(n,t){return function(n,t,e){var r=v(fo(n,t),function(n){return n!==e});return 0<r.length?_(n,t,r.join(" ")):L(n,t),!1}(n,"class",t)}function go(n,t){lo(n)?n.dom().classList.add(t):so(n,t)}function po(n){0===(lo(n)?n.dom().classList:function(n){return fo(n,"class")}(n)).length&&L(n,"class")}function ho(n,t){return lo(n)&&n.dom().classList.contains(t)}function vo(n,t){for(var e=[],r=n;r<t;r++)e.push(r);return e}function bo(t,e){if(e<0||e>=t.length-1)return In.none();var n=t[e].fold(function(){var n=function(n){var t=Wn.call(n,0);return t.reverse(),t}(t.slice(0,e));return A(n,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return In.some({value:n,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return A(n,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return In.some({value:n,delta:1})});return n.bind(function(e){return r.map(function(n){var t=n.delta+e.delta;return Math.abs(n.value-e.value)/t})})}function wo(e){var n=e.grid(),t=vo(0,n.columns()),r=vo(0,n.rows());return p(t,function(t){return Ii(function(){return O(r,function(n){return $t.getAt(e,n,t).filter(function(n){return n.column()===t}).fold(d([]),function(n){return[n]})})},function(n){return 1===n.colspan()},function(){return $t.getAt(e,0,t)})})}function yo(e){var n=e.grid(),t=vo(0,n.rows()),r=vo(0,n.columns());return p(t,function(t){return Ii(function(){return O(r,function(n){return $t.getAt(e,t,n).filter(function(n){return n.row()===t}).fold(d([]),function(n){return[n]})})},function(n){return 1===n.rowspan()},function(){return $t.getAt(e,t,0)})})}function So(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}}function xo(n){var t=An(n.parent(),"."+ki);h(t,It)}function Co(e,n,r){var o=e.origin();h(n,function(n,t){n.each(function(n){var t=r(o,n);go(t,ki),Et(e.parent(),t)})})}function Ro(n,t,r,o){Co(n,t,function(n,t){var e=function(n,t,e,r,o){var u=nt.fromTag("div");return $(u,{position:"absolute",left:t-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),j(u,{"data-column":n,role:"presentation"}),u}(t.col(),t.x()-n.left(),r.top()-n.top(),7,o);return go(e,Mi),e})}function To(n,t,r,o){Co(n,t,function(n,t){var e=function(n,t,e,r,o){var u=nt.fromTag("div");return $(u,{position:"absolute",left:t+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),j(u,{"data-row":n,role:"presentation"}),u}(t.row(),r.left()-n.left(),t.y()-n.top(),o,7);return go(e,Pi),e})}function Oo(n,t,e,r){xo(n);var o=Ht(t),u=$t.generate(o);!function(n,t,e,r,o,u){var i=kr(t),c=0<e.length?o.positions(e,t):[];To(n,c,i,vr(t));var a=0<r.length?u.positions(r,t):[];Ro(n,a,i,pr(t))}(n,t,yo(u),wo(u),e,r)}function Do(n,t){var e=An(n.parent(),"."+ki);h(e,t)}function Ao(n){Do(n,function(n){X(n,"display","none")})}function No(n){Do(n,function(n){X(n,"display","block")})}function Eo(n,t,e){n.cells()[t]=e}function Io(n,t){var e=n.cells(),r=p(e,t);return Tn(r,n.section())}function Bo(n,t){return n.cells()[t]}function ko(n,t){return Bo(n,t).element()}function Po(n){return n.cells().length}function Mo(n,t){if(0===n.length)return 0;var e=n[0];return R(n,function(n){return!t(e.element(),n.element())}).fold(function(){return n.length},function(n){return n})}function _o(n,t,e,r){var o=function(n,t){return n[t]}(n,t).cells().slice(e),u=Mo(o,r),i=function(n,t){return p(n,function(n){return Bo(n,t)})}(n,e).slice(t),c=Mo(i,r);return{colspan:d(u),rowspan:d(c)}}function jo(o,u){var i=p(o,function(n,t){return p(n.cells(),function(n,t){return!1})});return p(o,function(n,r){return function(n,t){return{details:d(n),section:d(t)}}(O(n.cells(),function(n,t){if(!1!==i[r][t])return[];var e=_o(o,r,t,u);return function(n,t,e,r){for(var o=n;o<n+e;o++)for(var u=t;u<t+r;u++)i[o][u]=!0}(r,t,e.rowspan(),e.colspan()),[function(n,t,e,r){return{element:d(n),rowspan:d(t),colspan:d(e),isNew:d(r)}}(n.element(),e.rowspan(),e.colspan(),n.isNew())]}),n.section())})}function Wo(n,t,e){for(var r=[],o=0;o<n.grid().rows();o++){for(var u=[],i=0;i<n.grid().columns();i++){var c=$t.getAt(n,o,i).map(function(n){return Rn(n.element(),e)}).getOrThunk(function(){return Rn(t.gap(),!0)});u.push(c)}var a=Tn(u,n.all()[o].section());r.push(a)}return r}function zo(n,e){return p(n,function(n){var t=function(n){return A(n,function(n){return an(n.element()).map(function(n){var t=an(n).isNone();return Rn(n,t)})}).getOrThunk(function(){return Rn(e.row(),!0)})}(n.details());return function(n,t,e,r){return{element:d(n),cells:d(t),section:d(e),isNew:d(r)}}(t.element(),n.details(),n.section(),t.isNew())})}function Lo(n,t){var e=jo(n,Dt);return zo(e,t)}function Fo(n,t){var e=T(p(n.all(),function(n){return n.cells()}));return S(e,function(n){return Dt(t,n.element())})}function Uo(c,a,f,l,s){return function(e,r,n,o,u){var t=Ht(r),i=$t.generate(t);return a(i,n).map(function(n){var t=function(n,t){return Wo(n,t,!1)}(i,o),e=c(t,n,Dt,s(o)),r=Lo(e.grid(),o);return{grid:d(r),cursor:e.cursor}}).fold(function(){return In.none()},function(n){var t=ao(r,n.grid());return f(r,n.grid(),u),l(r),Oo(e,r,eo.height,u),In.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})})}}function Ho(t,n){return Lt(n.element()).bind(function(n){return Fo(t,n)})}function qo(t,n){var e=p(n.selection(),function(n){return Lt(n).bind(function(n){return Fo(t,n)})}),r=io(e);return 0<r.length?In.some({cells:r,generators:n.generators,clipboard:n.clipboard}):In.none()}function Vo(t,n){var e=p(n.selection(),function(n){return Lt(n).bind(function(n){return Fo(t,n)})}),r=io(e);return 0<r.length?In.some(r):In.none()}function Yo(n,t){var e=Po(n[0]),r=Po(t[0]);return{rowDelta:d(0),colDelta:d(e-r)}}function Ko(n,t){return p(n,function(){return Rn(t.cell(),!0)})}function Go(t,n,e){return t.concat(function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e}(n,function(n){return _i(t[t.length-1],Ko(t[t.length-1].cells(),e))}))}function Xo(n,t,e){return p(n,function(n){return _i(n,n.cells().concat(Ko(vo(0,t),e)))})}function $o(n,t,e){var r=t.colDelta()<0?Xo:o;return(t.rowDelta()<0?Go:o)(r(n,Math.abs(t.colDelta()),e),Math.abs(t.rowDelta()),e)}function Jo(n,t,e,r){for(var o=!0,u=0;u<n.length;u++)for(var i=0;i<Po(n[0]);i++){var c=e(ko(n[u],i),t);!0===c&&!1===o?Eo(n[u],i,Rn(r(),!0)):!0===c&&(o=!1)}return n}function Qo(u,e,i,c){if(0<e&&e<u.length){var n=function(n,e){return y(n,function(n,t){return g(n,function(n){return e(n.element(),t.element())})?n:n.concat([t])},[])}(u[e-1].cells(),i);h(n,function(r){for(var o=In.none(),n=function(e){for(var n=function(t){var n=u[e].cells()[t];i(n.element(),r.element())&&(o.isNone()&&(o=In.some(c())),o.each(function(n){Eo(u[e],t,Rn(n,!0))}))},t=0;t<Po(u[0]);t++)n(t)},t=e;t<u.length;t++)n(t)})}return u}function Zo(e,r,o,u,i){return function(n,t,e){if(n.row()>=t.length||n.column()>Po(t[0]))return zi.error("invalid start address out of table bounds, row: "+n.row()+", column: "+n.column());var r=t.slice(n.row()),o=r[0].cells().slice(n.column()),u=Po(e[0]),i=e.length;return zi.value({rowDelta:d(r.length-i),colDelta:d(o.length-u)})}(e,r,o).map(function(n){var t=$o(r,n,u);return function(n,t,e,r,o){for(var u,i,c,a,f,l=n.row(),s=n.column(),d=l+e.length,m=s+Po(e[0]),g=l;g<d;g++)for(var p=s;p<m;p++){c=p,f=a=void 0,a=b(o,Bo((u=t)[i=g],c).element()),f=u[i],1<u.length&&1<Po(f)&&(0<c&&a(ko(f,c-1))||c<f.cells().length-1&&a(ko(f,c+1))||0<i&&a(ko(u[i-1],c))||i<u.length-1&&a(ko(u[i+1],c)))&&Jo(t,ko(t[g],p),o,r.cell);var h=ko(e[g-l],p-s),v=r.replace(h);Eo(t[g],p,Rn(v,!0))}return t}(e,t,o,u,i)})}function nu(n,t,e,r,o){Qo(t,n,o,r.cell);var u=Yo(e,t),i=$o(e,u,r),c=Yo(t,i),a=$o(t,c,r);return a.slice(0,n).concat(i).concat(a.slice(n,a.length))}function tu(e,r,n,o,u){var t=e.slice(0,r),i=e.slice(r),c=Io(e[n],function(n,t){return 0<r&&r<e.length&&o(ko(e[r-1],t),ko(e[r],t))?Bo(e[r],t):Rn(u(n.element(),o),!0)});return t.concat([c]).concat(i)}function eu(n,e,r,o,u){return p(n,function(n){var t=0<e&&e<Po(n)&&o(ko(n,e-1),ko(n,e))?Bo(n,e):Rn(u(ko(n,r),o),!0);return function(n,t,e){var r=n.cells(),o=r.slice(0,t),u=r.slice(t),i=o.concat([e]).concat(u);return _i(n,i)}(n,e,t)})}function ru(n,e,r,t){return p(n,function(n){return Io(n,function(n){return function(t){return g(e,function(n){return r(t.element(),n.element())})}(n)?Rn(t(n.element(),r),!0):n})})}function ou(n,t,e,r){return ko(n[t],e)!==undefined&&0<t&&r(ko(n[t-1],e),ko(n[t],e))}function uu(n,t,e){return 0<t&&e(ko(n,t-1),ko(n,t))}function iu(e,r,o,n){var t=O(e,function(n,t){return ou(e,t,r,o)||uu(n,r,o)?[]:[Bo(n,r)]});return ru(e,t,o,n)}function cu(e,r,o,n){var u=e[r],t=O(u.cells(),function(n,t){return ou(e,r,t,o)||uu(u,t,o)?[]:[n]});return ru(e,t,o,n)}function au(n,t,u,i){function c(n){return p(n,d(0))}function r(n,t){if(0<=u){var e=Math.max(i.minCellWidth(),a[t]-u);return c(a.slice(0,n)).concat([u,e-a[t]]).concat(c(a.slice(t+1)))}var r=Math.max(i.minCellWidth(),a[n]+u),o=a[n]-r;return c(a.slice(0,n)).concat([r-a[n],o]).concat(c(a.slice(t+1)))}var a=n.slice(0),e=function(n,t){return 0===n.length?Fi.none():1===n.length?Fi.only(0):0===t?Fi.left(0,1):t===n.length-1?Fi.right(t-1,t):0<t&&t<n.length-1?Fi.middle(t-1,t,t+1):Fi.none()}(n,t),o=d(c(a)),f=r;return e.fold(o,function(n){return i.singleColumnWidth(a[n],u)},f,function(n,t,e){return r(t,e)},function(n,t){if(0<=u)return c(a.slice(0,t)).concat([u]);var e=Math.max(i.minCellWidth(),a[t]+u);return c(a.slice(0,t)).concat([e-a[t]])})}function fu(n,t){return z(n,t)&&1<parseInt(W(n,t),10)}function lu(n){return fu(n,"colspan")}function su(n){return fu(n,"rowspan")}function du(n,t){return parseInt(J(n,t),10)}function mu(n,t,e,r,o){var u=wo(n),i=p(u,function(n){return n.map(t.edge)});return p(u,function(n,t){return n.filter(m(lu)).fold(function(){var n=bo(i,t);return r(n)},function(n){return e(n,o)})})}function gu(n,t,e){return mu(n,t,Dr,function(n){return n.fold(function(){return e.minCellWidth()},function(n){return n/e.pixelWidth()*100})},e)}function pu(n,t,e){return mu(n,t,Ar,function(n){return n.getOrThunk(e.minCellWidth)},e)}function hu(n,t){return function(n,t,e,r){var o=yo(n),u=p(o,function(n){return n.map(t.edge)});return p(o,function(n,t){return n.filter(m(su)).fold(function(){var n=bo(u,t);return r(n)},function(n){return e(n)})})}(n,t,Nr,function(n){return n.getOrThunk(Hi)})}function vu(n,t,e){for(var r=0,o=n;o<t;o++)r+=e[o]!==undefined?e[o]:0;return r}function bu(n,e){var t=$t.justCells(n);return p(t,function(n){var t=vu(n.column(),n.column()+n.colspan(),e);return{element:n.element,width:d(t),colspan:n.colspan}})}function wu(n){var t=o;return{width:d(n),pixelWidth:d(n),getWidths:pu,getCellDelta:t,singleColumnWidth:function(n,t){return[Math.max(Ui(),n+t)-n]},minCellWidth:Ui,setElementWidth:yr,setTableWidth:function(n,t,e){var r=w(t,function(n,t){return n+t},0);yr(n,r)}}}function yu(n,t){var e=Jr().exec(t);if(null!==e)return function(n,t){var r=parseFloat(n),e=hr(t);return{width:d(r),pixelWidth:d(e),getWidths:gu,getCellDelta:function(n){return n/e*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return Ui()/e*100},setElementWidth:Sr,setTableWidth:function(n,t,e){Sr(n,r+e/100*r)}}}(e[1],n);var r=Qr().exec(t);if(null!==r){var o=parseInt(r[1],10);return wu(o)}var u=hr(n);return wu(u)}function Su(t){return Tr(t).fold(function(){var n=hr(t);return wu(n)},function(n){return yu(t,n)})}function xu(n){return $t.generate(n)}function Cu(n){var t=Ht(n);return xu(t)}function Ru(n,e,r,t){var o=Cu(n),u=hu(o,t),i=p(u,function(n,t){return r===t?Math.max(e+n,Hi()):n}),c=function(n,e){var t=$t.justCells(n);return p(t,function(n){var t=vu(n.row(),n.row()+n.rowspan(),e);return{element:n.element,height:d(t),rowspan:n.rowspan}})}(o,i),a=function(n,e){return p(n.all(),function(n,t){return{element:n.element,height:d(e[t])}})}(o,i);h(a,function(n){xr(n.element(),n.height())}),h(c,function(n){xr(n.element(),n.height())});var f=function(n){return w(n,function(n,t){return n+t},0)}(i);xr(n,f)}function Tu(t,n){var e=v(n,function(n){return!f(t,n)});0<e.length&&Ie(e)}function Ou(n){return function(n,t){return qi(n,t,{validate:_n,label:"function"})}(Tu,n)}function Du(n){var t=z(n,"colspan")?parseInt(W(n,"colspan"),10):1,e=z(n,"rowspan")?parseInt(W(n,"rowspan"),10):1;return{element:d(n),colspan:d(t),rowspan:d(e)}}function Au(n){return function(n,t){var e=n.property().name(t);return f(Xi,e)}($i,n)}function Nu(n){return function(n,t){var e=n.property().name(t);return f(["ol","ul"],e)}($i,n)}function Eu(n){return function(n,t){return f(["br","img","hr","input"],n.property().name(t))}($i,n)}function Iu(n){function o(n){return"br"===Xn(n)}function e(r){return re(r).bind(function(t){var e=function(n){return sn(n).map(function(n){return!!Au(n)||!!Eu(n)&&"img"!==Xn(n)}).getOr(!1)}(t);return an(t).map(function(n){return!0===e||function(n){return"li"===Xn(n)||Pt(n,Nu).isSome()}(n)||o(t)||Au(n)&&!Dt(r,n)?[]:[nt.fromTag("br")]})}).getOr([])}var t,r=0===(t=O(n,function(n){var t=dn(n);return function(n){return D(n,function(n){return o(n)||Jn(n)&&0===Jt(n).trim().length})}(t)?[]:t.concat(e(n))})).length?[nt.fromTag("br")]:t;yn(n[0]),wn(n[0],r)}function Bu(n){0===Ft(n).length&&It(n)}function ku(n,t){return{grid:d(n),cursor:d(t)}}function Pu(n,t,e){return Ji(n,t,e).orThunk(function(){return Ji(n,0,0)})}function Mu(n,t,e){return ku(n,Ji(n,t,e))}function _u(n){return y(n,function(n,t){return g(n,function(n){return n.row()===t.row()})?n:n.concat([t])},[]).sort(function(n,t){return n.row()-t.row()})}function ju(n){return y(n,function(n,t){return g(n,function(n){return n.column()===t.column()})?n:n.concat([t])},[]).sort(function(n,t){return n.column()-t.column()})}function Wu(n,t,e){var r=function(n,e){return p(n,function(n){var t=p(Ft(n),function(n){var t=z(n,"rowspan")?parseInt(W(n,"rowspan"),10):1,e=z(n,"colspan")?parseInt(W(n,"colspan"),10):1;return xn(n,t,e)});return Cn(n,t,e.section())})}(n,e),o=$t.generate(r);return Wo(o,t,!0)}function zu(n,t,e){var r=Su(n),o=xu(t),u=r.getWidths(o,e,r),i=bu(o,u);h(i,function(n){r.setElementWidth(n.element(),n.width())}),0<i.length&&r.setTableWidth(n,u,r.getCellDelta(0))}function Lu(n){return n.getBoundingClientRect().width}function Fu(n){return n.getBoundingClientRect().height}function Uu(n){return/^[0-9]+$/.test(n)&&(n+="px"),n}function Hu(n){var t=An(n,"td[data-mce-style],th[data-mce-style]");L(n,"data-mce-style"),h(t,function(n){L(n,"data-mce-style")})}function qu(n){return n.getParam("table_default_attributes",pc,"object")}function Vu(n){return n.getParam("table_default_styles",gc,"object")}function Yu(n){return n.getParam("table_cell_advtab",!0,"boolean")}function Ku(n){return n.getParam("table_row_advtab",!0,"boolean")}function Gu(n){return n.getParam("table_advtab",!0,"boolean")}function Xu(n){return n.getParam("table_style_by_css",!1,"boolean")}function $u(n){return n.getParam("table_class_list",[],"array")}function Ju(n){return!1===n.getParam("table_responsive_width")}function Qu(n,t){return n.fire("newrow",{node:t})}function Zu(n,t){return n.fire("newcell",{node:t})}function ni(n,t,e,r){n.fire("ObjectResizeStart",{target:t,width:e,height:r})}function ti(n,t,e,r){n.fire("ObjectResized",{target:t,width:e,height:r})}function ei(n,t,e){var r=Ht(n),o=$t.generate(r);return Vo(o,t).map(function(n){var t=Wo(o,e,!1).slice(n[0].row(),n[n.length-1].row()+n[n.length-1].rowspan());return function(n){return p(n,function(n){var e=ue(n.element());return h(n.cells(),function(n){var t=ie(n.element());co(t,"colspan",n.colspan(),1),co(t,"rowspan",n.rowspan(),1),Et(e,t)}),e})}(Lo(t,e))})}function ri(o,n,u){var t;return t=function(n,t){for(var e=0;e<t.length;e++){var r=o.getStyle(t[e],u);if(void 0===n&&(n=r),n!==r)return""}return n}(t,o.select("td,th",n))}function oi(n,t,e){e&&n.formatter.apply("align"+e,{},t)}function ui(n,t,e){e&&n.formatter.apply("valign"+e,{},t)}function ii(t,e){Sc.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})}function ci(n,r,t){var o=function(n,e){return e=e||[],Sc.each(n,function(n){var t={text:n.text||n.title};n.menu?t.menu=o(n.menu):(t.value=n.value,r&&r(t)),e.push(t)}),e};return o(n,t||[])}function ai(t,n){function e(n){return q(n,"rgb")?t.toHex(n):n}return{borderwidth:Q(nt.fromDom(n),"border-width").getOr(""),borderstyle:Q(nt.fromDom(n),"border-style").getOr(""),bordercolor:Q(nt.fromDom(n),"border-color").map(e).getOr(""),backgroundcolor:Q(nt.fromDom(n),"background-color").map(e).getOr("")}}function fi(n){var o=n[0],t=n.slice(1),e=Fn(o);return h(t,function(n){h(e,function(r){N(n,function(n,t){var e=o[r];""!==e&&r===t&&e!==n&&(o[r]="")})})}),o}function li(n){var t=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}}function si(n,t,e,r,o){var u={};return Sc.each(n.split(" "),function(n){r.formatter.matchNode(o,t+n)&&(u[e]=n)}),u[e]||(u[e]=""),u}function di(n){return function(t){var n=function(n){return n.getParam("table_cell_class_list",[],"array")}(t),e=ci(n,function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})});return 0<n.length?In.some({name:"class",type:"selectbox",label:"Class",items:e}):In.none()}(n).fold(function(){return Rc},function(n){return Rc.concat(n)})}function mi(n,t){n.setAttrib("scope",t.scope),n.setAttrib("class",t["class"]),n.setStyle("width",Uu(t.width)),n.setStyle("height",Uu(t.height))}function gi(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle),n.setStyle("border-width",Uu(t.borderwidth))}function pi(n,t,e){var r=n.dom,o=e.celltype&&t[0].nodeName.toLowerCase()!==e.celltype?r.rename(t[0],e.celltype):t[0],u=Tc.normal(r,o);mi(u,e),Yu(n)&&gi(u,e),ii(n,o),function(t,e){Sc.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})}(n,o),e.halign&&oi(n,o,e.halign),e.valign&&ui(n,o,e.valign)}function hi(e,n,r){var o=e.dom;Sc.each(n,function(n){r.celltype&&n.nodeName.toLowerCase()!==r.celltype&&(n=o.rename(n,r.celltype));var t=Tc.ifTruthy(o,n);mi(t,r),Yu(e)&&gi(t,r),r.halign&&oi(e,n,r.halign),r.valign&&ui(e,n,r.valign)})}function vi(n,t,e){var r=e.getData();e.close(),n.undoManager.transact(function(){(1===t.length?pi:hi)(n,t,r),n.focus()})}function bi(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0]){var r=Sc.map(e,function(n){return function(n,t,e){var r=n.dom;return ot(ot(ot({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),celltype:t.nodeName.toLowerCase(),"class":r.getAttrib(t,"class","")},xc("align","halign",n,t)),Cc("valign","valign",n,t)),e?ai(r,t):{})}(t,n,Yu(t))}),o=fi(r),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:di(t)},li("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:di(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:Yu(t)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:b(vi,t,e)})}}function wi(n){return function(t){var n=function(n){return n.getParam("table_row_class_list",[],"array")}(t),e=ci(n,function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})});return 0<n.length?In.some({name:"class",type:"selectbox",label:"Class",items:e}):In.none()}(n).fold(function(){return Oc},function(n){return Oc.concat(n)})}function yi(e,n,r,t){var o=e.dom,u=t.getData();t.close();var i=1===n.length?Tc.normal:Tc.ifTruthy;e.undoManager.transact(function(){Sc.each(n,function(n){u.type!==n.parentNode.nodeName.toLowerCase()&&function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,u=n.select(e,r)[0];u||(u=n.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?n.insertAfter(u,r.firstChild):r.insertBefore(u,r.firstChild):r.appendChild(u)),"tbody"===e&&"THEAD"===o.nodeName&&u.firstChild?u.insertBefore(t,u.firstChild):u.appendChild(t),o.hasChildNodes()||n.remove(o)}(e.dom,n,u.type);var t=i(o,n);t.setAttrib("scope",u.scope),t.setAttrib("class",u["class"]),t.setStyle("height",Uu(u.height)),Ku(e)&&function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle)}(t,u),u.align!==r.align&&(ii(e,n),oi(e,n,u.align))}),e.focus()})}function Si(t){var n,e,r=t.dom,o=[];if((n=r.getParent(t.selection.getStart(),"table"))&&(e=r.getParent(t.selection.getStart(),"td,th"),Sc.each(n.rows,function(t){Sc.each(t.cells,function(n){if((r.getAttrib(n,"data-mce-selected")||n===e)&&o.indexOf(t)<0)return o.push(t),!1})}),o[0])){var u=Sc.map(o,function(n){return function(n,t,e){var r=n.dom;return ot(ot({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),"class":r.getAttrib(t,"class",""),align:"",type:t.parentNode.nodeName.toLowerCase()},xc("align","align",n,t)),e?ai(r,t):{})}(t,n,Ku(t))}),i=fi(u),c={type:"tabpanel",tabs:[{title:"General",name:"general",items:wi(t)},li("row")]},a={type:"panel",items:[{type:"grid",columns:2,items:wi(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:Ku(t)?c:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onSubmit:b(yi,t,o,i)})}}function xi(n,t,e,r,o){void 0===o&&(o=Ac);var u=nt.fromTag("table");$(u,o.styles),j(u,o.attributes);var i=nt.fromTag("tbody");Et(u,i);for(var c=[],a=0;a<n;a++){for(var f=nt.fromTag("tr"),l=0;l<t;l++){var s=a<e||l<r?nt.fromTag("th"):nt.fromTag("td");l<r&&_(s,"scope","row"),a<e&&_(s,"scope","col"),Et(s,nt.fromTag("br")),o.percentages&&X(s,"width",100/t+"%"),Et(f,s)}c.push(f)}return wn(i,c),u}function Ci(n,t){n.selection.select(t.dom(),!0),n.selection.collapse(!0)}function Ri(t,n,e){var r=Vu(t),o={styles:r,attributes:qu(t),percentages:function(n){return kn(n)&&-1!==n.indexOf("%")}(r.width)&&!Ju(t)},u=xi(e,n,0,0,o);_(u,"data-mce-id","__mce");var i=function(n){var t=nt.fromTag("div"),e=nt.fromDom(n.dom().cloneNode(!0));return Et(t,e),function(n){return n.dom().innerHTML}(t)}(u);return t.insertContent(i),jt(fc(t),'table[data-mce-id="__mce"]').map(function(n){return Ju(t)&&X(n,"width",J(n,"width")),L(n,"data-mce-id"),function(t,n){h(An(n,"tr"),function(n){Qu(t,n.dom()),h(An(n,"th,td"),function(n){Zu(t,n.dom())})})}(t,n),function(n,t){jt(t,"td,th").each(b(Ci,n))}(t,n),n.dom()}).getOr(null)}function Ti(e,r,n){var o,u=e.dom,i=n.getData();n.close(),""===i["class"]&&delete i["class"],e.undoManager.transact(function(){if(!r){var n=parseInt(i.cols,10)||1,t=parseInt(i.rows,10)||1;r=Ri(e,n,t)}!function(n,t,e){var r=n.dom,o={},u={};if(o["class"]=e["class"],u.height=Uu(e.height),r.getAttrib(t,"width")&&!Xu(n)?o.width=function(n){return n?n.replace(/px$/,""):""}(e.width):u.width=Uu(e.width),Xu(n)?(u["border-width"]=Uu(e.border),u["border-spacing"]=Uu(e.cellspacing)):(o.border=e.border,o.cellpadding=e.cellpadding,o.cellspacing=e.cellspacing),Xu(n)&&t.children)for(var i=0;i<t.children.length;i++)Nc(r,t.children[i],{"border-width":Uu(e.border),padding:Uu(e.cellpadding)}),Gu(n)&&Nc(r,t.children[i],{"border-color":e.bordercolor});Gu(n)&&(u["background-color"]=e.backgroundcolor,u["border-color"]=e.bordercolor,u["border-style"]=e.borderstyle),o.style=r.serializeStyle(ot(ot({},Vu(n)),u)),r.setAttribs(t,ot(ot({},qu(n)),o))}(e,r,i),(o=u.select("caption",r)[0])&&!i.caption&&u.remove(o),!o&&i.caption&&((o=u.create("caption")).innerHTML=Dc.ie?"\xa0":'<br data-mce-bogus="1"/>',r.insertBefore(o,r.firstChild)),""===i.align?ii(e,r):oi(e,r,i.align),e.focus(),e.addVisual()})}function Oi(n,t){var e,r=n.dom,o=function(n,t){var e,r,o,u,i=Vu(n),c=qu(n),a=n.dom,f=t?(e=a,r=I(i,"border-style").getOr(""),o=I(i,"border-color").getOr(""),u=I(i,"background-color").getOr(""),{borderstyle:r,bordercolor:l(o),backgroundcolor:l(u)}):{};function l(n){return q(n,"rgb")?e.toHex(n):n}var s,d,m;return ot(ot(ot(ot(ot(ot({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,"class":"",align:"",border:""}),i),c),f),(m=i["border-width"],Xu(n)&&m?{border:m}:I(c,"border").fold(function(){return{}},function(n){return{border:n}}))),(s=I(i,"border-spacing").or(I(c,"cellspacing")).fold(function(){return{}},function(n){return{cellspacing:n}}),d=I(i,"border-padding").or(I(c,"cellpadding")).fold(function(){return{}},function(n){return{cellpadding:n}}),ot(ot({},s),d)))}(n,Gu(n));!1===t?(e=r.getParent(n.selection.getStart(),"table"))?o=function(n,t,e){var r,o,u,i=n.dom;return ot(ot({width:i.getStyle(t,"width")||i.getAttrib(t,"width"),height:i.getStyle(t,"height")||i.getAttrib(t,"height"),cellspacing:i.getStyle(t,"border-spacing")||i.getAttrib(t,"cellspacing"),cellpadding:i.getAttrib(t,"cellpadding")||ri(n.dom,t,"padding"),border:(r=i,o=t,u=Q(nt.fromDom(o),"border-width"),Xu(n)&&u.isSome()?u.getOr(""):r.getAttrib(o,"border")||ri(n.dom,o,"border-width")||ri(n.dom,o,"border")),caption:!!i.select("caption",t)[0],"class":i.getAttrib(t,"class","")},xc("align","align",n,t)),e?ai(i,t):{})}(n,e,Gu(n)):Gu(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",Gu(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var u=0<$u(n).length;u&&o["class"]&&(o["class"]=o["class"].replace(/\s*mce\-item\-table\s*/g,""));var i={type:"grid",columns:2,items:function(t,n,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(n){return n.getParam("table_appearance_options",!0,"boolean")}(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=n?[{type:"selectbox",name:"class",label:"Class",items:ci($u(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})})}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(u)}(n,u,t)},c=Gu(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[i]},li("table")]}:{type:"panel",items:[i]};n.windowManager.open({title:"Table Properties",size:"normal",body:c,onSubmit:b(Ti,n,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})}function Di(t){return function(n){return In.from(n.dom.getParent(n.selection.getStart(),t)).map(nt.fromDom)}}function Ai(n){function t(){n.stopPropagation()}function e(){n.preventDefault()}var r=nt.fromDom(n.target),o=function(e,r){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(r.apply(null,n))}}(e,t);return function(n,t,e,r,o,u,i){return{target:d(n),x:d(t),y:d(e),stop:r,prevent:o,kill:u,raw:d(i)}}(r,n.clientX,n.clientY,t,e,o,n)}function Ni(n,t,e,r,o){var u=function(t,e){return function(n){t(n)&&e(Ai(n))}}(e,r);return n.dom().addEventListener(t,u,o),{unbind:b(Wc,n,t,u,o)}}function Ei(n,t,e){return function(n,t,e,r){return Ni(n,t,e,r,!1)}(n,t,zc,e)}var Ii=function(n,t,e){var r=n();return S(r,t).orThunk(function(){return In.from(r[0]).orThunk(e)}).map(function(n){return n.element()})},Bi=So("ephox-snooker").resolve,ki=Bi("resizer-bar"),Pi=Bi("resizer-rows"),Mi=Bi("resizer-cols"),_i=function(n,t){return Tn(t,n.section())},ji=function(e){return{is:function(n){return e===n},isValue:u,isError:s,getOr:d(e),getOrThunk:d(e),getOrDie:d(e),or:function(n){return ji(e)},orThunk:function(n){return ji(e)},fold:function(n,t){return t(e)},map:function(n){return ji(n(e))},mapError:function(n){return ji(e)},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOption:function(){return In.some(e)}}},Wi=function(e){return{is:s,isValue:s,isError:u,getOr:o,getOrThunk:function(n){return n()},getOrDie:function(){return function(n){return function(){throw new Error(n)}}(String(e))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,t){return n(e)},map:function(n){return Wi(e)},mapError:function(n){return Wi(n(e))},each:C,bind:function(n){return Wi(e)},exists:s,forall:u,toOption:In.none}},zi={value:ji,error:Wi,fromOption:function(n,t){return n.fold(function(){return Wi(t)},ji)}},Li=cr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Fi=ot({},Li),Ui=d(10),Hi=d(10),qi=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");return Be("required",o),ke(o),function(t){var e=Fn(t);D(o,function(n){return f(e,n)})||Ee(o,e),r(o,e);var n=v(o,function(n){return!u.validate(t[n],n)});return 0<n.length&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+Ne(n).join(", ")+") were not.")}(n,u.label),t}},Vi=Ou(["cell","row","replace","gap"]),Yi=function(t,e){void 0===e&&(e=Du),Vi(t);function r(n){return function(n){return t.cell(n)}(e(n))}function o(n){var t=r(n);return u.get().isNone()&&u.set(In.some(t)),i=In.some({item:n,replacement:t}),t}var u=x(In.none()),i=In.none();return{getOrInit:function(t,e){return i.fold(function(){return o(t)},function(n){return e(t,n.item)?n.replacement:o(t)})},cursor:u.get}},Ki=function(c,a){return function(r){var o=x(In.none());Vi(r);function u(n){var t={scope:c},e=r.replace(n,a,t);return i.push({item:n,sub:e}),o.get().isNone()&&o.set(In.some(e)),e}var i=[];return{replaceOrInit:function(t,e){return function(t,e){return S(i,function(n){return e(n.item,t)})}(t,e).fold(function(){return u(t)},function(n){return e(t,n.item)?n.sub:u(t)})},cursor:o.get}}},Gi=function(e){Vi(e);var n=x(In.none());return{combine:function(t){return n.get().isNone()&&n.set(In.some(t)),function(){var n=e.cell({element:d(t),colspan:d(1),rowspan:d(1)});return Z(n,"width"),Z(t,"width"),n}},cursor:n.get}},Xi=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],$i=Ae(),Ji=function(n,t,e){return In.from(n[t]).bind(function(n){return In.from(n.cells()[e]).bind(function(n){return In.from(n.element())})})},Qi=Uo(function(n,t,e,r){var o=t[0].row(),u=t[0].row(),i=_u(t),c=y(i,function(n,t){return tu(n,u,o,e,r.getOrInit)},n);return Mu(c,u,t[0].column())},Vo,C,C,Yi),Zi=Uo(function(n,t,e,r){var o=_u(t),u=o[o.length-1].row(),i=o[o.length-1].row()+o[o.length-1].rowspan(),c=y(o,function(n,t){return tu(n,i,u,e,r.getOrInit)},n);return Mu(c,i,t[0].column())},Vo,C,C,Yi),nc=Uo(function(n,t,e,r){var o=ju(t),u=o[0].column(),i=o[0].column(),c=y(o,function(n,t){return eu(n,i,u,e,r.getOrInit)},n);return Mu(c,t[0].row(),i)},Vo,zu,C,Yi),tc=Uo(function(n,t,e,r){var o=t[t.length-1].column(),u=t[t.length-1].column()+t[t.length-1].colspan(),i=ju(t),c=y(i,function(n,t){return eu(n,u,o,e,r.getOrInit)},n);return Mu(c,t[0].row(),u)},Vo,zu,C,Yi),ec=Uo(function(n,t,e,r){var o=ju(t),u=function(n,e,r){var t=p(n,function(n){var t=n.cells().slice(0,e).concat(n.cells().slice(r+1));return Tn(t,n.section())});return v(t,function(n){return 0<n.cells().length})}(n,o[0].column(),o[o.length-1].column()),i=Pu(u,t[0].row(),t[0].column());return ku(u,i)},Vo,zu,Bu,Yi),rc=Uo(function(n,t,e,r){var o=_u(t),u=function(n,t,e){return n.slice(0,t).concat(n.slice(e+1))}(n,o[0].row(),o[o.length-1].row()),i=Pu(u,t[0].row(),t[0].column());return ku(u,i)},Vo,C,Bu,Yi),oc=(Uo(function(n,t,e,r){var o=iu(n,t.column(),e,r.replaceOrInit);return Mu(o,t.row(),t.column())},Ho,C,C,Ki("row","th")),Uo(function(n,t,e,r){var o=iu(n,t.column(),e,r.replaceOrInit);return Mu(o,t.row(),t.column())},Ho,C,C,Ki(null,"td")),Uo(function(n,t,e,r){var o=cu(n,t.row(),e,r.replaceOrInit);return Mu(o,t.row(),t.column())},Ho,C,C,Ki("col","th")),Uo(function(n,t,e,r){var o=cu(n,t.row(),e,r.replaceOrInit);return Mu(o,t.row(),t.column())},Ho,C,C,Ki(null,"td")),Uo(function(n,t,e,r){var o=t.cells();Iu(o);var u=function(n,t,e,r){if(0===n.length)return n;for(var o=t.startRow();o<=t.finishRow();o++)for(var u=t.startCol();u<=t.finishCol();u++)Eo(n[o],u,Rn(r(),!1));return n}(n,t.bounds(),0,d(o[0]));return ku(u,In.from(o[0]))},function(n,t){return t.mergable()},C,C,Gi)),uc=Uo(function(n,t,e,r){var o=w(t,function(n,t){return Jo(n,t,e,r.combine(t))},n);return ku(o,In.from(t[0]))},function(n,t){return t.unmergable()},zu,C,Gi),ic=Uo(function(n,e,t,r){var o,u,i,c,a=(o=e.clipboard(),u=e.generators(),i=Ht(o),c=$t.generate(i),Wo(c,u,!0)),f=function(n,t){return{row:d(n),column:d(t)}}(e.row(),e.column());return Zo(f,n,a,e.generators(),t).fold(function(){return ku(n,In.some(e.element()))},function(n){var t=Pu(n,e.row(),e.column());return ku(n,t)})},function(t,e){return Lt(e.element()).bind(function(n){return Fo(t,n).map(function(n){return ot(ot({},n),{generators:e.generators,clipboard:e.clipboard})})})},zu,C,Yi),cc=Uo(function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[0].row(),i=Wu(t.clipboard(),t.generators(),o),c=nu(u,n,i,t.generators(),e),a=Pu(c,t.cells[0].row(),t.cells[0].column());return ku(c,a)},qo,C,C,Yi),ac=Uo(function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),i=Wu(t.clipboard(),t.generators(),o),c=nu(u,n,i,t.generators(),e),a=Pu(c,t.cells[0].row(),t.cells[0].column());return ku(c,a)},qo,C,C,Yi),fc=function(n){return nt.fromDom(n.getBody())},lc=function(t){return function(n){return Dt(n,fc(t))}},sc={isRtl:d(!1)},dc={isRtl:d(!0)},mc=function(n){return"rtl"===function(n){return"rtl"===J(n,"direction")?"rtl":"ltr"}(n)?dc:sc},gc={"border-collapse":"collapse",width:"100%"},pc={border:"1"},hc=function(n){return n.getParam("table_tab_navigation",!0,"boolean")},vc=function(n){var t=n.getParam("table_clone_elements");return kn(t)?In.some(t.split(/[ ,]/)):Array.isArray(t)?In.some(t):In.none()},bc=function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})},wc=function(n){n.fire("TableSelectionClear")},yc=function(l,n){function e(n){return"table"===Xn(fc(n))}function t(i,c,a,f){return function(n,t){Hu(n);var e=f(),r=nt.fromDom(l.getDoc()),o=oo(mc),u=Te(a,r,s);return c(n)?i(e,n,t,u,o).bind(function(n){return h(n.newRows(),function(n){Qu(l,n.dom())}),h(n.newCells(),function(n){Zu(l,n.dom())}),n.cursor().map(function(n){var t=l.dom.createRng();return t.setStart(n.dom(),0),t.setEnd(n.dom(),0),t})}):In.none()}}var s=vc(l);return{deleteRow:t(rc,function(n){var t=uo(n);return!1===e(l)||1<t.rows()},C,n),deleteColumn:t(ec,function(n){var t=uo(n);return!1===e(l)||1<t.columns()},C,n),insertRowsBefore:t(Qi,u,C,n),insertRowsAfter:t(Zi,u,C,n),insertColumnsBefore:t(nc,u,Ir,n),insertColumnsAfter:t(tc,u,Ir,n),mergeCells:t(oc,u,C,n),unmergeCells:t(uc,u,C,n),pasteRowsBefore:t(cc,u,C,n),pasteRowsAfter:t(ac,u,C,n),pasteCells:t(ic,u,C,n)}},Sc=tinymce.util.Tools.resolve("tinymce.util.Tools"),xc=b(si,"left center right"),Cc=b(si,"top middle bottom"),Rc=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Tc={normal:function(e,r){return{setAttrib:function(n,t){e.setAttrib(r,n,t)},setStyle:function(n,t){e.setStyle(r,n,t)}}},ifTruthy:function(e,r){return{setAttrib:function(n,t){t&&e.setAttrib(r,n,t)},setStyle:function(n,t){t&&e.setStyle(r,n,t)}}}},Oc=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Dc=tinymce.util.Tools.resolve("tinymce.Env"),Ac={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Nc=function(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)kn(e)?n.setStyle(t,e,r):n.setStyle(t,e);else if(t.children)for(var o=0;o<t.children.length;o++)Nc(n,t.children[o],e,r)},Ec=Di("th,td"),Ic=Di("th,td,caption"),Bc=Sc.each,kc=function(c,t,a,f,e){function l(n){return Gt(n,s)}function u(n){return{width:Lu(n.dom()),height:Lu(n.dom())}}function r(o){Ec(c).each(function(r){l(r).each(function(t){var n=He(f,t,r),e=u(t);o(t,n).each(function(n){!function(n,t,e){var r=u(e);t.width===r.width&&t.height===r.height||(ni(n,e.dom(),t.width,t.height),ti(n,e.dom(),r.width,r.height))}(c,e,t),c.selection.setRng(n),c.focus(),a.clear(t),Hu(t)})})})}function o(n){return Ec(c).map(function(o){return l(o).bind(function(n){var t=nt.fromDom(c.getDoc()),e=He(f,n,o),r=Te(C,t,In.none());return ei(n,e,r)})})}function i(i){e.get().each(function(n){var u=p(n,function(n){return ie(n)});Ec(c).each(function(o){l(o).each(function(t){var n=nt.fromDom(c.getDoc()),e=de(n),r=function(n,t,e,r,o){return{element:d(e),mergable:In.none,unmergable:In.none,selection:d(Fe(e,n)),clipboard:d(r),generators:d(o)}}(f,0,o,u,e);i(t,r).each(function(n){c.selection.setRng(n),c.focus(),a.clear(t)})})})})}var s=lc(c);Bc({mceTableSplitCells:function(){r(t.unmergeCells)},mceTableMergeCells:function(){r(t.mergeCells)},mceTableInsertRowBefore:function(){r(t.insertRowsBefore)},mceTableInsertRowAfter:function(){r(t.insertRowsAfter)},mceTableInsertColBefore:function(){r(t.insertColumnsBefore)},mceTableInsertColAfter:function(){r(t.insertColumnsAfter)},mceTableDeleteCol:function(){r(t.deleteColumn)},mceTableDeleteRow:function(){r(t.deleteRow)},mceTableCutRow:function(n){o().each(function(n){e.set(n),r(t.deleteRow)})},mceTableCopyRow:function(n){o().each(function(n){e.set(n)})},mceTablePasteRowBefore:function(n){i(t.pasteRowsBefore)},mceTablePasteRowAfter:function(n){i(t.pasteRowsAfter)},mceTableDelete:function(){Ic(c).each(function(n){Gt(n,s).filter(m(s)).each(function(n){var t=nt.fromText("");if(pn(n,t),It(n),c.dom.isEmpty(c.getBody()))c.setContent(""),c.selection.setCursorLocation();else{var e=c.dom.createRng();e.setStart(t.dom(),0),e.setEnd(t.dom(),0),c.selection.setRng(e),c.nodeChanged()}})})}},function(n,t){c.addCommand(t,n)}),Bc({mceInsertTable:b(Oi,c,!0),mceTableProps:b(Oi,c,!1),mceTableRowProps:b(Si,c),mceTableCellProps:b(bi,c)},function(n,t){c.addCommand(t,function(){n()})})},Pc=function(n){var t=In.from(n.dom().documentElement).map(nt.fromDom).getOr(n);return{parent:d(t),view:d(n),origin:d(no(0,0))}},Mc=function(n,t){return{parent:d(t),view:d(n),origin:d(no(0,0))}},_c=function(n){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return h(t,function(n,t){r[n]=d(e[t])}),r}}.apply(null,n),o=[];return{bind:function(n){if(n===undefined)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(t){o=v(o,function(n){return n!==t})},trigger:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=r.apply(null,n);h(o,function(n){n(e)})}}},jc=function(n){return{registry:E(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:E(n,function(n){return n.trigger})}},Wc=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},zc=d(!0),Lc=Ai,Fc=So("ephox-dragster").resolve,Uc=Ou(["compare","extract","mutate","sink"]),Hc=Ou(["element","start","stop","destroy"]),qc=Ou(["forceDrop","drop","move","delayDrop"]),Vc=Uc({compare:function(n,t){return no(t.left()-n.left(),t.top()-n.top())},extract:function(n){return In.some(no(n.x(),n.y()))},sink:function(n,t){var e=function(n){var t=ot({layerClass:Fc("blocker")},n),e=nt.fromTag("div");_(e,"role","presentation"),$(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),go(e,Fc("blocker")),go(e,t.layerClass);return{element:function(){return e},destroy:function(){It(e)}}}(t),r=Ei(e.element(),"mousedown",n.forceDrop),o=Ei(e.element(),"mouseup",n.drop),u=Ei(e.element(),"mousemove",n.move),i=Ei(e.element(),"mouseout",n.delayDrop);return Hc({element:e.element,start:function(n){Et(n,e.element())},stop:function(){It(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left(),t.top())}});function Yc(){var r=In.none(),e=jc({move:_c(["info"])});return{onEvent:function(n,t){t.extract(n).each(function(n){(function(t,e){var n=r.map(function(n){return t.compare(n,e)});return r=In.some(e),n})(t,n).each(function(n){e.trigger.move(n)})})},reset:function(){r=In.none()},events:e.registry}}function Kc(){var n=function r(){return{onEvent:C,reset:C}}(),t=Yc(),e=n;return{on:function(){e.reset(),e=t},off:function(){e.reset(),e=n},isOn:function(){return e===t},onEvent:function(n,t){e.onEvent(n,t)},events:t.events}}function Gc(t,e,n){function r(){f.stop(),i.isOn()&&(i.off(),u.trigger.stop())}var o=!1,u=jc({start:_c([]),stop:_c([])}),i=Kc(),c=function(e,r){var o=null;return{cancel:function(){null!==o&&(l.clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null!==o&&l.clearTimeout(o),o=l.setTimeout(function(){e.apply(null,n),o=null},r)}}}(r,200);function a(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];o&&e.apply(null,n)}}i.events.move.bind(function(n){e.mutate(t,n.info())});var f=e.sink(qc({forceDrop:r,drop:a(r),move:a(function(n){c.cancel(),i.onEvent(n,e)}),delayDrop:a(c.throttle)}),n);return{element:f.element,go:function(n){f.start(n),i.on(),u.trigger.start()},on:function(){o=!0},off:function(){o=!1},destroy:function(){f.destroy()},events:u.registry}}function Xc(){var e=jc({drag:_c(["xDelta","yDelta","target"])}),r=In.none(),n=function(){var e=jc({drag:_c(["xDelta","yDelta"])});return{mutate:function(n,t){e.trigger.drag(n,t)},events:e.registry}}();return n.events.drag.bind(function(t){r.each(function(n){e.trigger.drag(t.xDelta(),t.yDelta(),n)})}),{assign:function(n){r=In.some(n)},get:function(){return r},mutate:n.mutate,events:e.registry}}function $c(n){return"true"===W(n,"contenteditable")}function Jc(o,t,u){function n(n,t){return In.from(W(n,t))}var e=Xc(),r=function(n,t){void 0===t&&(t={});var e=t.mode!==undefined?t.mode:Vc;return Gc(n,e,t)}(e,{}),i=In.none();function c(n,t){return du(n,t)-parseInt(W(n,"data-initial-"+t),10)}function a(n,t){m.trigger.startAdjust(),e.assign(n),_(n,"data-initial-"+t,parseInt(J(n,t),10)),go(n,of),X(n,"opacity","0.2"),r.go(o.parent())}function f(n){return Dt(n,o.view())}function l(n){return Wt(n,"table",f).filter(function(n){return function(n,t){return Wt(n,"[contenteditable]",t)}(n,f).exists($c)})}e.events.drag.bind(function(e){n(e.target(),"data-row").each(function(n){var t=du(e.target(),"top");X(e.target(),"top",t+e.yDelta()+"px")}),n(e.target(),"data-column").each(function(n){var t=du(e.target(),"left");X(e.target(),"left",t+e.xDelta()+"px")})}),r.events.stop.bind(function(){e.get().each(function(r){i.each(function(e){n(r,"data-row").each(function(n){var t=c(r,"top");L(r,"data-initial-top"),m.trigger.adjustHeight(e,t,parseInt(n,10))}),n(r,"data-column").each(function(n){var t=c(r,"left");L(r,"data-initial-left"),m.trigger.adjustWidth(e,t,parseInt(n,10))}),Oo(o,e,u,t)})})});var s=Ei(o.parent(),"mousedown",function(n){!function(n){return ho(n,Pi)}(n.target())||a(n.target(),"top"),function(n){return ho(n,Mi)}(n.target())&&a(n.target(),"left")}),d=Ei(o.view(),"mouseover",function(n){l(n.target()).fold(function(){K(n.target())&&xo(o)},function(n){i=In.some(n),Oo(o,n,u,t)})}),m=jc({adjustHeight:_c(["table","delta","row"]),adjustWidth:_c(["table","delta","column"]),startAdjust:_c([])});return{destroy:function(){s.unbind(),d.unbind(),r.destroy(),xo(o)},refresh:function(n){Oo(o,n,u,t)},on:r.on,off:r.off,hideBars:b(Ao,o),showBars:b(No,o),events:m.registry}}function Qc(n,t){return n.inline?Mc(fc(n),function(){var n=nt.fromTag("div");return $(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Et(tt(),n),n}()):Pc(nt.fromDom(n.getDoc()))}function Zc(n,t){return Lu(n.dom())/Lu(t.dom())*100+"%"}function na(e,n){return Gt(e,n).bind(function(n){var t=Ft(n);return R(t,function(n){return Dt(e,n)}).map(function(n){return{index:d(n),all:d(t)}})})}function ta(n,t,e){var r=n.document.createRange();return function(e,n){n.fold(function(n){e.setStartBefore(n.dom())},function(n,t){e.setStart(n.dom(),t)},function(n){e.setStartAfter(n.dom())})}(r,t),function(e,n){n.fold(function(n){e.setEndBefore(n.dom())},function(n,t){e.setEnd(n.dom(),t)},function(n){e.setEndAfter(n.dom())})}(r,e),r}function ea(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom(),e),u.setEnd(r.dom(),o),u}function ra(n){return{left:d(n.left),top:d(n.top),right:d(n.right),bottom:d(n.bottom),width:d(n.width),height:d(n.height)}}function oa(n,t,e){return t(nt.fromDom(e.startContainer),e.startOffset,nt.fromDom(e.endContainer),e.endOffset)}function ua(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return hf.rtl(nt.fromDom(n.endContainer),n.endOffset,nt.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return oa(0,hf.ltr,e)}):oa(0,hf.ltr,e)}(0,function(o,n){return n.match({domRange:function(n){return{ltr:d(n),rtl:In.none}},relative:function(n,t){return{ltr:Y(function(){return ta(o,n,t)}),rtl:Y(function(){return In.some(ta(o,t,n))})}},exact:function(n,t,e,r){return{ltr:Y(function(){return ea(o,n,t,e,r)}),rtl:Y(function(){return In.some(ea(o,e,r,n,t))})}}})}(n,t))}function ia(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}function ca(e,r,n,t,o){function u(n){var t=e.dom().createRange();return t.setStart(r.dom(),n),t.collapse(!0),t}var i=Jt(r).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(t-c.left);if(e<=c.bottom){if(e<c.top||u<a)return i-1;u=a}}return 0}(function(n){return u(n).getBoundingClientRect()},n,t,o.right,i);return u(c)}function aa(n,t){return t-n.left<n.right-t}function fa(n,t,e){var r=n.dom().createRange();return r.selectNode(t.dom()),r.collapse(e),r}function la(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),u=aa(o,e);return(!0===u?ee:re)(n).map(function(n){return fa(t,n,u)})}function sa(n,t,e){var r=t.dom().getBoundingClientRect(),o=aa(r,e);return In.some(fa(n,t,o))}function da(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return bf(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))}function ma(n,t){var e=Xn(n);return"input"===e?df.after(n):f(["br","img"],e)?0===t?df.before(n):df.after(n):df.on(n,t)}function ga(n,t){var e=n.fold(df.before,ma,df.after),r=t.fold(df.before,ma,df.after);return gf.relative(e,r)}function pa(n,t,e,r){var o=ma(n,t),u=ma(e,r);return gf.relative(o,u)}function ha(n,t,e,r){var o=function(n,t,e,r){var o=cn(n).dom().createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o}(n,t,e,r),u=Dt(n,e)&&t===r;return o.collapsed&&!u}function va(n,t){In.from(n.getSelection()).each(function(n){n.removeAllRanges(),n.addRange(t)})}function ba(n,t,e,r,o){var u=ea(n,t,e,r,o);va(n,u)}function wa(i,n){return ua(i,n).match({ltr:function(n,t,e,r){ba(i,n,t,e,r)},rtl:function(n,t,e,r){var o=i.getSelection();if(o.setBaseAndExtent)o.setBaseAndExtent(n.dom(),t,e.dom(),r);else if(o.extend)try{!function(n,t,e,r,o,u){t.collapse(e.dom(),r),t.extend(o.dom(),u)}(0,o,n,t,e,r)}catch(u){ba(i,e,r,n,t)}else ba(i,e,r,n,t)}})}function ya(n,t,e,r,o){var u=pa(t,e,r,o);wa(n,u)}function Sa(n,t,e){var r=ga(t,e);wa(n,r)}function xa(n){function t(n,t,e,r){return ea(o,n,t,e,r)}var o=gf.getWin(n).dom(),e=function(n){return n.match({domRange:function(n){var t=nt.fromDom(n.startContainer),e=nt.fromDom(n.endContainer);return pa(t,n.startOffset,e,n.endOffset)},relative:ga,exact:pa})}(n);return ua(o,e).match({ltr:t,rtl:t})}function Ca(n){var t=nt.fromDom(n.anchorNode),e=nt.fromDom(n.focusNode);return ha(t,n.anchorOffset,e,n.focusOffset)?In.some(lf(t,n.anchorOffset,e,n.focusOffset)):function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return In.some(lf(nt.fromDom(t.startContainer),t.startOffset,nt.fromDom(e.endContainer),e.endOffset))}return In.none()}(n)}function Ra(n,t){var e=function(n,t){var e=n.document.createRange();return pf(e,t),e}(n,t);va(n,e)}function Ta(n){return function(n){return In.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(Ca)}(n).map(function(n){return gf.exact(n.start(),n.soffset(),n.finish(),n.foffset())})}function Oa(n,t){return function(n){var t=n.getClientRects(),e=0<t.length?t[0]:n.getBoundingClientRect();return 0<e.width||0<e.height?In.some(e).map(ra):In.none()}(vf(n,t))}function Da(n,t,e){return function(n,t,e){var r=nt.fromDom(n.document);return wf(r,t,e).map(function(n){return lf(nt.fromDom(n.startContainer),n.startOffset,nt.fromDom(n.endContainer),n.endOffset)})}(n,t,e)}function Aa(n,t,e,r){return Sf(n,t,function(t,n){return na(t,n).fold(function(){return ff.none(t)},function(n){return n.index()+1<n.all().length?ff.middle(t,n.all()[n.index()+1]):ff.last(t)})}(e),r)}function Na(n,t,e,r){return Sf(n,t,function(t,n){return na(t,n).fold(function(){return ff.none()},function(n){return 0<=n.index()-1?ff.middle(t,n.all()[n.index()-1]):ff.first(t)})}(e),r)}function Ea(n,t){var e=gf.exact(t,0,t,0);return xa(e)}function Ia(n,t){return function(n){return 0===n.length?In.none():In.some(n[n.length-1])}(An(t,"tr")).bind(function(n){return jt(n,"td,th").map(function(n){return Ea(0,n)})})}function Ba(n,t){var e=vf(n,t);return lf(nt.fromDom(e.startContainer),e.startOffset,nt.fromDom(e.endContainer),e.endOffset)}function ka(n,t){return{item:d(n),mode:d(t)}}function Pa(n,t,e,r){return void 0===r&&(r=Af),n.property().parent(t).map(function(n){return ka(n,r)})}function Ma(t){return function(n){return 0===t.property().children(n).length}}function _a(n,t){return function(n,t,e){return Mf(n,t,Ma(n),e)}(jf,n,t)}function ja(n,t){return function(n,t,e){return _f(n,t,Ma(n),e)}(jf,n,t)}function Wa(n,t){return{element:d(n),offset:d(t)}}function za(n){return Wt(n,"tr")}function La(r){return an(r).bind(function(t){var e=dn(t);return Lf(e,r).map(function(n){return function(n,t,e,r){return{parent:d(n),children:d(t),element:d(e),index:d(r)}}(t,e,r,n)})})}function Fa(n){return"br"===Xn(n)}function Ua(t,n,e,r){return function(n,t){return mn(n,t).filter(Fa).orThunk(function(){return mn(n,t-1).filter(Fa)})}(n,e).bind(function(n){return r.traverse(n).fold(function(){return Ff(n,r.gather,t).map(r.relative)},function(n){return La(n).map(function(n){return df.on(n.parent(),n.index())})})})}function Ha(n,t,e,r){return(Fa(t)?function(n,t,e){return e.traverse(t).orThunk(function(){return Ff(t,e.gather,n)}).map(e.relative)}(n,t,r):Ua(n,t,e,r)).map(function(n){return{start:d(n),finish:d(n)}})}function qa(n){return Hf.nu({left:n.left,top:n.top,right:n.right,bottom:n.bottom})}function Va(n,t){return In.some(n.getRect(t))}function Ya(n,t,e){return $n(t)?Va(n,t).map(qa):Jn(t)?function(n,t,e){return 0<=e&&e<ne(t)?n.getRangedRect(t,e,t,e+1):0<e?n.getRangedRect(t,e-1,t,e):In.none()}(n,t,e).map(qa):In.none()}function Ka(n,t){return $n(t)?Va(n,t).map(qa):Jn(t)?n.getRangedRect(t,0,t,ne(t)).map(qa):In.none()}function Ga(t,n,e){return function(n,t,e){return kt(function(n,t){return t(n)},Pt,n,t,e)}(n,Au).fold(d(!1),function(n){return Ka(t,n).exists(function(n){return function(n,t){return n.left()<t.left()||Math.abs(t.right()-n.left())<1||n.left()>t.right()}(e,n)})})}function Xa(t,e,n){var r=t.move(n,5),o=Kf(e,t,n,r,100).getOr(r);return function(n,t,e){return n.point(t)>e.getInnerHeight()?In.some(n.point(t)-e.getInnerHeight()):n.point(t)<0?In.some(-n.point(t)):In.none()}(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})}function $a(r,o,u){return r.getSelection().bind(function(e){return Ha(o,e.finish(),e.foffset(),u).fold(function(){return In.some(Wa(e.finish(),e.foffset()))},function(n){var t=r.fromSitus(n);return function(n){return zf.cata(n,function(n){return In.none()},function(){return In.none()},function(n){return In.some(Wa(n,0))},function(n){return In.some(Wa(n,ne(n)))})}(zf.verify(r,e.finish(),e.foffset(),t.finish(),t.foffset(),u.failure,o))})})}function Ja(n,t){return function(n,t,e){return Pt(n,t,e).isSome()}(n,function(n){return an(n).exists(function(n){return Dt(n,t)})})}function Qa(t,r,o,n,u){return Wt(n,"td,th",r).bind(function(e){return Wt(e,"table",r).bind(function(n){return Ja(u,n)?function(t,e,r){return $a(t,e,r).bind(function(n){return $f(t,e,n.element(),n.offset(),r,20).map(t.fromSitus)})}(t,r,o).bind(function(t){return Wt(t.finish(),"td,th",r).map(function(n){return{start:d(e),finish:d(n),range:d(t)}})}):In.none()})})}function Za(n,t,e,r,o,u){return nl.browser.isIE()?In.none():u(r,t).orThunk(function(){return Qa(n,t,e,r,o).map(function(n){var t=n.range();return Rf(In.some(Of(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})}function nf(n,r){return Wt(n,"tr",r).bind(function(e){return Wt(e,"table",r).bind(function(n){var t=An(n,"tr");return Dt(e,t[0])?function(n,t,e){return Mf(jf,n,t,e)}(n,function(n){return re(n).isSome()},r).map(function(n){var t=ne(n);return Rf(In.some(Of(n,t,n,t)),!0)}):In.none()})})}function tf(n,r){return Wt(n,"tr",r).bind(function(e){return Wt(e,"table",r).bind(function(n){var t=An(n,"tr");return Dt(e,t[t.length-1])?function(n,t,e){return _f(jf,n,t,e)}(n,function(n){return ee(n).isSome()},r).map(function(n){return Rf(In.some(Of(n,0,n,0)),!0)}):In.none()})})}function ef(n,t,e,r,o,u,i){return Qa(n,e,r,o,u).bind(function(n){return Df(t,e,n.start(),n.finish(),i)})}function rf(n,t){return Wt(n,"td,th",t)}var of=Bi("resizer-bar-dragging"),uf=function(n,e){var r=eo.height,t=Jc(n,e,r),o=jc({beforeResize:_c(["table"]),afterResize:_c(["table"]),startDrag:_c([])});return t.events.adjustHeight.bind(function(n){o.trigger.beforeResize(n.table());var t=r.delta(n.delta(),n.table());Ru(n.table(),t,n.row(),r),o.trigger.afterResize(n.table())}),t.events.startAdjust.bind(function(n){o.trigger.startDrag()}),t.events.adjustWidth.bind(function(n){o.trigger.beforeResize(n.table());var t=e.delta(n.delta(),n.table());!function(n,t,e,r){var o=Su(n),u=o.getCellDelta(t),i=Cu(n),c=o.getWidths(i,r,o),a=au(c,e,u,o),f=p(a,function(n,t){return n+c[t]}),l=bu(i,f);h(l,function(n){o.setElementWidth(n.element(),n.width())}),e===i.grid().columns()-1&&o.setTableWidth(n,f,u)}(n.table(),t,n.column(),e),o.trigger.afterResize(n.table())}),{on:t.on,off:t.off,hideBars:t.hideBars,showBars:t.showBars,destroy:t.destroy,events:o.registry}},cf=function(i){function c(n){return"TABLE"===n.nodeName}function r(n){var t=i.dom.getStyle(n,"width")||i.dom.getAttrib(n,"width");return In.from(t).filter(function(n){return 0<n.length})}function n(){return u}var a,f,o=In.none(),u=In.none(),l=In.none(),s=/(\d+(\.\d+)?)%/;return i.on("init",function(){var n=oo(mc),t=Qc(i);if(l=In.some(t),function(n){var t=n.getParam("object_resizing",!0);return kn(t)?"table"===t:t}(i)&&function(n){return n.getParam("table_resize_bars",!0,"boolean")}(i)){var e=uf(t,n);e.on(),e.events.startDrag.bind(function(n){o=In.some(i.selection.getRng())}),e.events.beforeResize.bind(function(n){var t=n.table().dom();ni(i,t,Lu(t),Fu(t))}),e.events.afterResize.bind(function(n){var t=n.table(),e=t.dom();Hu(t),o.each(function(n){i.selection.setRng(n),i.focus()}),ti(i,e,Lu(e),Fu(e)),i.undoManager.add()}),u=In.some(e)}}),i.on("ObjectResizeStart",function(n){var t=n.target;if(c(t)){var e=r(t).map(function(n){return s.test(n)}).getOr(!1);e&&Ju(i)?function(n){X(nt.fromDom(n),"width",Lu(n).toString()+"px")}(t):!e&&function(n){return!0===n.getParam("table_responsive_width")}(i)&&function(n){var t=nt.fromDom(n);an(t).map(function(n){return Zc(t,n)}).each(function(n){X(t,"width",n),h(An(t,"tr"),function(t){h(dn(t),function(n){X(n,"width",Zc(n,t))})})})}(t),a=n.width,f=r(t).getOr("")}}),i.on("ObjectResized",function(n){var t=n.target;if(c(t)){var e=t;if(s.test(f)){var r=parseFloat(s.exec(f)[1]),o=n.width*r/a;i.dom.setStyle(e,"width",o+"%")}else{var u=[];Sc.each(e.rows,function(n){Sc.each(n.cells,function(n){var t=i.dom.getStyle(n,"width",!0);u.push({cell:n,width:t})})}),Sc.each(u,function(n){i.dom.setStyle(n.cell,"width",n.width),i.dom.setAttrib(n.cell,"width",null)})}}}),i.on("SwitchMode",function(){n().each(function(n){i.mode.isReadOnly()?n.hideBars():n.showBars()})}),{lazyResize:n,lazyWire:function(){return l.getOr(Pc(nt.fromDom(i.getBody())))},destroy:function(){u.each(function(n){n.destroy()}),l.each(function(n){!function(n,t){n.inline&&It(t.parent())}(i,n)})}}},af=cr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),ff=ot(ot({},af),{none:function(n){return void 0===n&&(n=undefined),af.none(n)}}),lf=function(n,t,e,r){return{start:d(n),soffset:d(t),finish:d(e),foffset:d(r)}},sf=cr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),df={before:sf.before,on:sf.on,after:sf.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(o,o,o)}},mf=cr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),gf={domRange:mf.domRange,relative:mf.relative,exact:mf.exact,exactFromRange:function(n){return mf.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){return function(n){return nt.fromDom(n.dom().ownerDocument.defaultView)}(function(n){return n.match({domRange:function(n){return nt.fromDom(n.startContainer)},relative:function(n,t){return df.getStart(n)},exact:function(n,t,e,r){return n}})}(n))},range:lf},pf=function(n,t){n.selectNodeContents(t.dom())},hf=cr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),vf=function(u,n){return ua(u,n).match({ltr:function(n,t,e,r){var o=u.document.createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o},rtl:function(n,t,e,r){var o=u.document.createRange();return o.setStart(e.dom(),r),o.setEnd(n.dom(),t),o}})},bf=(hf.ltr,hf.rtl,function(n,t,e,r){return Jn(t)?function(t,e,r,o){var n=t.dom().createRange();n.selectNode(e.dom());var u=n.getClientRects();return A(u,function(n){return ia(n,r,o)?In.some(n):In.none()}).map(function(n){return ca(t,e,r,o,n)})}(n,t,e,r):function(t,n,e,r){var o=t.dom().createRange(),u=dn(n);return A(u,function(n){return o.selectNode(n.dom()),ia(o.getBoundingClientRect(),e,r)?bf(t,n,e,r):In.none()})}(n,t,e,r)}),wf=document.caretPositionFromPoint?function(e,n,t){return In.from(e.dom().caretPositionFromPoint(n,t)).bind(function(n){if(null===n.offsetNode)return In.none();var t=e.dom().createRange();return t.setStart(n.offsetNode,n.offset),t.collapse(),In.some(t)})}:document.caretRangeFromPoint?function(n,t,e){return In.from(n.dom().caretRangeFromPoint(t,e))}:function(e,r,o){return nt.fromPoint(e,r,o).bind(function(n){function t(){return function(n,t,e){return(0===dn(t).length?sa:la)(n,t,e)}(e,n,r)}return 0===dn(n).length?t():da(e,n,r,o).orThunk(t)})},yf=tinymce.util.Tools.resolve("tinymce.util.VK"),Sf=function(r,n,t,o,e){return t.fold(In.none,In.none,function(n,t){return ee(t).map(function(n){return Ea(0,n)})},function(e){return Gt(e,n).bind(function(n){var t=Ue(e);return r.undoManager.transact(function(){o.insertRowsAfter(n,t)}),Ia(0,n)})})},xf=["table","li","dl"],Cf=function(t,e,r,o){if(t.keyCode===yf.TAB){var u=fc(e),i=function(n){var t=Xn(n);return Dt(n,u)||f(xf,t)},n=e.selection.getRng();if(n.collapsed){var c=nt.fromDom(n.startContainer);Lt(c,i).each(function(n){t.preventDefault(),(t.shiftKey?Na:Aa)(e,i,n,r,o).each(function(n){e.selection.setRng(n)})})}}},Rf=function(n,t){return{selection:d(n),kill:d(t)}},Tf=function(n,t,e,r){return{start:d(df.on(n,t)),finish:d(df.on(e,r))}},Of=Tf,Df=function(e,n,r,t,o){return Dt(r,t)?In.none():Me(r,t,n).bind(function(n){var t=n.boxes().getOr([]);return 0<t.length?(o(e,t,n.start(),n.finish()),In.some(Rf(In.some(Of(r,0,r,ne(r))),!0))):In.none()})},Af=function(n,t,e,r){return void 0===r&&(r=Nf),e.sibling(n,t).map(function(n){return ka(n,r)})},Nf=function(n,t,e,r){void 0===r&&(r=Nf);var o=n.property().children(t);return e.first(o).map(function(n){return ka(n,r)})},Ef=[{current:Pa,next:Af,fallback:In.none()},{current:Af,next:Nf,fallback:In.some(Pa)},{current:Nf,next:Nf,fallback:In.some(Af)}],If=function(t,e,r,o,n){return void 0===n&&(n=Ef),S(n,function(n){return n.current===r}).bind(function(n){return n.current(t,e,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return If(t,e,n,o)})})})},Bf=function(){return{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return 0<n.length?In.some(n[n.length-1]):In.none()}}},kf=function(){return{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return 0<n.length?In.some(n[0]):In.none()}}},Pf=function(t,n,e,r,o,u){return If(t,n,r,o).bind(function(n){return u(n.item())?In.none():e(n.item())?In.some(n.item()):Pf(t,n.item(),e,n.mode(),o,u)})},Mf=function(n,t,e,r){return Pf(n,t,e,Af,Bf(),r)},_f=function(n,t,e,r){return Pf(n,t,e,Af,kf(),r)},jf=Ae(),Wf=cr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),zf=ot(ot({},Wf),{verify:function(e,t,n,r,o,u,i){return Wt(r,"td,th",i).bind(function(n){return Wt(t,"td,th",i).map(function(t){return Dt(n,t)?Dt(r,n)&&ne(n)===o?u(t):Wf.none("in same cell"):Xe(za,[n,t]).fold(function(){return function(n,t,e){var r=n.getRect(t),o=n.getRect(e);return o.right>r.left&&o.left<r.right}(e,t,n)?Wf.success():u(t)},function(n){return u(t)})})}).getOr(Wf.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),Lf=function(n,t){return R(n,b(Dt,t))},Ff=function(n,t,e){return t(n,e).bind(function(n){return Jn(n)&&0===Jt(n).trim().length?Ff(n,t,e):In.some(n)})},Uf=$e(["left","top","right","bottom"],[]),Hf={nu:Uf,moveUp:function(n,t){return Uf({left:n.left(),top:n.top()-t,right:n.right(),bottom:n.bottom()-t})},moveDown:function(n,t){return Uf({left:n.left(),top:n.top()+t,right:n.right(),bottom:n.bottom()+t})},moveBottomTo:function(n,t){var e=n.bottom()-n.top();return Uf({left:n.left(),top:t-e,right:n.right(),bottom:t})},moveTopTo:function(n,t){var e=n.bottom()-n.top();return Uf({left:n.left(),top:t,right:n.right(),bottom:t+e})},getTop:function(n){return n.top()},getBottom:function(n){return n.bottom()},translate:function(n,t,e){return Uf({left:n.left()+t,top:n.top()+e,right:n.right()+t,bottom:n.bottom()+e})},toString:function(n){return"("+n.left()+", "+n.top()+") -> ("+n.right()+", "+n.bottom()+")"}},qf=cr([{none:[]},{retry:["caret"]}]),Vf={point:Hf.getTop,adjuster:function(n,t,e,r,o){var u=Hf.moveUp(o,5);return Math.abs(e.top()-r.top())<1?qf.retry(u):e.bottom()<o.top()?qf.retry(u):e.bottom()===o.top()?qf.retry(Hf.moveUp(o,1)):Ga(n,t,o)?qf.retry(Hf.translate(u,5,0)):qf.none()},move:Hf.moveUp,gather:_a},Yf={point:Hf.getBottom,adjuster:function(n,t,e,r,o){var u=Hf.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1?qf.retry(u):e.top()>o.bottom()?qf.retry(u):e.top()===o.bottom()?qf.retry(Hf.moveDown(o,1)):Ga(n,t,o)?qf.retry(Hf.translate(u,5,0)):qf.none()},move:Hf.moveDown,gather:ja},Kf=function(e,r,o,u,i){return 0===i?In.some(u):function(n,t,e){return n.elementFromPoint(t,e).filter(function(n){return"table"===Xn(n)}).isSome()}(e,u.left(),r.point(u))?function(n,t,e,r,o){return Kf(n,t,e,t.move(r,5),o)}(e,r,o,u,i-1):e.situsFromPoint(u.left(),r.point(u)).bind(function(n){return n.start().fold(In.none,function(t){return Ka(e,t).bind(function(n){return r.adjuster(e,t,n,o,u).fold(In.none,function(n){return Kf(e,r,o,n,i-1)})}).orThunk(function(){return In.some(u)})},In.none)})},Gf={tryUp:b(Xa,Vf),tryDown:b(Xa,Yf),ieTryUp:function(n,t){return n.situsFromPoint(t.left(),t.top()-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left(),t.bottom()+5)},getJumpSize:d(5)},Xf=rn(),$f=function(r,o,u,i,c,a){return 0===a?In.none():Zf(r,o,u,i,c).bind(function(n){var t=r.fromSitus(n),e=zf.verify(r,u,i,t.finish(),t.foffset(),c.failure,o);return zf.cata(e,function(){return In.none()},function(){return In.some(n)},function(n){return Dt(u,n)&&0===i?Jf(r,u,i,Hf.moveUp,c):$f(r,o,n,0,c,a-1)},function(n){return Dt(u,n)&&i===ne(n)?Jf(r,u,i,Hf.moveDown,c):$f(r,o,n,ne(n),c,a-1)})})},Jf=function(t,n,e,r,o){return Ya(t,n,e).bind(function(n){return Qf(t,o,r(n,Gf.getJumpSize()))})},Qf=function(n,t,e){return Xf.browser.isChrome()||Xf.browser.isSafari()||Xf.browser.isFirefox()||Xf.browser.isEdge()?t.otherRetry(n,e):Xf.browser.isIE()?t.ieRetry(n,e):In.none()},Zf=function(t,n,e,r,o){return Ya(t,e,r).bind(function(n){return Qf(t,o,n)})},nl=rn();function tl(t){return function(n){return n===t}}function el(c){return{elementFromPoint:function(n,t){return nt.fromPoint(nt.fromDom(c.document),n,t)},getRect:function(n){return n.dom().getBoundingClientRect()},getRangedRect:function(n,t,e,r){var o=gf.exact(n,t,e,r);return Oa(c,o).map(dl)},getSelection:function(){return Ta(c).map(function(n){return Ba(c,n)})},fromSitus:function(n){var t=gf.relative(n.start(),n.finish());return Ba(c,t)},situsFromPoint:function(n,t){return Da(c,n,t).map(function(n){return Tf(n.start(),n.soffset(),n.finish(),n.foffset())})},clearSelection:function(){!function(n){n.getSelection().removeAllRanges()}(c)},collapseSelection:function(i){void 0===i&&(i=!1),Ta(c).each(function(n){return n.fold(function(n){return n.collapse(i)},function(n,t){var e=i?n:t;Sa(c,e,e)},function(n,t,e,r){var o=i?n:e,u=i?t:r;ya(c,o,u,o,u)})})},setSelection:function(n){ya(c,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,t){Sa(c,n,t)},selectContents:function(n){Ra(c,n)},getInnerHeight:function(){return c.innerHeight},getScrollY:function(){return function(n){var t=n!==undefined?n.dom():l.document,e=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return no(e,r)}(nt.fromDom(c.document)).top()},scrollBy:function(n,t){!function(n,t,e){(e!==undefined?e.dom():l.document).defaultView.scrollBy(n,t)}(n,t,nt.fromDom(c.document))}}}function rl(n,t){return{rows:n,cols:t}}function ol(t,n){h(n,function(n){!function(n,t){lo(n)?n.dom().classList.remove(t):mo(n,t);po(n)}(t,n)})}var ul={traverse:sn,gather:ja,relative:df.before,otherRetry:Gf.tryDown,ieRetry:Gf.ieTryDown,failure:zf.failedDown},il={traverse:ln,gather:_a,relative:df.before,otherRetry:Gf.tryUp,ieRetry:Gf.ieTryUp,failure:zf.failedUp},cl=tl(38),al=tl(40),fl=function(n){return 37<=n&&n<=40},ll={isBackward:tl(37),isForward:tl(39)},sl={isBackward:tl(39),isForward:tl(37)},dl=function(n){return{left:n.left(),top:n.top(),right:n.right(),bottom:n.bottom(),width:n.width(),height:n.height()}},ml=(rn().browser.isSafari(),function(n,t,e,r){var o=function c(o,u,t,i){function e(){r=In.none()}var r=In.none();return{mousedown:function(n){i.clear(u),r=rf(n.target(),t)},mouseover:function(n){r.each(function(r){i.clearBeforeUpdate(u),rf(n.target(),t).each(function(e){Me(r,e,t).each(function(n){var t=n.boxes().getOr([]);(1<t.length||1===t.length&&!Dt(r,e))&&(i.selectRange(u,t,n.start(),n.finish()),o.selectContents(e))})})})},mouseup:function(n){r.each(e)}}}(el(n),t,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}),gl=function(n,f,l,s){function d(){return s.clear(f),In.none()}var m=el(n);return{keydown:function(n,t,e,r,o,u){var i=n.raw(),c=i.which,a=!0===i.shiftKey;return _e(f,s.selectedSelector).fold(function(){return al(c)&&a?b(ef,m,f,l,ul,r,t,s.selectRange):cl(c)&&a?b(ef,m,f,l,il,r,t,s.selectRange):al(c)?b(Za,m,l,ul,r,t,tf):cl(c)?b(Za,m,l,il,r,t,nf):In.none},function(t){function n(n){return function(){return A(n,function(n){return function(n,t,e,r,o){return We(r,n,t,o.firstSelectedSelector,o.lastSelectedSelector).map(function(n){return o.clearBeforeUpdate(e),o.selectRange(e,n.boxes(),n.start(),n.finish()),n.boxes()})}(n.rows,n.cols,f,t,s)}).fold(function(){return je(f,s.firstSelectedSelector,s.lastSelectedSelector).map(function(n){var t=al(c)||u.isForward(c)?df.after:df.before;return m.setRelativeSelection(df.on(n.first(),0),t(n.table())),s.clear(f),Rf(In.none(),!0)})},function(n){return In.some(Rf(In.none(),!0))})}}return al(c)&&a?n([rl(1,0)]):cl(c)&&a?n([rl(-1,0)]):u.isBackward(c)&&a?n([rl(0,-1),rl(-1,0)]):u.isForward(c)&&a?n([rl(0,1),rl(1,0)]):fl(c)&&!1==a?d:In.none})()},keyup:function(e,r,o,u,i){return _e(f,s.selectedSelector).fold(function(){var n=e.raw(),t=n.which;return!1==(!0===n.shiftKey)?In.none():fl(t)?function(e,r,n,t,o,u,i){return Dt(n,o)&&t===u?In.none():Wt(n,"td,th",r).bind(function(t){return Wt(o,"td,th",r).bind(function(n){return Df(e,r,t,n,i)})})}(f,l,r,o,u,i,s.selectRange):In.none()},In.none)}}},pl=function(n,r,t,o){var u=el(n);return function(n,e){o.clearBeforeUpdate(r),Me(n,e,t).each(function(n){var t=n.boxes().getOr([]);o.selectRange(r,t,n.start(),n.finish()),u.selectContents(e),u.collapseSelection()})}},hl={byClass:function(o){function u(n){var t=An(n,o.selectedSelector);h(t,e)}var i=function(t){return function(n){go(n,t)}}(o.selected),e=function(t){return function(n){ol(n,t)}}([o.selected,o.lastSelected,o.firstSelected]);return{clearBeforeUpdate:u,clear:u,selectRange:function(n,t,e,r){u(n),h(t,i),go(e,o.firstSelected),go(r,o.lastSelected)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},byAttr:function(o,u,t){function e(n){L(n,o.selected),L(n,o.firstSelected),L(n,o.lastSelected)}function i(n){_(n,o.selected,"1")}function c(n){r(n),t()}var r=function(n){var t=An(n,o.selectedSelector);h(t,e)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,t,e,r){c(n),h(t,i),_(e,o.firstSelected,"1"),_(r,o.lastSelected,"1"),u(t,e,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}}},vl=function(n,t,e){var r=Ht(n),o=$t.generate(r);return Vo(o,t).map(function(n){var t=Wo(o,e,!1);return{upOrLeftCells:function(n,e,t){var r=n.slice(0,e[e.length-1].row()+1),o=Lo(r,t);return O(o,function(n){var t=n.cells().slice(0,e[e.length-1].column()+1);return p(t,function(n){return n.element()})})}(t,n,e),downOrRightCells:function(n,e,t){var r=n.slice(e[0].row()+e[0].rowspan()-1,n.length),o=Lo(r,t);return O(o,function(n){var t=n.cells().slice(e[0].column()+e[0].colspan()-1,+n.cells().length);return p(t,function(n){return n.element()})})}(t,n,e)}})},bl=function(n){return!1===ho(nt.fromDom(n.target),"ephox-snooker-resizer-bar")};function wl(v,b,n){var w=$e(["mousedown","mouseover","mouseup","keyup","keydown"],[]),y=In.none(),a=vc(v),S=hl.byAttr(ir,function(u,i,c){n.targets().each(function(o){Gt(i).each(function(n){var t=nt.fromDom(v.getDoc()),e=Te(C,t,a),r=vl(n,o,e);bc(v,u,i,c,r)})})},function(){wc(v)});v.on("init",function(n){var r=v.getWin(),o=fc(v),t=lc(v),e=ml(r,o,t,S),c=gl(r,o,t,S),u=pl(r,o,t,S);v.on("TableSelectorChange",function(n){u(n.start,n.finish)});function a(n,t){!function(n){return!0===n.raw().shiftKey}(n)||(t.kill()&&n.kill(),t.selection().each(function(n){var t=gf.relative(n.start(),n.finish()),e=vf(r,t);v.selection.setRng(e)}))}function i(n){var t=Lc(n);if(t.raw().shiftKey&&fl(t.raw().which)){var e=v.selection.getRng(),r=nt.fromDom(e.startContainer),o=nt.fromDom(e.endContainer);c.keyup(t,r,e.startOffset,o,e.endOffset).each(function(n){a(t,n)})}}function f(n){var t=Lc(n);b().each(function(n){n.hideBars()});var e=v.selection.getRng(),r=nt.fromDom(v.selection.getStart()),o=nt.fromDom(e.startContainer),u=nt.fromDom(e.endContainer),i=mc(r).isRtl()?sl:ll;c.keydown(t,o,e.startOffset,u,e.endOffset,i).each(function(n){a(t,n)}),b().each(function(n){n.showBars()})}function l(n){return 0===n.button}function s(n){l(n)&&bl(n)&&e.mousedown(Lc(n))}function d(n){(function(n){return n.buttons===undefined||(!(!Dc.browser.isEdge()||0!==n.buttons)||0!=(1&n.buttons))})(n)&&bl(n)&&e.mouseover(Lc(n))}function m(n){l(n)&&bl(n)&&e.mouseup(Lc(n))}var g,p,h=(g=x(nt.fromDom(o)),p=x(0),{touchEnd:function(n){var t=nt.fromDom(n.target);if("td"===Xn(t)||"th"===Xn(t)){var e=g.get(),r=p.get();Dt(e,t)&&n.timeStamp-r<300&&(n.preventDefault(),u(t,t))}g.set(t),p.set(n.timeStamp)}});v.on("mousedown",s),v.on("mouseover",d),v.on("mouseup",m),v.on("touchend",h.touchEnd),v.on("keyup",i),v.on("keydown",f),v.on("NodeChange",function(){var n=v.selection,t=nt.fromDom(n.getStart()),e=nt.fromDom(n.getEnd());Xe(Gt,[t,e]).fold(function(){S.clear(o)},C)}),y=In.some(w({mousedown:s,mouseover:d,mouseup:m,keyup:i,keydown:f}))});return{clear:S.clear,destroy:function(){y.each(function(n){})}}}var yl=function(n){return{get:function(){return function(n,t){return _e(n,t)}(fc(n),nr).fold(function(){return n.selection.getStart()===undefined?fr():sr(n.selection)},function(n){return lr(n)})}}},Sl=function(n,e){function t(){return Ic(n).bind(function(t){return Gt(t).map(function(n){return"caption"===Xn(t)?function(n){return Ue(n)}(t):He(e,n,t)})})}function r(){u.set(Y(t)()),h(i.get(),function(n){return n()})}function o(t,e){function r(){return u.get().fold(function(){t.setDisabled(!0)},function(n){t.setDisabled(e(n))})}return r(),i.set(i.get().concat([r])),function(){i.set(v(i.get(),function(n){return n!==r}))}}var u=x(In.none()),i=x([]);return n.on("NodeChange TableSelectorChange",r),{onSetupTable:function(n){return o(n,function(n){return!1})},onSetupCellOrRow:function(n){return o(n,function(n){return"caption"===Xn(n.element())})},onSetupMergeable:function(n){return o(n,function(n){return n.mergable().isNone()})},onSetupUnmergeable:function(n){return o(n,function(n){return n.unmergable().isNone()})},resetTargets:r,targets:function(){return u.get()}}},xl=function(t,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});function e(n){return function(){return t.execCommand(n)}}t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})},Cl=function(t){var n=function(n){return n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(t);0<n.length&&t.ui.registry.addContextToolbar("table",{predicate:function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},items:n,scope:"node",position:"node"})},Rl=function(r,n){function t(n){return function(){return r.execCommand(n)}}function e(n){var t=n.numRows,e=n.numColumns;r.undoManager.transact(function(){Ri(r,e,t)}),r.addVisual()}var o={text:"Table properties",onSetup:n.onSetupTable,onAction:t("mceTableProps")},u={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:t("mceTableDelete")},i=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:t("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:t("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:t("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:t("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:t("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:t("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:t("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:t("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return i}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:t("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:t("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:t("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}],f={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},l=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:t("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:t("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:t("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return l}};!1===function(n){return n.getParam("table_grid",!0,"boolean")}(r)?r.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:t("mceInsertTable")}):r.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:e}]}}),r.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:t("mceInsertTable")}),r.ui.registry.addMenuItem("tableprops",o),r.ui.registry.addMenuItem("deletetable",u),r.ui.registry.addNestedMenuItem("row",c),r.ui.registry.addNestedMenuItem("column",f),r.ui.registry.addNestedMenuItem("cell",s),r.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(function(){return""},function(n){return"caption"===Xn(n.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})},Tl=function(e,t,n,r){return{insertTable:function(n,t){return Ri(e,n,t)},setClipboardRows:function(n){return function(n,t){var e=p(n,nt.fromDom);t.set(In.from(e))}(n,t)},getClipboardRows:function(){return function(n){return n.get().fold(function(){},function(n){return p(n,function(n){return n.dom()})})}(t)},resizeHandler:n,selectionTargets:r}};function Ol(t){var n=yl(t),e=Sl(t,n),r=cf(t),o=wl(t,r.lazyResize,e),u=yc(t,r.lazyWire),i=x(In.none());return kc(t,u,o,n,i),dr(t,n,u,o),Rl(t,e),xl(t,e),Cl(t),t.on("PreInit",function(){t.serializer.addTempAttr(er),t.serializer.addTempAttr(or)}),hc(t)&&t.on("keydown",function(n){Cf(n,t,u,r.lazyWire)}),t.on("remove",function(){r.destroy(),o.destroy()}),Tl(t,i,r,e)}!function Al(){Bn.add("table",Ol)}()}(window);